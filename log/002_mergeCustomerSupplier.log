-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 opened on:  28 Jan 2020, 10:42:48

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. clear all

. set more off

. macro drop _all

. set scheme s1color

. set matsize 10000

. 
. *Useful modules
. ssc install charlist
checking charlist consistency and verifying not already installed...
all files already exist and are up to date.

. ssc install matchit
checking matchit consistency and verifying not already installed...
all files already exist and are up to date.

. ssc install strip
checking strip consistency and verifying not already installed...
all files already exist and are up to date.

. 
. *Paths
. global wd "C:/Users/dyevre/Documents/mres_paper"

. global orig "$wd/orig"

. global data "$wd/data"

. global outputs "$wd/outputs"

. global doc "$wd/doc"

. global code "$wd/code"

. 
. *do-file number, used to save outputs 
. global doNum "001"                                      

. 
. *log
. cap log close
-----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 opened on:  28 Jan 2020, 12:24:11

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_network/001_supplierList.dta", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. merge 1:1 gvkey comp using "$data/001_network/001_companyList_6119.dta"
(note: variable comp was str28, now str30 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                        17,753
        from master                       287  (_merge==1)
        from using                     17,466  (_merge==2)

    matched                            15,490  (_merge==3)
    -----------------------------------------

. 
end of do-file

. sort comp

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_network/001_customerList.dta", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. merge 1:m comp using "$data/001_network/001_companyList_6119.dta"                
>                        // 1 to many merge as several companies in Compustat have 
> the same name but different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,266
        from master                    34,637  (_merge==1)
        from using                     30,629  (_merge==2)

    matched                             2,327  (_merge==3)
    -----------------------------------------

. 
end of do-file

. h count

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_network/001_customerList.dta", clear

. merge 1:m comp using "$data/001_network/001_companyList_6119.dta"                
>                        // 1 to many merge as several companies in Compustat have 
> the same name but different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,266
        from master                    34,637  (_merge==1)
        from using                     30,629  (_merge==2)

    matched                             2,327  (_merge==3)
    -----------------------------------------

.                 //4.1% merge 
. count if _merge == 3
  2,327

. local merged = `r(N)'

. count if _merge == 1
  34,637

. local master = `r(N)'

. di `merged'/`master'
.06718249

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_network/001_supplierList.dta", clear

. merge 1:m comp using "$data/001_network/001_companyList_6119.dta"                
>                        // 1 to many merge as several companies in Compustat have 
> the same name but different Gvkeys 
variable comp does not uniquely identify observations in the master data
r(459);

end of do-file

r(459);

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_network/001_supplierList.dta", clear

. merge 1:1 gvkey comp using "$data/001_network/001_companyList_6119.dta"          
>                        // 1 to many merge as several companies in Compustat have 
> the same name but different Gvkeys 
(note: variable comp was str28, now str30 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                        17,753
        from master                       287  (_merge==1)
        from using                     17,466  (_merge==2)

    matched                            15,490  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  15,490

. local merged = `r(N)'

. count if _merge == 1
  287

. local master = `r(N)'

. di `merged'/`master'                                                             
>                                                        //6.72% merge
53.972125

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_network/001_customerList.dta", clear

. merge 1:m comp using "$data/001_network/001_companyList_6119.dta"                
>                        // 1 to many merge as several companies in Compustat have 
> the same name but different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,266
        from master                    34,637  (_merge==1)
        from using                     30,629  (_merge==2)

    matched                             2,327  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,327

. local merged = `r(N)'

. count if _merge == 1
  34,637

. local master = `r(N)'

. di `merged'/(`master'+`merged)'                                                  
>                                                //6.72% merge
too few ')' or ']'
r(132);

end of do-file

r(132);

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_network/001_customerList.dta", clear

. merge 1:m comp using "$data/001_network/001_companyList_6119.dta"                
>                        // 1 to many merge as several companies in Compustat have 
> the same name but different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,266
        from master                    34,637  (_merge==1)
        from using                     30,629  (_merge==2)

    matched                             2,327  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,327

. local merged = `r(N)'

. count if _merge == 1
  34,637

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.72% merge
.06295314

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_network/001_supplierList.dta", clear

. merge 1:1 gvkey comp using "$data/001_network/001_companyList_6119.dta"          
>                        // 1 to many merge as several companies in Compustat have 
> the same name but different Gvkeys 
(note: variable comp was str28, now str30 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                        17,753
        from master                       287  (_merge==1)
        from using                     17,466  (_merge==2)

    matched                            15,490  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  15,490

. local merged = `r(N)'

. count if _merge == 1
  287

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.72% merge
.98180896

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_network/001_customerList.dta", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_network/001_customerList.dta", clear

. merge 1:m comp using "$data/001_network/001_companyList_6119.dta"               

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,266
        from master                    34,637  (_merge==1)
        from using                     30,629  (_merge==2)

    matched                             2,327  (_merge==3)
    -----------------------------------------

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. save tempmerge, replace
(note: file tempmerge.dta not found)
file tempmerge.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. clear all

. set more off

. macro drop _all

. set scheme s1color

. set matsize 10000

. 
. *Paths
. global wd "C:/Users/dyevre/Documents/mres_paper"

. global orig "$wd/orig"

. global data "$wd/data/001_network"

. global outputs "$wd/outputs"

. global doc "$wd/doc"

. global code "$wd/code"

. global log "$wd/log"

. 
. *do-file number, used to save outputs 
. global doNum "002"                                      

. 
. *log
. cap log close
-----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 opened on:  28 Jan 2020, 18:00:02

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:m comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,266
        from master                    34,637  (_merge==1)
        from using                     30,629  (_merge==2)

    matched                             2,327  (_merge==3)
    -----------------------------------------

. save tempmerge, replace
file tempmerge.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:m comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,266
        from master                    34,637  (_merge==1)
        from using                     30,629  (_merge==2)

    matched                             2,327  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
(note: file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta not
>  found)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. keep if _merge==3
(65,266 observations deleted)

. drop _merge

. save "$data/matched.dta", replace
(note: file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta not f
> ound)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,956 observations deleted)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:m comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,266
        from master                    34,637  (_merge==1)
        from using                     30,629  (_merge==2)

    matched                             2,327  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. keep if _merge==3
(65,266 observations deleted)

. drop _merge

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,956 observations deleted)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,956 observations deleted)

. keep comp

. drop _merge
variable _merge not found
r(111);

end of do-file

r(111);

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,956 observations deleted)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. keep comp

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,956 observations deleted)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,956 observations deleted)

. keep comp

. save "$data/resid1", replace
(note: file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta not fo
> und)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/tempmerge", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(36,964 observations deleted)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(36,964 observations deleted)

. keep comp

. save "$data/resid2", replace
(note: file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta not fo
> und)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:m comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,266
        from master                    34,637  (_merge==1)
        from using                     30,629  (_merge==2)

    matched                             2,327  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,266 observations deleted)

. drop _merge

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,956 observations deleted)

. keep comp

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(36,964 observations deleted)

. keep comp

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. program merge3 
  1.         confirm file "$data/matched.dta"
  2.         confirm file "$data/resid1.dta" 
  3.         confirm file "$data/resid2.dta" 
  4. 
.         use "$data/resid1", clear 
  5.         merge comp using "$data/resid2"
  6.         if _N==0{
  7.                 exit
  8.                 }
  9.         save "$data/result.dta", replace
 10. 
.         keep if _merge==3
 11.         drop _merge
 12.         append using "$data/matched.dta"
 13.         save "$data/matched.dta", replace
 14. 
.         use "$data/result.dta", clear 
 15.         keep if _merge==1
 16.         keep comp
 17.         sort comp
 18.         merge comp using "$data/resid1"
 19.         keep if _merge==3
 20.         drop _merge
 21.         sort comp
 22.         save "$data/resid1", replace emptyok
 23. 
.         use "$data/result.dta", clear 
 24.         keep if _merge==2
 25.         keep comp
 26.         sort comp
 27.         merge comp using "$data/resid2.dta" 
 28.         keep if _merge==3
 29.         drop _merge
 30.         sort comp
 31.         save "$data/resid2.dta" , replace emptyok
 32. 
.         erase "$data/result.dta"
 33.         end

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,765 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(689 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(0 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,620 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(728 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,011 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(0 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(92 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(105 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(1 real change made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(0 real changes made)

. 
end of do-file

. do "C:\Users\dyevre\Documents\mres_paper\code\mres_001_dataImport.do"

. 
. /*******************************************************************************
>         
>         DESCRIPTION:
>         
>         INFILES:        - compustat_segment_customer_76_19.csv
>         
>         OUTFILES:       - Descriptive stats
>         
>         LOG: Created 02/12/2019
>         
> *******************************************************************************/
. 
. 
. /*******************************************************************************
>         SETUP
> *******************************************************************************/
. 
. clear all

. set more off

. macro drop _all

. set scheme s1color

. set matsize 10000

. 
. *Useful modules
. ssc install charlist
checking charlist consistency and verifying not already installed...
all files already exist and are up to date.

. ssc install matchit
checking matchit consistency and verifying not already installed...
all files already exist and are up to date.

. ssc install strip
checking strip consistency and verifying not already installed...
all files already exist and are up to date.

. 
. *Paths
. global wd "C:/Users/dyevre/Documents/mres_paper"

. global orig "C:/Users/dyevre/Downloads/mres_paper_orig"                          
>                        //using this folder for heavy files, otherwise I cannot co
> mmit to GitHub

. global data "$wd/data"

. global outputs "$wd/outputs"

. global doc "$wd/doc"

. global code "$wd/code"

. 
. *do-file number, used to save outputs 
. global doNum "001"                                      

. 
. *log
. cap log close
-----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 opened on:  28 Jan 2020, 18:42:51

. 
. /*******************************************************************************
>         EXACT MERGE
> *******************************************************************************/
. 
. *Keeping only supplier firms who have financial data
. *use "$data/001_network/001_supplierList.dta", clear
. *merge 1:1 gvkey comp using "$data/001_network/001_companyList_6119.dta"
. *KEEPING ALL firms for now
. 
. *Customer to company exact merge
. use "$data/001_customerList.dta", clear

. merge 1:m comp using "$data/001_companyList_6119.dta"                            
>        // 1 to many merge as several companies in Compustat have the same name bu
> t different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,955
        from master                    35,276  (_merge==1)
        from using                     30,679  (_merge==2)

    matched                             2,277  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,277

. local merged = `r(N)'

. count if _merge == 1
  35,276

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.30% merge
.0606343

. 
. *Supplier to company exact merge
. use "$data/001_supplierList.dta", clear

. merge 1:1 gvkey comp using "$data/001_companyList_6119.dta"
(note: variable comp was str28, now str30 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                        17,755
        from master                       288  (_merge==1)
        from using                     17,467  (_merge==2)

    matched                            15,489  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  15,489

. local merged = `r(N)'

. count if _merge == 1
  288

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //98.18% merge
.98174558

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM
> *******************************************************************************/
. 
. *Using the cleaning algorithm from AHRS
. use "$data/001_customerList.dta", clear

. merge 1:m comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,955
        from master                    35,276  (_merge==1)
        from using                     30,679  (_merge==2)

    matched                             2,277  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,955 observations deleted)

. drop _merge

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,956 observations deleted)

. keep comp

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,553 observations deleted)

. keep comp

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:m comp using "$data/001_companyList_6119.dta"                            
>        // 1 to many merge as several companies in Compustat have the same name bu
> t different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,955
        from master                    35,276  (_merge==1)
        from using                     30,679  (_merge==2)

    matched                             2,277  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,277

. local merged = `r(N)'

. count if _merge == 1
  35,276

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.30% merge
.0606343

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:m comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,955
        from master                    35,276  (_merge==1)
        from using                     30,679  (_merge==2)

    matched                             2,277  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,955 observations deleted)

. drop _merge

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,956 observations deleted)

. keep comp

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,553 observations deleted)

. keep comp

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. program merge3 
  1.         confirm file "$data/matched.dta"
  2.         confirm file "$data/resid1.dta" 
  3.         confirm file "$data/resid2.dta" 
  4. 
.         use "$data/resid1", clear 
  5.         merge comp using "$data/resid2"
  6.         if _N==0{
  7.                 exit
  8.                 }
  9.         save "$data/result.dta", replace
 10. 
.         keep if _merge==3
 11.         drop _merge
 12.         append using "$data/matched.dta"
 13.         save "$data/matched.dta", replace
 14. 
.         use "$data/result.dta", clear 
 15.         keep if _merge==1
 16.         keep comp
 17.         sort comp
 18.         merge comp using "$data/resid1"
 19.         keep if _merge==3
 20.         drop _merge
 21.         sort comp
 22.         save "$data/resid1", replace emptyok
 23. 
.         use "$data/result.dta", clear 
 24.         keep if _merge==2
 25.         keep comp
 26.         sort comp
 27.         merge comp using "$data/resid2.dta" 
 28.         keep if _merge==3
 29.         drop _merge
 30.         sort comp
 31.         save "$data/resid2.dta" , replace emptyok
 32. 
.         erase "$data/result.dta"
 33.         end

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(860 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(46 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(11 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(49 real changes made)

. replace comp=subinword(comp,"CO","",.)
(1,363 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(111 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(60 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(499 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(76 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(22 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(124 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(125 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. replace comp=subinword(comp,"MICRO","MICR",.)
(24 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(156 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(518 real changes made)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:m comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,955
        from master                    35,276  (_merge==1)
        from using                     30,679  (_merge==2)

    matched                             2,277  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,955 observations deleted)

. drop _merge

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,956 observations deleted)

. keep comp

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,553 observations deleted)

. keep comp

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. program merge3 
program merge3 already defined
r(110);

end of do-file

r(110);

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. 
. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(860 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(46 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(11 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(49 real changes made)

. replace comp=subinword(comp,"CO","",.)
(1,363 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(111 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(60 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(499 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(76 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(22 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(124 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(125 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(24 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(156 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(518 real changes made)

. replace comp=trim(comp)
(1,616 real changes made)

. sort comp 

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3
(note: you are using old merge syntax; see [D] merge for new syntax)
variable comp does not uniquely identify observations in the master data
variable comp does not uniquely identify observations in
    C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta
(note: file C:/Users/dyevre/Documents/mres_paper/data/001_network/result.dta not fo
> und)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/result.dta saved
(63,794 observations deleted)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved
(30,704 observations deleted)
(note: you are using old merge syntax; see [D] merge for new syntax)
variable comp does not uniquely identify observations in the master data
variable comp does not uniquely identify observations in
    C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta
(1,091 observations deleted)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved
(35,280 observations deleted)
(note: you are using old merge syntax; see [D] merge for new syntax)
variable comp does not uniquely identify observations in the master data
variable comp does not uniquely identify observations in
    C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta
(1,070 observations deleted)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. cap drop program merge3

. 
end of do-file

. drop program merge3
variable program not found
r(111);

. h program

. program drop merge3

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:m comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,955
        from master                    35,276  (_merge==1)
        from using                     30,679  (_merge==2)

    matched                             2,277  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,955 observations deleted)

. drop _merge

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,956 observations deleted)

. keep comp

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,553 observations deleted)

. keep comp

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         confirm file "$data/matched.dta"
  2.         confirm file "$data/resid1.dta" 
  3.         confirm file "$data/resid2.dta" 
  4. 
.         use "$data/resid1", clear 
  5.         merge 1:1 comp using "$data/resid2"
  6.         if _N==0{
  7.                 exit
  8.                 }
  9.         save "$data/result.dta", replace
 10. 
.         keep if _merge==3
 11.         drop _merge
 12.         append using "$data/matched.dta"
 13.         save "$data/matched.dta", replace
 14. 
.         use "$data/result.dta", clear 
 15.         keep if _merge==1
 16.         keep comp
 17.         sort comp
 18.         merge 1:1 comp using "$data/resid1"
 19.         keep if _merge==3
 20.         drop _merge
 21.         sort comp
 22.         save "$data/resid1", replace emptyok
 23. 
.         use "$data/result.dta", clear 
 24.         keep if _merge==2
 25.         keep comp
 26.         sort comp
 27.         merge 1:1 comp using "$data/resid2.dta" 
 28.         keep if _merge==3
 29.         drop _merge
 30.         sort comp
 31.         save "$data/resid2.dta" , replace emptyok
 32. 
.         erase "$data/result.dta"
 33.         end

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. import delimited "$orig/compustat_quarterly_61_19.csv", clear
file C:/Users/dyevre/Documents/mres_paper/orig/compustat_quarterly_61_19.csv not fo
> und
r(601);

end of do-file

r(601);

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. 
. clear all

. set more off

. macro drop _all

. set scheme s1color

. set matsize 10000

. 
. *Useful modules
. *ssc install charlist
. *ssc install matchit
. *ssc install strip
. 
. *Paths
. global wd "C:/Users/dyevre/Documents/mres_paper"

. global orig "C:/Users/dyevre/Downloads/mres_paper_orig"                          
>                        //using this folder for heavy files, otherwise I cannot co
> mmit to GitHub

. global data "$wd/data"

. global outputs "$wd/outputs"

. global doc "$wd/doc"

. global code "$wd/code"

. global log "$wd/log"

. 
. *do-file number, used to save outputs 
. global doNum "001"                                      

. 
. *log
. cap log close
-----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 opened on:  28 Jan 2020, 19:10:13

. 
. /*******************************************************************************
>         EXACT MERGE
> *******************************************************************************/
. 
. *Keeping only supplier firms who have financial data
. *use "$data/001_network/001_supplierList.dta", clear
. *merge 1:1 gvkey comp using "$data/001_network/001_companyList_6119.dta"
. *KEEPING ALL firms for now
. 
. *Customer to company exact merge
. use "$data/001_customerList.dta", clear

. merge 1:m comp using "$data/001_companyList_6119.dta"                            
>        // 1 to many merge as several companies in Compustat have the same name bu
> t different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,250

. local merged = `r(N)'

. count if _merge == 1
  35,276

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.06% merge
.05995843

. 
. *Supplier to company exact merge
. use "$data/001_supplierList.dta", clear

. merge 1:1 gvkey comp using "$data/001_companyList_6119.dta"
variable gvkey not found
r(111);

end of do-file

r(111);

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"                            
>        // 1 to many merge as several companies in Compustat have the same name bu
> t different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,250

. local merged = `r(N)'

. count if _merge == 1
  35,276

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.06% merge
.05995843

. 
. *Supplier to company exact merge
. use "$data/001_supplierList.dta", clear

. merge 1:1 /*gvkey*/ comp using "$data/001_companyList_6119.dta"
variable comp does not uniquely identify observations in the master data
r(459);

end of do-file

r(459);

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. import delimited "$orig/compustat_segment_customer_76_19.csv", clear
file C:/Users/dyevre/Documents/mres_paper/orig/compustat_segment_customer_76_19.csv
>  not found
r(601);

end of do-file

r(601);

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. clear all

. set more off

. macro drop _all

. set scheme s1color

. set matsize 10000

. 
. *Useful modules
. *ssc install charlist
. *ssc install matchit
. *ssc install strip
. 
. *Paths
. global wd "C:/Users/dyevre/Documents/mres_paper"

. global orig "C:/Users/dyevre/Downloads/mres_paper_orig"                          
>                        //using this folder for heavy files, otherwise I cannot co
> mmit to GitHub

. global data "$wd/data"

. global outputs "$wd/outputs"

. global doc "$wd/doc"

. global code "$wd/code"

. global log "$wd/log"

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. import delimited "$orig/compustat_segment_customer_76_19.csv", clear
(16 vars, 549,451 obs)

. tostring srcdate, gen(dataStr)
dataStr generated as str8

. gen year = substr(dataStr, 1, 4)

. destring year, replace
year: all characters numeric; replaced as int

. drop srcdate dataStr

. 
. preserve

.         keep if ctype == "COMPANY"
(233,525 observations deleted)

.         keep conm gvkey

.         gen count = 1

.         
.         *Cleaning company names
.         rename conm toClean

.         cd $code
C:\Users\dyevre\Documents\mres_paper\code

.         do mres_xxx_cleanCompNames

. 
. /*******************************************************************************
>         
>         DESCRIPTION:    Cleaning company names -> Giving somewhat homogeneous nam
> es
>                                         across datasets
>         
>         INFILES:        - any string variable with the name toClean
>         
>         OUTFILES:       - cleaned company name
>         
>         LOG:            Created 03/12/2019
>         
> *******************************************************************************/
. 
. *White spaces, capital letters and punctuations
. replace toClean = trim(toClean)
(0 real changes made)

. foreach word in "CORP" "INC" "LTD" ".COM" "PLC" " TRUST" " CO"{
  2.         replace toClean = subinstr(toClean, " `word'", "", .)
  3.         }
(68,205 real changes made)
(166,553 real changes made)
(13,846 real changes made)
(7 real changes made)
(3,217 real changes made)
(0 real changes made)
(0 real changes made)

. 
. *Punctuation
. strip toClean, of("'`!$%^&*()-_+=][}{#;~@:/.,?><\|") gen(toClean2)

. drop toClean

. rename toClean2 toClean

. 
. *White space
. *replace toClean = subinstr(toClean, " ", "", .)
. 
. *Upper case
. replace toClean=upper(toClean)
(0 real changes made)

. 
. *From Atalay, Hortacsu, Roberts, and Syverson's code (2011)
. 
. 
. 
. 
. 
end of do-file

.         rename toClean conm

.         
.         collapse (sum) count, by(conm /*gvkey*/)

.         drop if conm == ""
(1 observation deleted)

.         rename conm comp

.         *mkdir "$data/${doNum}_network"
.         drop count

.         save "$data/${doNum}_network/${doNum}_supplierList.dta", replace
(note: file C:/Users/dyevre/Documents/mres_paper/data/_network/_supplierList.dta no
> t found)
file C:/Users/dyevre/Documents/mres_paper/data/_network/_supplierList.dta could
    not be opened
r(603);

end of do-file

r(603);

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. 
. clear all

. set more off

. macro drop _all

. set scheme s1color

. set matsize 10000

. 
. *Useful modules
. *ssc install charlist
. *ssc install matchit
. *ssc install strip
. 
. *Paths
. global wd "C:/Users/dyevre/Documents/mres_paper"

. global orig "C:/Users/dyevre/Downloads/mres_paper_orig"                          
>                        //using this folder for heavy files, otherwise I cannot co
> mmit to GitHub

. global data "$wd/data"

. global outputs "$wd/outputs"

. global doc "$wd/doc"

. global code "$wd/code"

. global log "$wd/log"

. 
. *do-file number, used to save outputs 
. global doNum "001"                                      

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. import delimited "$orig/compustat_segment_customer_76_19.csv", clear
(16 vars, 549,451 obs)

. tostring srcdate, gen(dataStr)
dataStr generated as str8

. gen year = substr(dataStr, 1, 4)

. destring year, replace
year: all characters numeric; replaced as int

. drop srcdate dataStr

. 
. preserve

.         keep if ctype == "COMPANY"
(233,525 observations deleted)

.         keep conm gvkey

.         gen count = 1

.         
.         *Cleaning company names
.         rename conm toClean

.         cd $code
C:\Users\dyevre\Documents\mres_paper\code

.         do mres_xxx_cleanCompNames

. 
. /*******************************************************************************
>         
>         DESCRIPTION:    Cleaning company names -> Giving somewhat homogeneous nam
> es
>                                         across datasets
>         
>         INFILES:        - any string variable with the name toClean
>         
>         OUTFILES:       - cleaned company name
>         
>         LOG:            Created 03/12/2019
>         
> *******************************************************************************/
. 
. *White spaces, capital letters and punctuations
. replace toClean = trim(toClean)
(0 real changes made)

. foreach word in "CORP" "INC" "LTD" ".COM" "PLC" " TRUST" " CO"{
  2.         replace toClean = subinstr(toClean, " `word'", "", .)
  3.         }
(68,205 real changes made)
(166,553 real changes made)
(13,846 real changes made)
(7 real changes made)
(3,217 real changes made)
(0 real changes made)
(0 real changes made)

. 
. *Punctuation
. strip toClean, of("'`!$%^&*()-_+=][}{#;~@:/.,?><\|") gen(toClean2)

. drop toClean

. rename toClean2 toClean

. 
. *White space
. *replace toClean = subinstr(toClean, " ", "", .)
. 
. *Upper case
. replace toClean=upper(toClean)
(0 real changes made)

. 
. *From Atalay, Hortacsu, Roberts, and Syverson's code (2011)
. 
. 
. 
. 
. 
end of do-file

.         rename toClean conm

.         
.         collapse (sum) count, by(conm /*gvkey*/)

.         drop if conm == ""
(1 observation deleted)

.         rename conm comp

.         *mkdir "$data/${doNum}_network"
.         drop count

.         save "$data/${doNum}_network/${doNum}_supplierList.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/001_supplierList.dta sav
> ed

. restore

. 
. preserve

.         keep if ctype == "COMPANY"
(233,525 observations deleted)

.         keep cnms

.         gen count = 1

.         
.         *Cleaning company names
.         rename cnms toClean

.         cd $code
C:\Users\dyevre\Documents\mres_paper\code

.         do mres_xxx_cleanCompNames

. 
. /*******************************************************************************
>         
>         DESCRIPTION:    Cleaning company names -> Giving somewhat homogeneous nam
> es
>                                         across datasets
>         
>         INFILES:        - any string variable with the name toClean
>         
>         OUTFILES:       - cleaned company name
>         
>         LOG:            Created 03/12/2019
>         
> *******************************************************************************/
. 
. *White spaces, capital letters and punctuations
. replace toClean = trim(toClean)
(0 real changes made)

. foreach word in "CORP" "INC" "LTD" ".COM" "PLC" " TRUST" " CO"{
  2.         replace toClean = subinstr(toClean, " `word'", "", .)
  3.         }
(10,306 real changes made)
(9,021 real changes made)
(1,274 real changes made)
(0 real changes made)
(1,384 real changes made)
(0 real changes made)
(1 real change made)

. 
. *Punctuation
. strip toClean, of("'`!$%^&*()-_+=][}{#;~@:/.,?><\|") gen(toClean2)

. drop toClean

. rename toClean2 toClean

. 
. *White space
. *replace toClean = subinstr(toClean, " ", "", .)
. 
. *Upper case
. replace toClean=upper(toClean)
(170,172 real changes made)

. 
. *From Atalay, Hortacsu, Roberts, and Syverson's code (2011)
. 
. 
. 
. 
. 
end of do-file

.         rename toClean cnms

.         
.         collapse (sum) count, by(cnms)

.         drop if cnms == ""
(1 observation deleted)

.         drop count

.         rename cnms comp

.         save "$data/${doNum}_network/${doNum}_customerList.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/001_customerList.dta sav
> ed

. restore

. 
. /*******************************************************************************
>         IMPORTING STANDARD COMPUSTAT DATA
> *******************************************************************************/
. 
. *See "Standard - UChicago (quarterly)" data query
. import delimited "$orig/compustat_quarterly_61_19.csv", clear
(26 vars, 1,592,184 obs)

. keep gvkey conm

. gen count = 1

. 
. *Cleaning company names
. rename conm toClean

. cd $code
C:\Users\dyevre\Documents\mres_paper\code

. do mres_xxx_cleanCompNames

. 
. /*******************************************************************************
>         
>         DESCRIPTION:    Cleaning company names -> Giving somewhat homogeneous nam
> es
>                                         across datasets
>         
>         INFILES:        - any string variable with the name toClean
>         
>         OUTFILES:       - cleaned company name
>         
>         LOG:            Created 03/12/2019
>         
> *******************************************************************************/
. 
. *White spaces, capital letters and punctuations
. replace toClean = trim(toClean)
(0 real changes made)

. foreach word in "CORP" "INC" "LTD" ".COM" "PLC" " TRUST" " CO"{
  2.         replace toClean = subinstr(toClean, " `word'", "", .)
  3.         }
(351,325 real changes made)
(720,687 real changes made)
(49,786 real changes made)
(15 real changes made)
(15,308 real changes made)
(0 real changes made)
(0 real changes made)

. 
. *Punctuation
. strip toClean, of("'`!$%^&*()-_+=][}{#;~@:/.,?><\|") gen(toClean2)

. drop toClean

. rename toClean2 toClean

. 
. *White space
. *replace toClean = subinstr(toClean, " ", "", .)
. 
. *Upper case
. replace toClean=upper(toClean)
(0 real changes made)

. 
. *From Atalay, Hortacsu, Roberts, and Syverson's code (2011)
. 
. 
. 
. 
. 
end of do-file

. rename toClean conm

.         
. collapse (sum) count, by(conm /*gvkey*/)                                         
>                                                //32,956 companies*gvkey, 32,854 f
> irms only

. drop if conm == ""
(0 observations deleted)

. drop count

. rename conm comp

. save "$data/${doNum}_network/${doNum}_companyList_6119.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/001_companyList_6119.dta
>  saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. clear all

. set more off

. macro drop _all

. set scheme s1color

. set matsize 10000

. 
. *Paths
. global wd "C:/Users/dyevre/Documents/mres_paper"

. global orig "$wd/orig"

. global data "$wd/data/001_network"

. global outputs "$wd/outputs"

. global doc "$wd/doc"

. global code "$wd/code"

. global log "$wd/log"

. 
. *do-file number, used to save outputs 
. global doNum "002"                                      

. 
. *log
. cap log close
-----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 opened on:  28 Jan 2020, 19:16:04

. 
. /*******************************************************************************
>         EXACT MERGE
> *******************************************************************************/
. 
. *Keeping only supplier firms who have financial data
. *use "$data/001_network/001_supplierList.dta", clear
. *merge 1:1 gvkey comp using "$data/001_network/001_companyList_6119.dta"
. *KEEPING ALL firms for now
. 
. *Customer to company exact merge
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"                            
>        // 1 to many merge as several companies in Compustat have the same name bu
> t different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,250

. local merged = `r(N)'

. count if _merge == 1
  35,276

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.06% merge
.05995843

. 
. *Supplier to company exact merge
. use "$data/001_supplierList.dta", clear

. merge 1:1 /*gvkey*/ comp using "$data/001_companyList_6119.dta"
(note: variable comp was str28, now str30 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                        17,690
        from master                       286  (_merge==1)
        from using                     17,404  (_merge==2)

    matched                            15,450  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  15,450

. local merged = `r(N)'

. count if _merge == 1
  286

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //98.18% merge
.98182511

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. cap program drop merge3

. program merge3 
  1.         confirm file "$data/matched.dta"
  2.         confirm file "$data/resid1.dta" 
  3.         confirm file "$data/resid2.dta" 
  4. 
.         use "$data/resid1", clear 
  5.         merge 1:1 comp using "$data/resid2"
  6.         if _N==0{
  7.                 exit
  8.                 }
  9.         save "$data/result.dta", replace
 10. 
.         keep if _merge==3
 11.         drop _merge
 12.         append using "$data/matched.dta"
 13.         save "$data/matched.dta", replace
 14. 
.         use "$data/result.dta", clear 
 15.         keep if _merge==1
 16.         keep comp
 17.         sort comp
 18.         merge 1:1 comp using "$data/resid1"
 19.         keep if _merge==3
 20.         drop _merge
 21.         sort comp
 22.         save "$data/resid1", replace emptyok
 23. 
.         use "$data/result.dta", clear 
 24.         keep if _merge==2
 25.         keep comp
 26.         sort comp
 27.         merge 1:1 comp using "$data/resid2.dta" 
 28.         keep if _merge==3
 29.         drop _merge
 30.         sort comp
 31.         save "$data/resid2.dta" , replace emptyok
 32. 
.         erase "$data/result.dta"
 33.         end

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         confirm file "$data/matched.dta"
  2.         confirm file "$data/resid1.dta" 
  3.         confirm file "$data/resid2.dta" 
  4. 
.         use "$data/resid1", clear 
  5.         merge 1:1 comp using "$data/resid2"
  6.         if _N==0{
  7.                 exit
  8.                 }
  9.         save "$data/result.dta", replace
 10. 
.         keep if _merge==3
 11.         drop _merge
 12.         append using "$data/matched.dta"
 13.         save "$data/matched.dta", replace
 14. 
.         use "$data/result.dta", clear 
 15.         keep if _merge==1
 16.         keep comp
 17.         sort comp
 18.         merge 1:1 comp using "$data/resid1"
 19.         keep if _merge==3
 20.         drop _merge
 21.         sort comp
 22.         save "$data/resid1", replace emptyok
 23. 
.         use "$data/result.dta", clear 
 24.         keep if _merge==2
 25.         keep comp
 26.         sort comp
 27.         merge 1:1 comp using "$data/resid2.dta" 
 28.         keep if _merge==3
 29.         drop _merge
 30.         sort comp
 31.         save "$data/resid2.dta" , replace emptyok
 32. 
.         erase "$data/result.dta"
 33.         end

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp
 18.                 sort comp
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp
 27.                 sort comp
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/tempmerge", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp
 18.                 sort comp
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp
 27.                 sort comp
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/tempmerge", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

.         
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(853 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(46 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(11 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(49 real changes made)

. replace comp=subinword(comp,"CO","",.)
(1,362 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(111 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(60 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(499 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(76 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(22 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(124 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(125 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(24 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(156 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(518 real changes made)

. replace comp=trim(comp)
(1,615 real changes made)

. sort comp 

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3
variable comp does not uniquely identify observations in the master data
r(459);

end of do-file

r(459);

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

.                 use "$data/resid1", clear 

.                 merge 1:1 comp using "$data/resid2"

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                                 0  (_merge==3)
    -----------------------------------------

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

.                 use "$data/resid1", clear 

.                 merge 1:1 comp using "$data/resid2"

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                                 0  (_merge==3)
    -----------------------------------------

.                 if _N==0{
.                         exit
.                         }

.                 save "$data/result.dta", replace
(note: file C:/Users/dyevre/Documents/mres_paper/data/001_network/result.dta not fo
> und)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/result.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

.                 keep if _merge==3
(65,880 observations deleted)

.                 drop _merge

.                 append using "$data/matched.dta"

.                 save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

.                 use "$data/result.dta", clear 

.                 keep if _merge==1
(30,604 observations deleted)

.                 keep comp

.                 sort comp

.                 merge 1:1 comp using "$data/resid1"

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                            35,276  (_merge==3)
    -----------------------------------------

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

.                 keep if _merge==3
(0 observations deleted)

.                 drop _merge

.                 sort comp

.                 save "$data/resid1", replace emptyok
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
.                 use "$data/result.dta", clear 

.                 keep if _merge==2
(35,276 observations deleted)

.                 keep comp

.                 sort comp

.                 merge 1:1 comp using "$data/resid2.dta" 

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                            30,604  (_merge==3)
    -----------------------------------------

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

.                 keep if _merge==3
(0 observations deleted)

.                 drop _merge

.                 sort comp

.                 save "$data/resid2.dta" , replace emptyok
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
.                 erase "$data/result.dta"

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp
 18.                 sort comp
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp
 27.                 sort comp
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/tempmerge", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

.         
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(853 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(46 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(11 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(49 real changes made)

. replace comp=subinword(comp,"CO","",.)
(1,362 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(111 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(60 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(499 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(76 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(22 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(124 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(125 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(24 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(156 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(518 real changes made)

. replace comp=trim(comp)
(1,615 real changes made)

. sort comp

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.67416731

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp
 18.                 sort comp
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp
 27.                 sort comp
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/tempmerge", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(853 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(46 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(11 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(49 real changes made)

. replace comp=subinword(comp,"CO","",.)
(1,362 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(111 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(60 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(499 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(76 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(22 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(124 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(125 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(24 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(156 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(518 real changes made)

. replace comp=trim(comp)
(1,615 real changes made)

. sort comp

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.67416731

. 
end of do-file

. di $merge_count, resid1_count, $resid2_count
68130 resid1_count not found
r(111);

. di $merge_count, $resid1_count, $resid2_count
68130 32928 29518

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp
 18.                 sort comp
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp
 27.                 sort comp
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/matched", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(853 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(46 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(11 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(49 real changes made)

. replace comp=subinword(comp,"CO","",.)
(1,362 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(111 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(60 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(499 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(76 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(22 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(124 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(125 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(24 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(156 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(518 real changes made)

. replace comp=trim(comp)
(1,615 real changes made)

. sort comp

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.09146594

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp
 18.                 sort comp
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp
 27.                 sort comp
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/matched", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp
 18.                 sort comp
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp
 27.                 sort comp
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/matched", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(853 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(46 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(11 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(49 real changes made)

. replace comp=subinword(comp,"CO","",.)
(1,362 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(111 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(60 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(499 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(76 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(22 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(124 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(125 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(24 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(156 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(518 real changes made)

. replace comp=trim(comp)
(1,615 real changes made)

. sort comp

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09146594
.09146594

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"A T & T","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"GROUP","",.)
(703 real changes made)

. replace comp=subinstr(comp,"HEALTHCARE","HTHCR",.)
(108 real changes made)

. replace comp=subinstr(comp,"SPON ADR","",.)
(32 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT SYSTEM","ABF FREIGHT",.)
(0 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT","ABF",.)
(1 real change made)

. replace comp=subinstr(comp,"PLC","",.)
(106 real changes made)

. replace comp=subinstr(comp,"HOLDINGS","",.)
(178 real changes made)

. replace comp=subinstr(comp,"ADR","",.)
(397 real changes made)

. replace comp=subinstr(comp,"INDUSTRIES","IND",.)
(115 real changes made)

. replace comp=subinstr(comp,"UNITED","UTD",.)
(6 real changes made)

. replace comp=trim(comp)
(1,093 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"A T & T","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"SPON ADR","",.)
(0 real changes made)

. replace comp=subinstr(comp,"PLC","",.)
(2 real changes made)

. replace comp=subinstr(comp,"GROUP","",.)
(1,103 real changes made)

. replace comp=subinstr(comp,"HEALTHCARE","HTHCR",.)
(119 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT SYSTEM","ABF FREIGHT",.)
(1 real change made)

. replace comp=subinstr(comp,"ABF FREIGHT","ABF",.)
(1 real change made)

. replace comp=subinstr(comp,"HOLDINGS","",.)
(815 real changes made)

. replace comp=subinstr(comp,"ADR","",.)
(290 real changes made)

. replace comp=subinstr(comp,"INDUSTRIES","IND",.)
(645 real changes made)

. replace comp=subinstr(comp,"UNITED","UTD",.)
(4 real changes made)

. replace comp=trim(comp)
(1,788 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09146594
.09685959

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"TELECOMMUNICATIONS","TELEM",.)
(27 real changes made)

. replace comp=subinstr(comp,"CL A","",.)
(65 real changes made)

. replace comp=subinstr(comp,"MMUNICATIONS","MMUN",.)
(172 real changes made)

. replace comp=subinstr(comp,"ADVANCED MICRO DEVICES","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"ADV MICRO DV","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"CP","",.)
(367 real changes made)

. replace comp=subinstr(comp,"CMPTRS","MPUTERS",.)
(1 real change made)

. replace comp=subinstr(comp,"AHA BETA","AHA BETA TECHNOLOGY",.)
(1 real change made)

. replace comp=subinstr(comp,"PRDS&CH","PRODUCTS & CHEMICALS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRTOUCH CM","AIRTOUCH COMMUNICATIONS",.)
(1 real change made)

. replace comp=subinstr(comp,"INTERNATIONAL","INTL",.)
(376 real changes made)

. replace comp=subinstr(comp,"POWER","PWR",.)
(286 real changes made)

. replace comp=subinstr(comp,"'","",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","",.)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"TELEMMUNICATIONS","TELEM",.)
(0 real changes made)

. replace comp=subinstr(comp,"MMUNICATIONS","MMUN",.)
(277 real changes made)

. replace comp=subinstr(comp,"ADVANCED MICRO DEVICES","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"ADV MICRO DV","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"CL A","",.)
(498 real changes made)

. replace comp=subinstr(comp,"CP","",.)
(437 real changes made)

. replace comp=subinstr(comp,"CMPTRS","MPUTERS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AHA BETA","AHA BETA TECHNOLOGY",.)
(1 real change made)

. replace comp=subinstr(comp,"PRDS&CH","PRODUCTS & CHEMICALS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRTOUCH CM","AIRTOUCH COMMUNICATIONS",.)
(0 real changes made)

. replace comp=subinstr(comp,"INTERNATIONAL","INTL",.)
(483 real changes made)

. replace comp=subinstr(comp,"POWER","PWR",.)
(208 real changes made)

. replace comp=subinstr(comp,"'","",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","",.)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.09804468

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"SA","",.)
(428 real changes made)

. replace comp=subinstr(comp,"PRODUCTS","PROD",.)
(128 real changes made)

. replace comp=subinstr(comp,"ELECTRONICS","ELECT",.)
(173 real changes made)

. replace comp=trim(comp)
(666 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"PRODUCTS","PROD",.)
(158 real changes made)

. replace comp=subinstr(comp,"ELECTRONICS","ELECT",.)
(80 real changes made)

. replace comp=subinword(comp,"SA","",.)
(145 real changes made)

. replace comp=trim(comp)
(828 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.10131343

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"AMERICA","AMER",.)
(312 real changes made)

. replace comp=subinstr(comp,".","",.)
(0 real changes made)

. replace comp=subinstr(comp,"HYDRO ELECTRIC","HYD",.)
(0 real changes made)

. replace comp=subinstr(comp,"OLD","",.)
(198 real changes made)

. replace comp=subinstr(comp,"TRUST","TR",.)
(53 real changes made)

. replace comp=subinstr(comp,"BARCLAYS BANK","BARCLAYS",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","&",.)
(0 real changes made)

. replace comp=subinstr(comp,"NOBLE","NOBL",.)
(25 real changes made)

. replace comp=subinstr(comp,"BANK","BK",.)
(238 real changes made)

. replace comp=subinstr(comp,"NEW","",.)
(262 real changes made)

. replace comp=subinstr(comp,"WRIGHT","WRGHT",.)
(4 real changes made)

. replace comp=trim(comp)
(96 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"AMERICA","AMER",.)
(657 real changes made)

. replace comp=subinstr(comp,".","",.)
(0 real changes made)

. replace comp=subinstr(comp,"HYDRO ELECTRIC","HYD",.)
(0 real changes made)

. replace comp=subinstr(comp,"OLD","",.)
(1,104 real changes made)

. replace comp=subinstr(comp,"TRUST","TR",.)
(346 real changes made)

. replace comp=subinstr(comp,"BARCLAYS BANK","BARCLAYS",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","&",.)
(0 real changes made)

. replace comp=subinstr(comp,"NOBLE","NOBL",.)
(7 real changes made)

. replace comp=subinstr(comp,"BANK","BK",.)
(356 real changes made)

. replace comp=subinstr(comp,"NEW","",.)
(232 real changes made)

. replace comp=subinstr(comp,"WRIGHT","WRGHT",.)
(14 real changes made)

. replace comp=trim(comp)
(433 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.10332145

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"A G","AG",.)
(90 real changes made)

. replace comp=subinstr(comp,"AEROSPACE","AEROSPAC",.)
(31 real changes made)

. replace comp=subinstr(comp,"(","",.)
(0 real changes made)

. replace comp=subinstr(comp,")","",.)
(0 real changes made)

. replace comp=subinstr(comp,"L L","LL",.)
(169 real changes made)

. replace comp=subinstr(comp,"STEARNS","STRNS",.)
(1 real change made)

. replace comp=subinstr(comp,"DICKINSON &","DICK",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCRAFT","AIRCR",.)
(10 real changes made)

. replace comp=subinstr(comp,"AIRCRFT","AIRCR",.)
(5 real changes made)

. replace comp=subinstr(comp,"CANADA","CDA",.)
(70 real changes made)

. replace comp=subinstr(comp,"PROJECTED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"TELEM","TEL",.)
(37 real changes made)

. replace comp=subinstr(comp,"BETHLEHEM","BETHLHM",.)
(1 real change made)

. replace comp=subinstr(comp,"STEEL","STL",.)
(162 real changes made)

. replace comp=subinstr(comp,"ENTERPRISES","ENT",.)
(48 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"A G","AG",.)
(86 real changes made)

. replace comp=subinstr(comp,"AEROSPACE","AEROSPAC",.)
(15 real changes made)

. replace comp=subinstr(comp,"(","",.)
(0 real changes made)

. replace comp=subinstr(comp,")","",.)
(0 real changes made)

. replace comp=subinstr(comp,"L L","LL",.)
(82 real changes made)

. replace comp=subinstr(comp,"STEARNS","STRNS",.)
(3 real changes made)

. replace comp=subinstr(comp,"DICKINSON &","DICK",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCRAFT","AIRCR",.)
(12 real changes made)

. replace comp=subinstr(comp,"AIRCRFT","AIRCR",.)
(1 real change made)

. replace comp=subinstr(comp,"CANADA","CDA",.)
(22 real changes made)

. replace comp=subinstr(comp,"PROJECTED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"TELEM","TEL",.)
(14 real changes made)

. replace comp=subinstr(comp,"BETHLEHEM","BETHLHM",.)
(3 real changes made)

. replace comp=subinstr(comp,"STEEL","STL",.)
(66 real changes made)

. replace comp=subinstr(comp,"ENTERPRISES","ENT",.)
(111 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.10360133

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"BIG THREE","BIG THREE IND",.)
(1 real change made)

. replace comp=subinstr(comp,"LLC","",.)
(864 real changes made)

. replace comp=subinstr(comp,"BORG WARNER","",.)
(1 real change made)

. replace comp=subinstr(comp,"SCIENTIFIC","SCI",.)
(18 real changes made)

. replace comp=subinstr(comp,"ADS","BP",.)
(31 real changes made)

. replace comp=subinstr(comp,"BRIGGS&STRATTON","BRIGG&STRN",.)
(0 real changes made)

. replace comp=subinstr(comp,"MYERS SQUIBB","MYRS",.)
(3 real changes made)

. replace comp=subinstr(comp,"CA CL","CA LA",.)
(1 real change made)

. replace comp=subinstr(comp,"GOLF","GF",.)
(13 real changes made)

. replace comp=subinstr(comp,"SOUP","SP",.)
(2 real changes made)

. replace comp=subinstr(comp,"CAMPBELL","CAMPBL",.)
(2 real changes made)

. replace comp=subinstr(comp,"FINANCIAL","FINL",.)
(57 real changes made)

. replace comp=subinstr(comp,"NATURAL GAS","NAT",.)
(25 real changes made)

. replace comp=subinstr(comp,"CANADIAN","CDN",.)
(18 real changes made)

. replace comp=subinstr(comp,"AIRCFT","AIRC",.)
(7 real changes made)

. replace comp=subinstr(comp,"AIRCR","AIRC",.)
(15 real changes made)

. replace comp=trim(comp)
(781 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"LLC","",.)
(136 real changes made)

. replace comp=subinstr(comp,"BORG WARNER","",.)
(0 real changes made)

. replace comp=subinstr(comp,"SCIENTIFIC","SCI",.)
(47 real changes made)

. replace comp=subinstr(comp,"BP   ADS","BP",.)
(0 real changes made)

. replace comp=subinstr(comp,"BRIGGS&STRATTON","BRIGG&STRN",.)
(0 real changes made)

. replace comp=subinstr(comp,"MYERS SQUIBB","MYRS",.)
(0 real changes made)

. replace comp=subinstr(comp,"CA CL","CA LA",.)
(0 real changes made)

. replace comp=subinstr(comp,"GOLF","GF",.)
(22 real changes made)

. replace comp=subinstr(comp,"SOUP","SP",.)
(2 real changes made)

. replace comp=subinstr(comp,"CAMPBELL","CAMPBL",.)
(5 real changes made)

. replace comp=subinstr(comp,"FINANCIAL","FINL",.)
(695 real changes made)

. replace comp=subinstr(comp,"NATURAL GAS","NAT",.)
(20 real changes made)

. replace comp=subinstr(comp,"CANADIAN","CDN",.)
(13 real changes made)

. replace comp=subinstr(comp,"AIRCFT","AIRC",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCR","AIRC",.)
(11 real changes made)

. replace comp=trim(comp)
(85 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.10459838

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"ROEBK","",.)
(1 real change made)

. replace comp=subinstr(comp,"ROEBUCK &","",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIR LINES","AIRL",.)
(4 real changes made)

. replace comp=trim(comp)
(1 real change made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"ROEBK","",.)
(0 real changes made)

. replace comp=subinstr(comp,"ROEBUCK &","",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIR LINES","AIRL",.)
(4 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.10460428

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/matched.dta", clear

. drop if comp==""
(0 observations deleted)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"SYSTEMS","SYS",.)
(269 real changes made)

. replace comp=subinstr(comp,"DU PONT EI DE NEMOURS","DUPONT EI",.)
(0 real changes made)

. replace comp=subinstr(comp,"EI","",.)
(669 real changes made)

. replace comp=subinstr(comp,"PRO FORMA","",.)
(16 real changes made)

. replace comp=subinstr(comp,"CREDIT","CR",.)
(25 real changes made)

. replace comp=subinstr(comp,"LIGHT","LT",.)
(52 real changes made)

. replace comp=subinstr(comp,"CHEMICAL","CHEMICL",.)
(124 real changes made)

. replace comp=subinstr(comp,"&","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DISCREET","DISCRT",.)
(0 real changes made)

. replace comp=subinstr(comp,"LOGIC","LGC",.)
(36 real changes made)

. replace comp=subinstr(comp,"TELEKOM","TELE",.)
(8 real changes made)

. replace comp=subinstr(comp,"TLKOM","TELE",.)
(1 real change made)

. replace comp=subinstr(comp,"DEUTSCHE","DTSCH",.)
(19 real changes made)

. 
. replace comp=subinstr(comp,"PWRLIGHT","PL",.)
(0 real changes made)

. replace comp=subinstr(comp,"SUPERMARKETS","SUPERMKTS",.)
(9 real changes made)

. replace comp=subinstr(comp,"CAPITAL","CAP",.)
(75 real changes made)

. replace comp=subinstr(comp,"GRAND ICE CREAM","",.)
(1 real change made)

. replace comp=subinstr(comp,"DREAMS","DRMS",.)
(2 real changes made)

. replace comp=subinstr(comp,"EMPORIUM","EMPORM",.)
(1 real change made)

. replace comp=subinstr(comp,"HARDWAREGARDEN","HRDWR",.)
(0 real changes made)

. replace comp=subinstr(comp,"KODAK","KDK",.)
(3 real changes made)

. replace comp=subinstr(comp,"MAN","MN",.)
(485 real changes made)

. replace comp=subinstr(comp,"STORES","",.)
(5 real changes made)

. replace comp=subinstr(comp,"BROTHERS","BROS",.)
(16 real changes made)

. replace comp=subinstr(comp,"AG","",.)
(1,007 real changes made)

. replace comp=subinstr(comp,"ELECTRONIC","ELEC",.)
(57 real changes made)

. replace comp=trim(comp)
(170 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"SYSTEMS","SYS",.)
(592 real changes made)

. replace comp=subinstr(comp,"DU PONT EI DE NEMOURS","DUPONT EI",.)
(0 real changes made)

. replace comp=subinstr(comp,"EI","",.)
(303 real changes made)

. replace comp=subinstr(comp,"PRO FORMA","",.)
(5 real changes made)

. replace comp=subinstr(comp,"CREDIT","CR",.)
(67 real changes made)

. replace comp=subinstr(comp,"LIGHT","LT",.)
(59 real changes made)

. replace comp=subinstr(comp,"CHEMICAL","CHEMICL",.)
(66 real changes made)

. replace comp=subinstr(comp,"&","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DISCREET","DISCRT",.)
(0 real changes made)

. replace comp=subinstr(comp,"LOGIC","LGC",.)
(59 real changes made)

. replace comp=subinstr(comp,"TELEKOM","TELE",.)
(5 real changes made)

. replace comp=subinstr(comp,"TLKOM","TELE",.)
(0 real changes made)

. replace comp=subinstr(comp,"DEUTSCHE","DTSCH",.)
(19 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(0 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(0 real changes made)

. replace comp=subinstr(comp,"PWRLIGHT","PL",.)
(0 real changes made)

. replace comp=subinstr(comp,"SUPERMARKETS","SUPERMKTS",.)
(8 real changes made)

. replace comp=subinstr(comp,"CAPITAL","CAP",.)
(327 real changes made)

. replace comp=subinstr(comp,"GRAND ICE CREAM","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DREAMS","DRMS",.)
(2 real changes made)

. replace comp=subinstr(comp,"EMPORIUM","EMPORM",.)
(0 real changes made)

. replace comp=subinstr(comp,"HARDWAREGARDEN","HRDWR",.)
(0 real changes made)

. replace comp=subinstr(comp,"KODAK","KDK",.)
(0 real changes made)

. replace comp=subinstr(comp,"MAN","MN",.)
(363 real changes made)

. replace comp=subinstr(comp,"STORES","",.)
(4 real changes made)

. replace comp=subinstr(comp,"BROTHERS","BROS",.)
(21 real changes made)

. replace comp=subinstr(comp,"AG","",.)
(971 real changes made)

. replace comp=subinstr(comp,"ELECTRONIC","",.)
(29 real changes made)

. replace comp=trim(comp)
(54 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.10609787

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"GAS","GS",.)
(436 real changes made)

. replace comp=subinstr(comp,"TOWN","TWN",.)
(28 real changes made)

. replace comp=subinstr(comp,"L M","",.)
(185 real changes made)

. replace comp=subinstr(comp,"LM","",.)
(186 real changes made)

. replace comp=subinstr(comp,"TELEFON","TEL",.)
(16 real changes made)

. replace comp=trim(comp)
(3 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"GAS","GS",.)
(181 real changes made)

. replace comp=subinstr(comp,"TOWN","TWN",.)
(37 real changes made)

. replace comp=subinstr(comp,"L M","",.)
(216 real changes made)

. replace comp=subinstr(comp,"LM","",.)
(200 real changes made)

. replace comp=subinstr(comp,"TELEFON","TEL",.)
(8 real changes made)

. replace comp=trim(comp)
(1 real change made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.1062067

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"ERICSSON TEL","ERCSON TELE",.)
(1 real change made)

. replace comp=subinstr(comp,"WHEELER","WHLR",.)
(3 real changes made)

. replace comp=subinstr(comp,"FISHER","FISHR",.)
(16 real changes made)

. replace comp=subinstr(comp,"SCIEN","SCI",.)
(125 real changes made)

. replace comp=subinstr(comp,"INTL","",.)
(575 real changes made)

. replace comp=subinstr(comp,"FED EXPRESS","FEDEX",.)
(1 real change made)

. replace comp=subinstr(comp,"WOOD","WD",.)
(78 real changes made)

. replace comp=subinstr(comp,"FLA ROCK","FLORIDA ROCK",.)
(1 real change made)

. replace comp=subinstr(comp,"STONE","STN",.)
(55 real changes made)

. replace comp=subinstr(comp,"TIRERUBBER","TIR",.)
(0 real changes made)

. replace comp=subinstr(comp,"TIR","",.)
(38 real changes made)

. replace comp=subinstr(comp,"CENTER","CNTR",.)
(149 real changes made)

. replace comp=subinstr(comp,"","YR",.)
(0 real changes made)

. replace comp=subinstr(comp,"NSOLIDATED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"MIC","MC",.)
(468 real changes made)

. replace comp=subinstr(comp,"ELECTRIC","ELEC",.)
(207 real changes made)

. replace comp=subinstr(comp,"ELEC","EL",.)
(849 real changes made)

. replace comp=subinstr(comp,"NSOL","",.)
(13 real changes made)

. replace comp=subinstr(comp,"PACIFIC","PAC",.)
(81 real changes made)

. replace comp=subinstr(comp,"W R","WR",.)
(7 real changes made)

. replace comp=trim(comp)
(439 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"ERICSSON TEL","ERCSON TELE",.)
(0 real changes made)

. replace comp=subinstr(comp,"WHEELER","WHLR",.)
(1 real change made)

. replace comp=subinstr(comp,"FISHER","FISHR",.)
(8 real changes made)

. replace comp=subinstr(comp,"SCIEN","SCI",.)
(190 real changes made)

. replace comp=subinstr(comp,"INTL","",.)
(1,068 real changes made)

. replace comp=subinstr(comp,"FED EXPRESS","FEDEX",.)
(0 real changes made)

. replace comp=subinstr(comp,"WOOD","WD",.)
(86 real changes made)

. replace comp=subinstr(comp,"FLA ROCK","FLORIDA ROCK",.)
(0 real changes made)

. replace comp=subinstr(comp,"STONE","STN",.)
(114 real changes made)

. replace comp=subinstr(comp,"TIRERUBBER","TIR",.)
(0 real changes made)

. replace comp=subinstr(comp,"TIR","",.)
(13 real changes made)

. replace comp=subinstr(comp,"CENTER","CNTR",.)
(69 real changes made)

. replace comp=subinstr(comp,"","YR",.)
(0 real changes made)

. replace comp=subinstr(comp,"NSOLIDATED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"MIC","MC",.)
(370 real changes made)

. replace comp=subinstr(comp,"ELECTRIC","ELEC",.)
(65 real changes made)

. replace comp=subinstr(comp,"ELEC","EL",.)
(347 real changes made)

. replace comp=subinstr(comp,"NSOL","",.)
(12 real changes made)

. replace comp=subinstr(comp,"PACIFIC","PAC",.)
(133 real changes made)

. replace comp=subinstr(comp,"W R","WR",.)
(15 real changes made)

. replace comp=trim(comp)
(851 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.10918382

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"METRO","MET",.)
(48 real changes made)

. replace comp=subinstr(comp,"TECHNOLOGIES","TECHNOL",.)
(5 real changes made)

. replace comp=subinstr(comp,"DATA MM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"DATAMM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"INSTRUMENT","INSTR",.)
(10 real changes made)

. replace comp=subinstr(comp,"INSTRMN","INSTR",.)
(2 real changes made)

. replace comp=subinstr(comp,"MOTORS","MTR",.)
(26 real changes made)

. replace comp=subinstr(comp,"INSTITUTE","INST",.)
(57 real changes made)

. replace comp=subinword(comp,"GENUINE","GENUIN",.)
(1 real change made)

. replace comp=subinword(comp,"PARTS","PART",.)
(19 real changes made)

. replace comp=subinword(comp,"TEL","TE",.)
(76 real changes made)

. replace comp=subinword(comp,"GLOBALSTAR","GLBLSTR",.)
(0 real changes made)

. replace comp=subinstr(comp,",","",.)
(0 real changes made)

. replace comp=subinword(comp,"GOODYR E","GOODYR",.)
(1 real change made)

. replace comp=subinword(comp,"W","",.)
(48 real changes made)

. replace comp=subinword(comp,"GRAINGER","GRAINGR",.)
(3 real changes made)

. replace comp=subinword(comp,"CHEMCL","CH",.)
(83 real changes made)

. replace comp=subinword(comp,"SP","",.)
(34 real changes made)

. replace comp=trim(comp)
(59 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"METRO","MET",.)
(47 real changes made)

. replace comp=subinstr(comp,"TECHNOLOGIES","TECHNOL",.)
(20 real changes made)

. replace comp=subinstr(comp,"DATA MM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"DATAMM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"INSTRUMENT","INSTR",.)
(30 real changes made)

. replace comp=subinstr(comp,"INSTRMN","INSTR",.)
(0 real changes made)

. replace comp=subinstr(comp,"MOTORS","MTR",.)
(13 real changes made)

. replace comp=subinstr(comp,"INSTITUTE","INST",.)
(7 real changes made)

. replace comp=subinword(comp,"GENUINE","GENUIN",.)
(0 real changes made)

. replace comp=subinword(comp,"PARTS","PART",.)
(7 real changes made)

. replace comp=subinword(comp,"TEL","TE",.)
(6 real changes made)

. replace comp=subinword(comp,"GLOBALSTAR","GLBLSTR",.)
(1 real change made)

. replace comp=subinstr(comp,",","",.)
(0 real changes made)

. replace comp=subinword(comp,"GOODYR E","GOODYR",.)
(0 real changes made)

. replace comp=subinword(comp,"W","",.)
(16 real changes made)

. replace comp=subinword(comp,"GRAINGER","GRAINGR",.)
(0 real changes made)

. replace comp=subinword(comp,"CHEMCL","CH",.)
(40 real changes made)

. replace comp=subinword(comp,"SP","",.)
(225 real changes made)

. replace comp=trim(comp)
(17 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.10952016

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"PACKARD","PCK",.)
(9 real changes made)

. replace comp=subinword(comp,"HOTELS","HTL",.)
(12 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"PACKARD","PCK",.)
(1 real change made)

. replace comp=subinword(comp,"HOTELS","HTL",.)
(25 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.10952016

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"TROY","TR",.)
(0 real changes made)

. replace comp=subinword(comp,"MEYERS","MEYR",.)
(1 real change made)

. replace comp=subinword(comp,"H J","HJ",.)
(1 real change made)

. replace comp=subinword(comp,"HOTL","HTL",.)
(2 real changes made)

. replace comp=subinword(comp,"HEALTHDYNE","HLTHDNE",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOL","TEC",.)
(3 real changes made)

. replace comp=subinword(comp,"CELANESE","",.)
(3 real changes made)

. replace comp=subinword(comp,"CEL","",.)
(2 real changes made)

. replace comp=subinword(comp,"MIFFLIN","MF",.)
(0 real changes made)

. replace comp=subinword(comp,"LTPWR","LP",.)
(0 real changes made)

. replace comp=subinword(comp,"HOST","HST",.)
(2 real changes made)

. replace comp=subinword(comp,"SUPPLY","SPLY",.)
(88 real changes made)

. replace comp=subinword(comp,"MATERIALS HNDLG","",.)
(0 real changes made)

. replace comp=subinword(comp,"SOLUTIONS","",.)
(109 real changes made)

. replace comp=trim(comp)
(96 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"TROY","TR",.)
(3 real changes made)

. replace comp=subinword(comp,"MEYERS","MEYR",.)
(1 real change made)

. replace comp=subinword(comp,"H J","HJ",.)
(0 real changes made)

. replace comp=subinword(comp,"HOTL","HTL",.)
(0 real changes made)

. replace comp=subinword(comp,"HEALTHDYNE","HLTHDNE",.)
(1 real change made)

. replace comp=subinword(comp,"TECHNOL","TEC",.)
(7 real changes made)

. replace comp=subinword(comp,"CELANESE","",.)
(1 real change made)

. replace comp=subinword(comp,"CEL","",.)
(1 real change made)

. replace comp=subinword(comp,"MIFFLIN","MF",.)
(0 real changes made)

. replace comp=subinword(comp,"LTPWR","LP",.)
(0 real changes made)

. replace comp=subinword(comp,"HOST","HST",.)
(5 real changes made)

. replace comp=subinword(comp,"SUPPLY","SPLY",.)
(25 real changes made)

. replace comp=subinword(comp,"MATERIALS HNDLG","",.)
(1 real change made)

. replace comp=subinword(comp,"SOLUTIONS","",.)
(144 real changes made)

. replace comp=trim(comp)
(136 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3 

. mergeRate
.10985419

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"CHASE","CHSE",.)
(20 real changes made)

. replace comp=subinword(comp,"J P MORGAN","JPMORGAN",.)
(4 real changes made)

. replace comp=subinword(comp,"CIRCUIT","CRCT",.)
(10 real changes made)

. replace comp=subinword(comp,"NTROLS","CNTL",.)
(0 real changes made)

. replace comp=subinword(comp,"JOHNSONJOHNSON","JOHNSNJHNS",.)
(0 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"CHASE","CHSE",.)
(6 real changes made)

. replace comp=subinword(comp,"J P MORGAN","JPMORGAN",.)
(0 real changes made)

. replace comp=subinword(comp,"CIRCUIT","CRCT",.)
(5 real changes made)

. replace comp=subinword(comp,"NTROLS","CNTL",.)
(0 real changes made)

. replace comp=subinword(comp,"JOHNSONJOHNSON","JOHNSNJHNS",.)
(0 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate
.10986044

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(1 real change made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(1 real change made)

. replace toClean = subinstr(toClean, " ", "", .)                                  
>                                //BLUNT way of improving match, remove white space
variable toClean not found
r(111);

end of do-file

r(111);

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(1 real change made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(1 real change made)

. replace comp = subinstr(comp, " ", "", .)                                        
>                                //BLUNT way of improving match, remove white space
(24,277 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(2 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(6 real changes made)

. replace comp = subinstr(comp, " ", "", .)                                        
>                                //BLUNT way of improving match, remove white space
(22,246 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10986044
.1139288

. 
end of do-file

. di 143-86
57

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. clear all

. set more off

. macro drop _all

. set scheme s1color

. set matsize 10000

. 
. *Paths
. global wd "C:/Users/dyevre/Documents/mres_paper"

. global orig "$wd/orig"

. global data "$wd/data/001_network"

. global outputs "$wd/outputs"

. global doc "$wd/doc"

. global code "$wd/code"

. global log "$wd/log"

. 
. *do-file number, used to save outputs 
. global doNum "002"                                      

. 
. *log
. cap log close
-----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 opened on:  28 Jan 2020, 20:03:40

. 
. /*******************************************************************************
>         EXACT MERGE
> *******************************************************************************/
. 
. *Keeping only supplier firms who have financial data
. *use "$data/001_network/001_supplierList.dta", clear
. *merge 1:1 gvkey comp using "$data/001_network/001_companyList_6119.dta"
. *KEEPING ALL firms for now
. 
. *Customer to company exact merge
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"                            
>        // 1 to many merge as several companies in Compustat have the same name bu
> t different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,250

. local merged = `r(N)'

. count if _merge == 1
  35,276

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.00% merge
.05995843

. 
. *Supplier to company exact merge
. use "$data/001_supplierList.dta", clear

. merge 1:1 /*gvkey*/ comp using "$data/001_companyList_6119.dta"
(note: variable comp was str28, now str30 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                        17,690
        from master                       286  (_merge==1)
        from using                     17,404  (_merge==2)

    matched                            15,450  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  15,450

. local merged = `r(N)'

. count if _merge == 1
  286

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //98.18% merge
.98182511

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM: SETUP AND PROGRAMS
> *******************************************************************************/
. 
. *Using the cleaning algorithm from AHRS
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp
 18.                 sort comp
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp
 27.                 sort comp
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/matched", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM: IMPLEMENTATION IN SEVERAL ROUNDS OF MANUAL CLEAN
> ING
> *******************************************************************************/
. 
. *1st round
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(853 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(46 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(11 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(49 real changes made)

. replace comp=subinword(comp,"CO","",.)
(1,362 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(111 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(60 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(499 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(76 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(22 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(124 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(125 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(24 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(156 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(518 real changes made)

. replace comp=trim(comp)
(1,615 real changes made)

. sort comp

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09146594
.09146594

. 
. *2nd
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"A T & T","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"GROUP","",.)
(703 real changes made)

. replace comp=subinstr(comp,"HEALTHCARE","HTHCR",.)
(108 real changes made)

. replace comp=subinstr(comp,"SPON ADR","",.)
(32 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT SYSTEM","ABF FREIGHT",.)
(0 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT","ABF",.)
(1 real change made)

. replace comp=subinstr(comp,"PLC","",.)
(106 real changes made)

. replace comp=subinstr(comp,"HOLDINGS","",.)
(178 real changes made)

. replace comp=subinstr(comp,"ADR","",.)
(397 real changes made)

. replace comp=subinstr(comp,"INDUSTRIES","IND",.)
(115 real changes made)

. replace comp=subinstr(comp,"UNITED","UTD",.)
(6 real changes made)

. replace comp=trim(comp)
(1,093 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"A T & T","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"SPON ADR","",.)
(0 real changes made)

. replace comp=subinstr(comp,"PLC","",.)
(2 real changes made)

. replace comp=subinstr(comp,"GROUP","",.)
(1,103 real changes made)

. replace comp=subinstr(comp,"HEALTHCARE","HTHCR",.)
(119 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT SYSTEM","ABF FREIGHT",.)
(1 real change made)

. replace comp=subinstr(comp,"ABF FREIGHT","ABF",.)
(1 real change made)

. replace comp=subinstr(comp,"HOLDINGS","",.)
(815 real changes made)

. replace comp=subinstr(comp,"ADR","",.)
(290 real changes made)

. replace comp=subinstr(comp,"INDUSTRIES","IND",.)
(645 real changes made)

. replace comp=subinstr(comp,"UNITED","UTD",.)
(4 real changes made)

. replace comp=trim(comp)
(1,788 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09685959
.09685959

. 
. *3rd
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"TELECOMMUNICATIONS","TELEM",.)
(27 real changes made)

. replace comp=subinstr(comp,"CL A","",.)
(65 real changes made)

. replace comp=subinstr(comp,"MMUNICATIONS","MMUN",.)
(172 real changes made)

. replace comp=subinstr(comp,"ADVANCED MICRO DEVICES","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"ADV MICRO DV","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"CP","",.)
(367 real changes made)

. replace comp=subinstr(comp,"CMPTRS","MPUTERS",.)
(1 real change made)

. replace comp=subinstr(comp,"AHA BETA","AHA BETA TECHNOLOGY",.)
(1 real change made)

. replace comp=subinstr(comp,"PRDS&CH","PRODUCTS & CHEMICALS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRTOUCH CM","AIRTOUCH COMMUNICATIONS",.)
(1 real change made)

. replace comp=subinstr(comp,"INTERNATIONAL","INTL",.)
(376 real changes made)

. replace comp=subinstr(comp,"POWER","PWR",.)
(286 real changes made)

. replace comp=subinstr(comp,"'","",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","",.)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"TELEMMUNICATIONS","TELEM",.)
(0 real changes made)

. replace comp=subinstr(comp,"MMUNICATIONS","MMUN",.)
(277 real changes made)

. replace comp=subinstr(comp,"ADVANCED MICRO DEVICES","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"ADV MICRO DV","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"CL A","",.)
(498 real changes made)

. replace comp=subinstr(comp,"CP","",.)
(437 real changes made)

. replace comp=subinstr(comp,"CMPTRS","MPUTERS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AHA BETA","AHA BETA TECHNOLOGY",.)
(1 real change made)

. replace comp=subinstr(comp,"PRDS&CH","PRODUCTS & CHEMICALS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRTOUCH CM","AIRTOUCH COMMUNICATIONS",.)
(0 real changes made)

. replace comp=subinstr(comp,"INTERNATIONAL","INTL",.)
(483 real changes made)

. replace comp=subinstr(comp,"POWER","PWR",.)
(208 real changes made)

. replace comp=subinstr(comp,"'","",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","",.)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09804468
.09804468

. 
. *4th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"SA","",.)
(428 real changes made)

. replace comp=subinstr(comp,"PRODUCTS","PROD",.)
(128 real changes made)

. replace comp=subinstr(comp,"ELECTRONICS","ELECT",.)
(173 real changes made)

. replace comp=trim(comp)
(666 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"PRODUCTS","PROD",.)
(158 real changes made)

. replace comp=subinstr(comp,"ELECTRONICS","ELECT",.)
(80 real changes made)

. replace comp=subinword(comp,"SA","",.)
(145 real changes made)

. replace comp=trim(comp)
(828 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10131343
.10131343

. 
. *5th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"AMERICA","AMER",.)
(312 real changes made)

. replace comp=subinstr(comp,".","",.)
(0 real changes made)

. replace comp=subinstr(comp,"HYDRO ELECTRIC","HYD",.)
(0 real changes made)

. replace comp=subinstr(comp,"OLD","",.)
(198 real changes made)

. replace comp=subinstr(comp,"TRUST","TR",.)
(53 real changes made)

. replace comp=subinstr(comp,"BARCLAYS BANK","BARCLAYS",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","&",.)
(0 real changes made)

. replace comp=subinstr(comp,"NOBLE","NOBL",.)
(25 real changes made)

. replace comp=subinstr(comp,"BANK","BK",.)
(238 real changes made)

. replace comp=subinstr(comp,"NEW","",.)
(262 real changes made)

. replace comp=subinstr(comp,"WRIGHT","WRGHT",.)
(4 real changes made)

. replace comp=trim(comp)
(96 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"AMERICA","AMER",.)
(657 real changes made)

. replace comp=subinstr(comp,".","",.)
(0 real changes made)

. replace comp=subinstr(comp,"HYDRO ELECTRIC","HYD",.)
(0 real changes made)

. replace comp=subinstr(comp,"OLD","",.)
(1,104 real changes made)

. replace comp=subinstr(comp,"TRUST","TR",.)
(346 real changes made)

. replace comp=subinstr(comp,"BARCLAYS BANK","BARCLAYS",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","&",.)
(0 real changes made)

. replace comp=subinstr(comp,"NOBLE","NOBL",.)
(7 real changes made)

. replace comp=subinstr(comp,"BANK","BK",.)
(356 real changes made)

. replace comp=subinstr(comp,"NEW","",.)
(232 real changes made)

. replace comp=subinstr(comp,"WRIGHT","WRGHT",.)
(14 real changes made)

. replace comp=trim(comp)
(433 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10332145
.10332145

. 
. *6th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"A G","AG",.)
(90 real changes made)

. replace comp=subinstr(comp,"AEROSPACE","AEROSPAC",.)
(31 real changes made)

. replace comp=subinstr(comp,"(","",.)
(0 real changes made)

. replace comp=subinstr(comp,")","",.)
(0 real changes made)

. replace comp=subinstr(comp,"L L","LL",.)
(169 real changes made)

. replace comp=subinstr(comp,"STEARNS","STRNS",.)
(1 real change made)

. replace comp=subinstr(comp,"DICKINSON &","DICK",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCRAFT","AIRCR",.)
(10 real changes made)

. replace comp=subinstr(comp,"AIRCRFT","AIRCR",.)
(5 real changes made)

. replace comp=subinstr(comp,"CANADA","CDA",.)
(70 real changes made)

. replace comp=subinstr(comp,"PROJECTED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"TELEM","TEL",.)
(37 real changes made)

. replace comp=subinstr(comp,"BETHLEHEM","BETHLHM",.)
(1 real change made)

. replace comp=subinstr(comp,"STEEL","STL",.)
(162 real changes made)

. replace comp=subinstr(comp,"ENTERPRISES","ENT",.)
(48 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"A G","AG",.)
(86 real changes made)

. replace comp=subinstr(comp,"AEROSPACE","AEROSPAC",.)
(15 real changes made)

. replace comp=subinstr(comp,"(","",.)
(0 real changes made)

. replace comp=subinstr(comp,")","",.)
(0 real changes made)

. replace comp=subinstr(comp,"L L","LL",.)
(82 real changes made)

. replace comp=subinstr(comp,"STEARNS","STRNS",.)
(3 real changes made)

. replace comp=subinstr(comp,"DICKINSON &","DICK",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCRAFT","AIRCR",.)
(12 real changes made)

. replace comp=subinstr(comp,"AIRCRFT","AIRCR",.)
(1 real change made)

. replace comp=subinstr(comp,"CANADA","CDA",.)
(22 real changes made)

. replace comp=subinstr(comp,"PROJECTED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"TELEM","TEL",.)
(14 real changes made)

. replace comp=subinstr(comp,"BETHLEHEM","BETHLHM",.)
(3 real changes made)

. replace comp=subinstr(comp,"STEEL","STL",.)
(66 real changes made)

. replace comp=subinstr(comp,"ENTERPRISES","ENT",.)
(111 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10360133
.10360133

. 
. *7th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"BIG THREE","BIG THREE IND",.)
(1 real change made)

. replace comp=subinstr(comp,"LLC","",.)
(864 real changes made)

. replace comp=subinstr(comp,"BORG WARNER","",.)
(1 real change made)

. replace comp=subinstr(comp,"SCIENTIFIC","SCI",.)
(18 real changes made)

. replace comp=subinstr(comp,"ADS","BP",.)
(31 real changes made)

. replace comp=subinstr(comp,"BRIGGS&STRATTON","BRIGG&STRN",.)
(0 real changes made)

. replace comp=subinstr(comp,"MYERS SQUIBB","MYRS",.)
(3 real changes made)

. replace comp=subinstr(comp,"CA CL","CA LA",.)
(1 real change made)

. replace comp=subinstr(comp,"GOLF","GF",.)
(13 real changes made)

. replace comp=subinstr(comp,"SOUP","SP",.)
(2 real changes made)

. replace comp=subinstr(comp,"CAMPBELL","CAMPBL",.)
(2 real changes made)

. replace comp=subinstr(comp,"FINANCIAL","FINL",.)
(57 real changes made)

. replace comp=subinstr(comp,"NATURAL GAS","NAT",.)
(25 real changes made)

. replace comp=subinstr(comp,"CANADIAN","CDN",.)
(18 real changes made)

. replace comp=subinstr(comp,"AIRCFT","AIRC",.)
(7 real changes made)

. replace comp=subinstr(comp,"AIRCR","AIRC",.)
(15 real changes made)

. replace comp=trim(comp)
(781 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"LLC","",.)
(136 real changes made)

. replace comp=subinstr(comp,"BORG WARNER","",.)
(0 real changes made)

. replace comp=subinstr(comp,"SCIENTIFIC","SCI",.)
(47 real changes made)

. replace comp=subinstr(comp,"BP   ADS","BP",.)
(0 real changes made)

. replace comp=subinstr(comp,"BRIGGS&STRATTON","BRIGG&STRN",.)
(0 real changes made)

. replace comp=subinstr(comp,"MYERS SQUIBB","MYRS",.)
(0 real changes made)

. replace comp=subinstr(comp,"CA CL","CA LA",.)
(0 real changes made)

. replace comp=subinstr(comp,"GOLF","GF",.)
(22 real changes made)

. replace comp=subinstr(comp,"SOUP","SP",.)
(2 real changes made)

. replace comp=subinstr(comp,"CAMPBELL","CAMPBL",.)
(5 real changes made)

. replace comp=subinstr(comp,"FINANCIAL","FINL",.)
(695 real changes made)

. replace comp=subinstr(comp,"NATURAL GAS","NAT",.)
(20 real changes made)

. replace comp=subinstr(comp,"CANADIAN","CDN",.)
(13 real changes made)

. replace comp=subinstr(comp,"AIRCFT","AIRC",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCR","AIRC",.)
(11 real changes made)

. replace comp=trim(comp)
(85 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10459838
.10459838

. 
. *8th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"ROEBK","",.)
(1 real change made)

. replace comp=subinstr(comp,"ROEBUCK &","",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIR LINES","AIRL",.)
(4 real changes made)

. replace comp=trim(comp)
(1 real change made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"ROEBK","",.)
(0 real changes made)

. replace comp=subinstr(comp,"ROEBUCK &","",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIR LINES","AIRL",.)
(4 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10460428
.10460428

. 
. 
. *9th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"SYSTEMS","SYS",.)
(269 real changes made)

. replace comp=subinstr(comp,"DU PONT EI DE NEMOURS","DUPONT EI",.)
(0 real changes made)

. replace comp=subinstr(comp,"EI","",.)
(669 real changes made)

. replace comp=subinstr(comp,"PRO FORMA","",.)
(16 real changes made)

. replace comp=subinstr(comp,"CREDIT","CR",.)
(25 real changes made)

. replace comp=subinstr(comp,"LIGHT","LT",.)
(52 real changes made)

. replace comp=subinstr(comp,"CHEMICAL","CHEMICL",.)
(124 real changes made)

. replace comp=subinstr(comp,"&","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DISCREET","DISCRT",.)
(0 real changes made)

. replace comp=subinstr(comp,"LOGIC","LGC",.)
(36 real changes made)

. replace comp=subinstr(comp,"TELEKOM","TELE",.)
(8 real changes made)

. replace comp=subinstr(comp,"TLKOM","TELE",.)
(1 real change made)

. replace comp=subinstr(comp,"DEUTSCHE","DTSCH",.)
(19 real changes made)

. 
. replace comp=subinstr(comp,"PWRLIGHT","PL",.)
(0 real changes made)

. replace comp=subinstr(comp,"SUPERMARKETS","SUPERMKTS",.)
(9 real changes made)

. replace comp=subinstr(comp,"CAPITAL","CAP",.)
(75 real changes made)

. replace comp=subinstr(comp,"GRAND ICE CREAM","",.)
(1 real change made)

. replace comp=subinstr(comp,"DREAMS","DRMS",.)
(2 real changes made)

. replace comp=subinstr(comp,"EMPORIUM","EMPORM",.)
(1 real change made)

. replace comp=subinstr(comp,"HARDWAREGARDEN","HRDWR",.)
(0 real changes made)

. replace comp=subinstr(comp,"KODAK","KDK",.)
(3 real changes made)

. replace comp=subinstr(comp,"MAN","MN",.)
(485 real changes made)

. replace comp=subinstr(comp,"STORES","",.)
(5 real changes made)

. replace comp=subinstr(comp,"BROTHERS","BROS",.)
(16 real changes made)

. replace comp=subinstr(comp,"AG","",.)
(1,007 real changes made)

. replace comp=subinstr(comp,"ELECTRONIC","ELEC",.)
(57 real changes made)

. replace comp=trim(comp)
(170 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"SYSTEMS","SYS",.)
(592 real changes made)

. replace comp=subinstr(comp,"DU PONT EI DE NEMOURS","DUPONT EI",.)
(0 real changes made)

. replace comp=subinstr(comp,"EI","",.)
(303 real changes made)

. replace comp=subinstr(comp,"PRO FORMA","",.)
(5 real changes made)

. replace comp=subinstr(comp,"CREDIT","CR",.)
(67 real changes made)

. replace comp=subinstr(comp,"LIGHT","LT",.)
(59 real changes made)

. replace comp=subinstr(comp,"CHEMICAL","CHEMICL",.)
(66 real changes made)

. replace comp=subinstr(comp,"&","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DISCREET","DISCRT",.)
(0 real changes made)

. replace comp=subinstr(comp,"LOGIC","LGC",.)
(59 real changes made)

. replace comp=subinstr(comp,"TELEKOM","TELE",.)
(5 real changes made)

. replace comp=subinstr(comp,"TLKOM","TELE",.)
(0 real changes made)

. replace comp=subinstr(comp,"DEUTSCHE","DTSCH",.)
(19 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(0 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(0 real changes made)

. replace comp=subinstr(comp,"PWRLIGHT","PL",.)
(0 real changes made)

. replace comp=subinstr(comp,"SUPERMARKETS","SUPERMKTS",.)
(8 real changes made)

. replace comp=subinstr(comp,"CAPITAL","CAP",.)
(327 real changes made)

. replace comp=subinstr(comp,"GRAND ICE CREAM","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DREAMS","DRMS",.)
(2 real changes made)

. replace comp=subinstr(comp,"EMPORIUM","EMPORM",.)
(0 real changes made)

. replace comp=subinstr(comp,"HARDWAREGARDEN","HRDWR",.)
(0 real changes made)

. replace comp=subinstr(comp,"KODAK","KDK",.)
(0 real changes made)

. replace comp=subinstr(comp,"MAN","MN",.)
(363 real changes made)

. replace comp=subinstr(comp,"STORES","",.)
(4 real changes made)

. replace comp=subinstr(comp,"BROTHERS","BROS",.)
(21 real changes made)

. replace comp=subinstr(comp,"AG","",.)
(971 real changes made)

. replace comp=subinstr(comp,"ELECTRONIC","",.)
(29 real changes made)

. replace comp=trim(comp)
(54 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10609787
.10609787

. 
. *10th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"GAS","GS",.)
(436 real changes made)

. replace comp=subinstr(comp,"TOWN","TWN",.)
(28 real changes made)

. replace comp=subinstr(comp,"L M","",.)
(185 real changes made)

. replace comp=subinstr(comp,"LM","",.)
(186 real changes made)

. replace comp=subinstr(comp,"TELEFON","TEL",.)
(16 real changes made)

. replace comp=trim(comp)
(3 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"GAS","GS",.)
(181 real changes made)

. replace comp=subinstr(comp,"TOWN","TWN",.)
(37 real changes made)

. replace comp=subinstr(comp,"L M","",.)
(216 real changes made)

. replace comp=subinstr(comp,"LM","",.)
(200 real changes made)

. replace comp=subinstr(comp,"TELEFON","TEL",.)
(8 real changes made)

. replace comp=trim(comp)
(1 real change made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.1062067
.1062067

. 
. *11th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"ERICSSON TEL","ERCSON TELE",.)
(1 real change made)

. replace comp=subinstr(comp,"WHEELER","WHLR",.)
(3 real changes made)

. replace comp=subinstr(comp,"FISHER","FISHR",.)
(16 real changes made)

. replace comp=subinstr(comp,"SCIEN","SCI",.)
(125 real changes made)

. replace comp=subinstr(comp,"INTL","",.)
(575 real changes made)

. replace comp=subinstr(comp,"FED EXPRESS","FEDEX",.)
(1 real change made)

. replace comp=subinstr(comp,"WOOD","WD",.)
(78 real changes made)

. replace comp=subinstr(comp,"FLA ROCK","FLORIDA ROCK",.)
(1 real change made)

. replace comp=subinstr(comp,"STONE","STN",.)
(55 real changes made)

. replace comp=subinstr(comp,"TIRERUBBER","TIR",.)
(0 real changes made)

. replace comp=subinstr(comp,"TIR","",.)
(38 real changes made)

. replace comp=subinstr(comp,"CENTER","CNTR",.)
(149 real changes made)

. replace comp=subinstr(comp,"","YR",.)
(0 real changes made)

. replace comp=subinstr(comp,"NSOLIDATED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"MIC","MC",.)
(468 real changes made)

. replace comp=subinstr(comp,"ELECTRIC","ELEC",.)
(207 real changes made)

. replace comp=subinstr(comp,"ELEC","EL",.)
(849 real changes made)

. replace comp=subinstr(comp,"NSOL","",.)
(13 real changes made)

. replace comp=subinstr(comp,"PACIFIC","PAC",.)
(81 real changes made)

. replace comp=subinstr(comp,"W R","WR",.)
(7 real changes made)

. replace comp=trim(comp)
(439 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"ERICSSON TEL","ERCSON TELE",.)
(0 real changes made)

. replace comp=subinstr(comp,"WHEELER","WHLR",.)
(1 real change made)

. replace comp=subinstr(comp,"FISHER","FISHR",.)
(8 real changes made)

. replace comp=subinstr(comp,"SCIEN","SCI",.)
(190 real changes made)

. replace comp=subinstr(comp,"INTL","",.)
(1,068 real changes made)

. replace comp=subinstr(comp,"FED EXPRESS","FEDEX",.)
(0 real changes made)

. replace comp=subinstr(comp,"WOOD","WD",.)
(86 real changes made)

. replace comp=subinstr(comp,"FLA ROCK","FLORIDA ROCK",.)
(0 real changes made)

. replace comp=subinstr(comp,"STONE","STN",.)
(114 real changes made)

. replace comp=subinstr(comp,"TIRERUBBER","TIR",.)
(0 real changes made)

. replace comp=subinstr(comp,"TIR","",.)
(13 real changes made)

. replace comp=subinstr(comp,"CENTER","CNTR",.)
(69 real changes made)

. replace comp=subinstr(comp,"","YR",.)
(0 real changes made)

. replace comp=subinstr(comp,"NSOLIDATED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"MIC","MC",.)
(370 real changes made)

. replace comp=subinstr(comp,"ELECTRIC","ELEC",.)
(65 real changes made)

. replace comp=subinstr(comp,"ELEC","EL",.)
(347 real changes made)

. replace comp=subinstr(comp,"NSOL","",.)
(12 real changes made)

. replace comp=subinstr(comp,"PACIFIC","PAC",.)
(133 real changes made)

. replace comp=subinstr(comp,"W R","WR",.)
(15 real changes made)

. replace comp=trim(comp)
(851 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10918382
.10918382

. 
. *12th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"METRO","MET",.)
(48 real changes made)

. replace comp=subinstr(comp,"TECHNOLOGIES","TECHNOL",.)
(5 real changes made)

. replace comp=subinstr(comp,"DATA MM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"DATAMM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"INSTRUMENT","INSTR",.)
(10 real changes made)

. replace comp=subinstr(comp,"INSTRMN","INSTR",.)
(2 real changes made)

. replace comp=subinstr(comp,"MOTORS","MTR",.)
(26 real changes made)

. replace comp=subinstr(comp,"INSTITUTE","INST",.)
(57 real changes made)

. replace comp=subinword(comp,"GENUINE","GENUIN",.)
(1 real change made)

. replace comp=subinword(comp,"PARTS","PART",.)
(19 real changes made)

. replace comp=subinword(comp,"TEL","TE",.)
(76 real changes made)

. replace comp=subinword(comp,"GLOBALSTAR","GLBLSTR",.)
(0 real changes made)

. replace comp=subinstr(comp,",","",.)
(0 real changes made)

. replace comp=subinword(comp,"GOODYR E","GOODYR",.)
(1 real change made)

. replace comp=subinword(comp,"W","",.)
(48 real changes made)

. replace comp=subinword(comp,"GRAINGER","GRAINGR",.)
(3 real changes made)

. replace comp=subinword(comp,"CHEMCL","CH",.)
(83 real changes made)

. replace comp=subinword(comp,"SP","",.)
(34 real changes made)

. replace comp=trim(comp)
(59 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"METRO","MET",.)
(47 real changes made)

. replace comp=subinstr(comp,"TECHNOLOGIES","TECHNOL",.)
(20 real changes made)

. replace comp=subinstr(comp,"DATA MM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"DATAMM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"INSTRUMENT","INSTR",.)
(30 real changes made)

. replace comp=subinstr(comp,"INSTRMN","INSTR",.)
(0 real changes made)

. replace comp=subinstr(comp,"MOTORS","MTR",.)
(13 real changes made)

. replace comp=subinstr(comp,"INSTITUTE","INST",.)
(7 real changes made)

. replace comp=subinword(comp,"GENUINE","GENUIN",.)
(0 real changes made)

. replace comp=subinword(comp,"PARTS","PART",.)
(7 real changes made)

. replace comp=subinword(comp,"TEL","TE",.)
(6 real changes made)

. replace comp=subinword(comp,"GLOBALSTAR","GLBLSTR",.)
(1 real change made)

. replace comp=subinstr(comp,",","",.)
(0 real changes made)

. replace comp=subinword(comp,"GOODYR E","GOODYR",.)
(0 real changes made)

. replace comp=subinword(comp,"W","",.)
(16 real changes made)

. replace comp=subinword(comp,"GRAINGER","GRAINGR",.)
(0 real changes made)

. replace comp=subinword(comp,"CHEMCL","CH",.)
(40 real changes made)

. replace comp=subinword(comp,"SP","",.)
(225 real changes made)

. replace comp=trim(comp)
(17 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10952016
.10952016

. 
. *13th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"PACKARD","PCK",.)
(9 real changes made)

. replace comp=subinword(comp,"HOTELS","HTL",.)
(12 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"PACKARD","PCK",.)
(1 real change made)

. replace comp=subinword(comp,"HOTELS","HTL",.)
(25 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10952016
.10952016

. 
. *14th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"TROY","TR",.)
(0 real changes made)

. replace comp=subinword(comp,"MEYERS","MEYR",.)
(1 real change made)

. replace comp=subinword(comp,"H J","HJ",.)
(1 real change made)

. replace comp=subinword(comp,"HOTL","HTL",.)
(2 real changes made)

. replace comp=subinword(comp,"HEALTHDYNE","HLTHDNE",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOL","TEC",.)
(3 real changes made)

. replace comp=subinword(comp,"CELANESE","",.)
(3 real changes made)

. replace comp=subinword(comp,"CEL","",.)
(2 real changes made)

. replace comp=subinword(comp,"MIFFLIN","MF",.)
(0 real changes made)

. replace comp=subinword(comp,"LTPWR","LP",.)
(0 real changes made)

. replace comp=subinword(comp,"HOST","HST",.)
(2 real changes made)

. replace comp=subinword(comp,"SUPPLY","SPLY",.)
(88 real changes made)

. replace comp=subinword(comp,"MATERIALS HNDLG","",.)
(0 real changes made)

. replace comp=subinword(comp,"SOLUTIONS","",.)
(109 real changes made)

. replace comp=trim(comp)
(96 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"TROY","TR",.)
(3 real changes made)

. replace comp=subinword(comp,"MEYERS","MEYR",.)
(1 real change made)

. replace comp=subinword(comp,"H J","HJ",.)
(0 real changes made)

. replace comp=subinword(comp,"HOTL","HTL",.)
(0 real changes made)

. replace comp=subinword(comp,"HEALTHDYNE","HLTHDNE",.)
(1 real change made)

. replace comp=subinword(comp,"TECHNOL","TEC",.)
(7 real changes made)

. replace comp=subinword(comp,"CELANESE","",.)
(1 real change made)

. replace comp=subinword(comp,"CEL","",.)
(1 real change made)

. replace comp=subinword(comp,"MIFFLIN","MF",.)
(0 real changes made)

. replace comp=subinword(comp,"LTPWR","LP",.)
(0 real changes made)

. replace comp=subinword(comp,"HOST","HST",.)
(5 real changes made)

. replace comp=subinword(comp,"SUPPLY","SPLY",.)
(25 real changes made)

. replace comp=subinword(comp,"MATERIALS HNDLG","",.)
(1 real change made)

. replace comp=subinword(comp,"SOLUTIONS","",.)
(144 real changes made)

. replace comp=trim(comp)
(136 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3 

. mergeRate       //.10985419
.10985419

. 
. *15th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"CHASE","CHSE",.)
(20 real changes made)

. replace comp=subinword(comp,"J P MORGAN","JPMORGAN",.)
(4 real changes made)

. replace comp=subinword(comp,"CIRCUIT","CRCT",.)
(10 real changes made)

. replace comp=subinword(comp,"NTROLS","CNTL",.)
(0 real changes made)

. replace comp=subinword(comp,"JOHNSONJOHNSON","JOHNSNJHNS",.)
(0 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"CHASE","CHSE",.)
(6 real changes made)

. replace comp=subinword(comp,"J P MORGAN","JPMORGAN",.)
(0 real changes made)

. replace comp=subinword(comp,"CIRCUIT","CRCT",.)
(5 real changes made)

. replace comp=subinword(comp,"NTROLS","CNTL",.)
(0 real changes made)

. replace comp=subinword(comp,"JOHNSONJOHNSON","JOHNSNJHNS",.)
(0 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10986044
.10986044

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace custname=subinstr(custname,"AM TEL &TEL","AT&T",.)
variable custname not found
r(111);

end of do-file

r(111);

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"AM TEL &TEL","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"-","",.)
(0 real changes made)

. replace comp=subinword(comp,"CL","",.)
(18 real changes made)

. replace comp=subinword(comp,"A","",.)
(153 real changes made)

. replace comp=subinword(comp,"HLDG","",.)
(13 real changes made)

. replace comp=subinword(comp,"WARD","WD",.)
(4 real changes made)

. replace comp=subinword(comp,"MONTGOMERY","MONTGMY",.)
(2 real changes made)

. replace comp=subinstr(comp,"PR","",.)
(1,273 real changes made)

. replace comp=subinword(comp,"CORP","",.)
(0 real changes made)

. replace comp=subinword(comp,"CO","",.)
(37 real changes made)

. replace comp=subinword(comp,"CP","",.)
(0 real changes made)

. replace comp=subinword(comp,"INC","",.)
(0 real changes made)

. replace comp=subinword(comp,"DAIMLERCHRYSLER","DAIMLER",.)
(5 real changes made)

. replace comp=subinword(comp,"AG","",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(44 real changes made)

. replace comp=subinword(comp,"EASTMAN","EASTMN",.)
(0 real changes made)

. replace comp=subinword(comp,"KODAK","KODK",.)
(0 real changes made)

. replace comp=subinword(comp,"MACHINES","MA",.)
(3 real changes made)

. replace comp=subinword(comp,"BUSINESS","BUS",.)
(34 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(7 real changes made)

. replace comp=subinword(comp,"EQUIPMENT","EQ",.)
(48 real changes made)

. replace comp=subinword(comp,"PROCTER","PRCTR",.)
(0 real changes made)

. replace comp=subinword(comp,"GAMBLE","GM",.)
(6 real changes made)

. replace comp=subinword(comp,"GENERAL","GEN",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTORS","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"FUNDING","",.)
(5 real changes made)

. replace comp=subinword(comp,"(J C)","(JC)",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(1 real change made)

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(0 real changes made)

. replace comp=subinword(comp,"EXXON MOBIL","EXXON",.)
(0 real changes made)

. replace comp=subinword(comp,"SPRINT NEXTEL","SPRINT",.)
(0 real changes made)

. replace comp=subinword(comp,"INSTRUMENTS","INSTR",.)
(0 real changes made)

. replace comp=subinword(comp,"TEXAS","TX",.)
(60 real changes made)

. replace comp=subinword(comp,"DU PONT (E I) DE NEMOURS","DUPONT (EI)",.)
(0 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(0 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(0 real changes made)

. replace comp=subinword(comp,"RICHFIELD","RIC",.)
(0 real changes made)

. replace comp=subinword(comp,"INTERNATIONAL","INTL",.)
(0 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(0 real changes made)

. replace comp=subinword(comp,"ANHEUSER-BUSCH","ANHEUSR-BSH",.)
(0 real changes made)

. replace comp=subinword(comp,"LOCKHEED MARTIN","LOCKHEED",.)
(4 real changes made)

. replace comp=subinword(comp,"LOCKHD MART","LOCKHEED",.)
(1 real change made)

. replace comp=subinword(comp,"LABORATORIES","LABS",.)
(0 real changes made)

. replace comp=subinword(comp,"AMERICAN","",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGYOLD","TEC",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGY","TEC",.)
(339 real changes made)

. replace comp=subinword(comp,"HOSPITAL","HOSP",.)
(69 real changes made)

. replace comp=subinword(comp,"SUPPLY","SUP",.)
(0 real changes made)

. replace comp=subinword(comp,"PHILIP","PHIL",.)
(8 real changes made)

. replace comp=subinword(comp,"MORRIS","MOR",.)
(7 real changes made)

. replace comp=subinword(comp,"NORTHROP GRUMMAN","NORTHROP",.)
(0 real changes made)

. replace comp=subinword(comp,"LOWE'S COMPANIES","LOWES COS",.)
(0 real changes made)

. replace comp=subinword(comp,"MARIETTA","MRTA",.)
(0 real changes made)

. replace comp=subinword(comp,"MICROSYSTEMS","MICRO",.)
(0 real changes made)

. replace comp=trim(comp)
(168 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"AM TEL &TEL","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"-","",.)
(0 real changes made)

. replace comp=subinword(comp,"CL","",.)
(59 real changes made)

. replace comp=subinword(comp,"A","",.)
(102 real changes made)

. replace comp=subinword(comp,"HLDG","",.)
(63 real changes made)

. replace comp=subinword(comp,"WARD","WD",.)
(4 real changes made)

. replace comp=subinword(comp,"MONTGOMERY","MONTGMY",.)
(4 real changes made)

. replace comp=subinstr(comp,"PR","",.)
(1,446 real changes made)

. replace comp=subinword(comp,"CORP","",.)
(0 real changes made)

. replace comp=subinword(comp,"CO","",.)
(38 real changes made)

. replace comp=subinword(comp,"CP","",.)
(0 real changes made)

. replace comp=subinword(comp,"INC","",.)
(0 real changes made)

. replace comp=subinword(comp,"DAIMLERCHRYSLER","DAIMLER",.)
(0 real changes made)

. replace comp=subinword(comp,"AG","",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(111 real changes made)

. replace comp=subinword(comp,"EASTMAN","EASTMN",.)
(0 real changes made)

. replace comp=subinword(comp,"KODAK","KODK",.)
(0 real changes made)

. replace comp=subinword(comp,"MACHINES","MA",.)
(3 real changes made)

. replace comp=subinword(comp,"BUSINESS","BUS",.)
(44 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(0 real changes made)

. replace comp=subinword(comp,"EQUIPMENT","EQ",.)
(23 real changes made)

. replace comp=subinword(comp,"PROCTER","PRCTR",.)
(0 real changes made)

. replace comp=subinword(comp,"GAMBLE","GM",.)
(1 real change made)

. replace comp=subinword(comp,"GENERAL","GEN",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTORS","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"FUNDING","",.)
(19 real changes made)

. replace comp=subinword(comp,"(J C)","(JC)",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(6 real changes made)

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(2 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(0 real changes made)

. replace comp=subinword(comp,"EXXON MOBIL","EXXON",.)
(0 real changes made)

. replace comp=subinword(comp,"SPRINT NEXTEL","SPRINT",.)
(0 real changes made)

. replace comp=subinword(comp,"INSTRUMENTS","INSTR",.)
(0 real changes made)

. replace comp=subinword(comp,"TEXAS","TX",.)
(37 real changes made)

. replace comp=subinword(comp,"DU PONT (E I) DE NEMOURS","DUPONT (EI)",.)
(0 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(0 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(0 real changes made)

. replace comp=subinword(comp,"RICHFIELD","RIC",.)
(1 real change made)

. replace comp=subinword(comp,"INTERNATIONAL","INTL",.)
(0 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(0 real changes made)

. replace comp=subinword(comp,"ANHEUSER-BUSCH","ANHEUSR-BSH",.)
(0 real changes made)

. replace comp=subinword(comp,"LOCKHEED MARTIN","LOCKHEED",.)
(0 real changes made)

. replace comp=subinword(comp,"LOCKHD MART","LOCKHEED",.)
(0 real changes made)

. replace comp=subinword(comp,"LABORATORIES","LABS",.)
(0 real changes made)

. replace comp=subinword(comp,"AMERICAN","",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGYOLD","TEC",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGY","TEC",.)
(277 real changes made)

. replace comp=subinword(comp,"HOSPITAL","HOSP",.)
(7 real changes made)

. replace comp=subinword(comp,"SUPPLY","SUP",.)
(0 real changes made)

. replace comp=subinword(comp,"PHILIP","PHIL",.)
(3 real changes made)

. replace comp=subinword(comp,"MORRIS","MOR",.)
(1 real change made)

. replace comp=subinword(comp,"NORTHROP GRUMMAN","NORTHROP",.)
(0 real changes made)

. replace comp=subinword(comp,"LOWE'S COMPANIES","LOWES COS",.)
(0 real changes made)

. replace comp=subinword(comp,"MARIETTA","MRTA",.)
(4 real changes made)

. replace comp=subinword(comp,"MICROSYSTEMS","MICRO",.)
(0 real changes made)

. replace comp=trim(comp)
(175 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //
.1110953

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD2854_000000.tmp"

. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(0 real changes made)

. replace comp = subinstr(comp, " ", "", .)                                        
>                                //BLUNT way of improving match, remove white space
(24,184 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(0 real changes made)

. replace comp = subinstr(comp, " ", "", .)                                        
>                                //BLUNT way of improving match, remove white space
(22,183 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //
.11509919

. 
end of do-file

. exit, clear
-----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 opened on:  29 Jan 2020, 17:52:13

. 
. /*******************************************************************************
>         EXACT MERGE
> *******************************************************************************/
. 
. *Keeping only supplier firms who have financial data
. *use "$data/001_network/001_supplierList.dta", clear
. *merge 1:1 gvkey comp using "$data/001_network/001_companyList_6119.dta"
. *KEEPING ALL firms for now
. 
. *Customer to company exact merge
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"                            
>        // 1 to many merge as several companies in Compustat have the same name bu
> t different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,250

. local merged = `r(N)'

. count if _merge == 1
  35,276

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.00% merge
.05995843

. 
. *Supplier to company exact merge
. use "$data/001_supplierList.dta", clear

. merge 1:1 /*gvkey*/ comp using "$data/001_companyList_6119.dta"
(note: variable comp was str28, now str30 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                        17,690
        from master                       286  (_merge==1)
        from using                     17,404  (_merge==2)

    matched                            15,450  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  15,450

. local merged = `r(N)'

. count if _merge == 1
  286

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //98.18% merge
.98182511

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM: SETUP AND PROGRAMS
> *******************************************************************************/
. 
. *Using the cleaning algorithm from AHRS
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp
 18.                 sort comp
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp
 27.                 sort comp
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/matched", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM: IMPLEMENTATION IN SEVERAL ROUNDS OF MANUAL CLEAN
> ING
> *******************************************************************************/
. 
. *1st round
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(853 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(46 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(11 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(49 real changes made)

. replace comp=subinword(comp,"CO","",.)
(1,362 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(111 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(60 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(499 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(76 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(22 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(124 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(125 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(24 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(156 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(518 real changes made)

. replace comp=trim(comp)
(1,615 real changes made)

. sort comp

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09146594
.09146594

. 
. *2nd
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"A T & T","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"GROUP","",.)
(703 real changes made)

. replace comp=subinstr(comp,"HEALTHCARE","HTHCR",.)
(108 real changes made)

. replace comp=subinstr(comp,"SPON ADR","",.)
(32 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT SYSTEM","ABF FREIGHT",.)
(0 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT","ABF",.)
(1 real change made)

. replace comp=subinstr(comp,"PLC","",.)
(106 real changes made)

. replace comp=subinstr(comp,"HOLDINGS","",.)
(178 real changes made)

. replace comp=subinstr(comp,"ADR","",.)
(397 real changes made)

. replace comp=subinstr(comp,"INDUSTRIES","IND",.)
(115 real changes made)

. replace comp=subinstr(comp,"UNITED","UTD",.)
(6 real changes made)

. replace comp=trim(comp)
(1,093 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"A T & T","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"SPON ADR","",.)
(0 real changes made)

. replace comp=subinstr(comp,"PLC","",.)
(2 real changes made)

. replace comp=subinstr(comp,"GROUP","",.)
(1,103 real changes made)

. replace comp=subinstr(comp,"HEALTHCARE","HTHCR",.)
(119 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT SYSTEM","ABF FREIGHT",.)
(1 real change made)

. replace comp=subinstr(comp,"ABF FREIGHT","ABF",.)
(1 real change made)

. replace comp=subinstr(comp,"HOLDINGS","",.)
(815 real changes made)

. replace comp=subinstr(comp,"ADR","",.)
(290 real changes made)

. replace comp=subinstr(comp,"INDUSTRIES","IND",.)
(645 real changes made)

. replace comp=subinstr(comp,"UNITED","UTD",.)
(4 real changes made)

. replace comp=trim(comp)
(1,788 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09685959
.09685959

. 
. *3rd
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"TELECOMMUNICATIONS","TELEM",.)
(27 real changes made)

. replace comp=subinstr(comp,"CL A","",.)
(65 real changes made)

. replace comp=subinstr(comp,"MMUNICATIONS","MMUN",.)
(172 real changes made)

. replace comp=subinstr(comp,"ADVANCED MICRO DEVICES","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"ADV MICRO DV","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"CP","",.)
(367 real changes made)

. replace comp=subinstr(comp,"CMPTRS","MPUTERS",.)
(1 real change made)

. replace comp=subinstr(comp,"AHA BETA","AHA BETA TECHNOLOGY",.)
(1 real change made)

. replace comp=subinstr(comp,"PRDS&CH","PRODUCTS & CHEMICALS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRTOUCH CM","AIRTOUCH COMMUNICATIONS",.)
(1 real change made)

. replace comp=subinstr(comp,"INTERNATIONAL","INTL",.)
(376 real changes made)

. replace comp=subinstr(comp,"POWER","PWR",.)
(286 real changes made)

. replace comp=subinstr(comp,"'","",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","",.)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"TELEMMUNICATIONS","TELEM",.)
(0 real changes made)

. replace comp=subinstr(comp,"MMUNICATIONS","MMUN",.)
(277 real changes made)

. replace comp=subinstr(comp,"ADVANCED MICRO DEVICES","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"ADV MICRO DV","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"CL A","",.)
(498 real changes made)

. replace comp=subinstr(comp,"CP","",.)
(437 real changes made)

. replace comp=subinstr(comp,"CMPTRS","MPUTERS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AHA BETA","AHA BETA TECHNOLOGY",.)
(1 real change made)

. replace comp=subinstr(comp,"PRDS&CH","PRODUCTS & CHEMICALS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRTOUCH CM","AIRTOUCH COMMUNICATIONS",.)
(0 real changes made)

. replace comp=subinstr(comp,"INTERNATIONAL","INTL",.)
(483 real changes made)

. replace comp=subinstr(comp,"POWER","PWR",.)
(208 real changes made)

. replace comp=subinstr(comp,"'","",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","",.)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09804468
.09804468

. 
. *4th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"SA","",.)
(428 real changes made)

. replace comp=subinstr(comp,"PRODUCTS","PROD",.)
(128 real changes made)

. replace comp=subinstr(comp,"ELECTRONICS","ELECT",.)
(173 real changes made)

. replace comp=trim(comp)
(666 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"PRODUCTS","PROD",.)
(158 real changes made)

. replace comp=subinstr(comp,"ELECTRONICS","ELECT",.)
(80 real changes made)

. replace comp=subinword(comp,"SA","",.)
(145 real changes made)

. replace comp=trim(comp)
(828 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10131343
.10131343

. 
. *5th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"AMERICA","AMER",.)
(312 real changes made)

. replace comp=subinstr(comp,".","",.)
(0 real changes made)

. replace comp=subinstr(comp,"HYDRO ELECTRIC","HYD",.)
(0 real changes made)

. replace comp=subinstr(comp,"OLD","",.)
(198 real changes made)

. replace comp=subinstr(comp,"TRUST","TR",.)
(53 real changes made)

. replace comp=subinstr(comp,"BARCLAYS BANK","BARCLAYS",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","&",.)
(0 real changes made)

. replace comp=subinstr(comp,"NOBLE","NOBL",.)
(25 real changes made)

. replace comp=subinstr(comp,"BANK","BK",.)
(238 real changes made)

. replace comp=subinstr(comp,"NEW","",.)
(262 real changes made)

. replace comp=subinstr(comp,"WRIGHT","WRGHT",.)
(4 real changes made)

. replace comp=trim(comp)
(96 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"AMERICA","AMER",.)
(657 real changes made)

. replace comp=subinstr(comp,".","",.)
(0 real changes made)

. replace comp=subinstr(comp,"HYDRO ELECTRIC","HYD",.)
(0 real changes made)

. replace comp=subinstr(comp,"OLD","",.)
(1,104 real changes made)

. replace comp=subinstr(comp,"TRUST","TR",.)
(346 real changes made)

. replace comp=subinstr(comp,"BARCLAYS BANK","BARCLAYS",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","&",.)
(0 real changes made)

. replace comp=subinstr(comp,"NOBLE","NOBL",.)
(7 real changes made)

. replace comp=subinstr(comp,"BANK","BK",.)
(356 real changes made)

. replace comp=subinstr(comp,"NEW","",.)
(232 real changes made)

. replace comp=subinstr(comp,"WRIGHT","WRGHT",.)
(14 real changes made)

. replace comp=trim(comp)
(433 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10332145
.10332145

. 
. *6th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"A G","AG",.)
(90 real changes made)

. replace comp=subinstr(comp,"AEROSPACE","AEROSPAC",.)
(31 real changes made)

. replace comp=subinstr(comp,"(","",.)
(0 real changes made)

. replace comp=subinstr(comp,")","",.)
(0 real changes made)

. replace comp=subinstr(comp,"L L","LL",.)
(169 real changes made)

. replace comp=subinstr(comp,"STEARNS","STRNS",.)
(1 real change made)

. replace comp=subinstr(comp,"DICKINSON &","DICK",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCRAFT","AIRCR",.)
(10 real changes made)

. replace comp=subinstr(comp,"AIRCRFT","AIRCR",.)
(5 real changes made)

. replace comp=subinstr(comp,"CANADA","CDA",.)
(70 real changes made)

. replace comp=subinstr(comp,"PROJECTED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"TELEM","TEL",.)
(37 real changes made)

. replace comp=subinstr(comp,"BETHLEHEM","BETHLHM",.)
(1 real change made)

. replace comp=subinstr(comp,"STEEL","STL",.)
(162 real changes made)

. replace comp=subinstr(comp,"ENTERPRISES","ENT",.)
(48 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"A G","AG",.)
(86 real changes made)

. replace comp=subinstr(comp,"AEROSPACE","AEROSPAC",.)
(15 real changes made)

. replace comp=subinstr(comp,"(","",.)
(0 real changes made)

. replace comp=subinstr(comp,")","",.)
(0 real changes made)

. replace comp=subinstr(comp,"L L","LL",.)
(82 real changes made)

. replace comp=subinstr(comp,"STEARNS","STRNS",.)
(3 real changes made)

. replace comp=subinstr(comp,"DICKINSON &","DICK",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCRAFT","AIRCR",.)
(12 real changes made)

. replace comp=subinstr(comp,"AIRCRFT","AIRCR",.)
(1 real change made)

. replace comp=subinstr(comp,"CANADA","CDA",.)
(22 real changes made)

. replace comp=subinstr(comp,"PROJECTED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"TELEM","TEL",.)
(14 real changes made)

. replace comp=subinstr(comp,"BETHLEHEM","BETHLHM",.)
(3 real changes made)

. replace comp=subinstr(comp,"STEEL","STL",.)
(66 real changes made)

. replace comp=subinstr(comp,"ENTERPRISES","ENT",.)
(111 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10360133
.10360133

. 
. *7th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"BIG THREE","BIG THREE IND",.)
(1 real change made)

. replace comp=subinstr(comp,"LLC","",.)
(864 real changes made)

. replace comp=subinstr(comp,"BORG WARNER","",.)
(1 real change made)

. replace comp=subinstr(comp,"SCIENTIFIC","SCI",.)
(18 real changes made)

. replace comp=subinstr(comp,"ADS","BP",.)
(31 real changes made)

. replace comp=subinstr(comp,"BRIGGS&STRATTON","BRIGG&STRN",.)
(0 real changes made)

. replace comp=subinstr(comp,"MYERS SQUIBB","MYRS",.)
(3 real changes made)

. replace comp=subinstr(comp,"CA CL","CA LA",.)
(1 real change made)

. replace comp=subinstr(comp,"GOLF","GF",.)
(13 real changes made)

. replace comp=subinstr(comp,"SOUP","SP",.)
(2 real changes made)

. replace comp=subinstr(comp,"CAMPBELL","CAMPBL",.)
(2 real changes made)

. replace comp=subinstr(comp,"FINANCIAL","FINL",.)
(57 real changes made)

. replace comp=subinstr(comp,"NATURAL GAS","NAT",.)
(25 real changes made)

. replace comp=subinstr(comp,"CANADIAN","CDN",.)
(18 real changes made)

. replace comp=subinstr(comp,"AIRCFT","AIRC",.)
(7 real changes made)

. replace comp=subinstr(comp,"AIRCR","AIRC",.)
(15 real changes made)

. replace comp=trim(comp)
(781 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"LLC","",.)
(136 real changes made)

. replace comp=subinstr(comp,"BORG WARNER","",.)
(0 real changes made)

. replace comp=subinstr(comp,"SCIENTIFIC","SCI",.)
(47 real changes made)

. replace comp=subinstr(comp,"BP   ADS","BP",.)
(0 real changes made)

. replace comp=subinstr(comp,"BRIGGS&STRATTON","BRIGG&STRN",.)
(0 real changes made)

. replace comp=subinstr(comp,"MYERS SQUIBB","MYRS",.)
(0 real changes made)

. replace comp=subinstr(comp,"CA CL","CA LA",.)
(0 real changes made)

. replace comp=subinstr(comp,"GOLF","GF",.)
(22 real changes made)

. replace comp=subinstr(comp,"SOUP","SP",.)
(2 real changes made)

. replace comp=subinstr(comp,"CAMPBELL","CAMPBL",.)
(5 real changes made)

. replace comp=subinstr(comp,"FINANCIAL","FINL",.)
(695 real changes made)

. replace comp=subinstr(comp,"NATURAL GAS","NAT",.)
(20 real changes made)

. replace comp=subinstr(comp,"CANADIAN","CDN",.)
(13 real changes made)

. replace comp=subinstr(comp,"AIRCFT","AIRC",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCR","AIRC",.)
(11 real changes made)

. replace comp=trim(comp)
(85 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10459838
.10459838

. 
. *8th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"ROEBK","",.)
(1 real change made)

. replace comp=subinstr(comp,"ROEBUCK &","",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIR LINES","AIRL",.)
(4 real changes made)

. replace comp=trim(comp)
(1 real change made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"ROEBK","",.)
(0 real changes made)

. replace comp=subinstr(comp,"ROEBUCK &","",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIR LINES","AIRL",.)
(4 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10460428
.10460428

. 
. 
. *9th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"SYSTEMS","SYS",.)
(269 real changes made)

. replace comp=subinstr(comp,"DU PONT EI DE NEMOURS","DUPONT EI",.)
(0 real changes made)

. replace comp=subinstr(comp,"EI","",.)
(669 real changes made)

. replace comp=subinstr(comp,"PRO FORMA","",.)
(16 real changes made)

. replace comp=subinstr(comp,"CREDIT","CR",.)
(25 real changes made)

. replace comp=subinstr(comp,"LIGHT","LT",.)
(52 real changes made)

. replace comp=subinstr(comp,"CHEMICAL","CHEMICL",.)
(124 real changes made)

. replace comp=subinstr(comp,"&","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DISCREET","DISCRT",.)
(0 real changes made)

. replace comp=subinstr(comp,"LOGIC","LGC",.)
(36 real changes made)

. replace comp=subinstr(comp,"TELEKOM","TELE",.)
(8 real changes made)

. replace comp=subinstr(comp,"TLKOM","TELE",.)
(1 real change made)

. replace comp=subinstr(comp,"DEUTSCHE","DTSCH",.)
(19 real changes made)

. 
. replace comp=subinstr(comp,"PWRLIGHT","PL",.)
(0 real changes made)

. replace comp=subinstr(comp,"SUPERMARKETS","SUPERMKTS",.)
(9 real changes made)

. replace comp=subinstr(comp,"CAPITAL","CAP",.)
(75 real changes made)

. replace comp=subinstr(comp,"GRAND ICE CREAM","",.)
(1 real change made)

. replace comp=subinstr(comp,"DREAMS","DRMS",.)
(2 real changes made)

. replace comp=subinstr(comp,"EMPORIUM","EMPORM",.)
(1 real change made)

. replace comp=subinstr(comp,"HARDWAREGARDEN","HRDWR",.)
(0 real changes made)

. replace comp=subinstr(comp,"KODAK","KDK",.)
(3 real changes made)

. replace comp=subinstr(comp,"MAN","MN",.)
(485 real changes made)

. replace comp=subinstr(comp,"STORES","",.)
(5 real changes made)

. replace comp=subinstr(comp,"BROTHERS","BROS",.)
(16 real changes made)

. replace comp=subinstr(comp,"AG","",.)
(1,007 real changes made)

. replace comp=subinstr(comp,"ELECTRONIC","ELEC",.)
(57 real changes made)

. replace comp=trim(comp)
(170 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"SYSTEMS","SYS",.)
(592 real changes made)

. replace comp=subinstr(comp,"DU PONT EI DE NEMOURS","DUPONT EI",.)
(0 real changes made)

. replace comp=subinstr(comp,"EI","",.)
(303 real changes made)

. replace comp=subinstr(comp,"PRO FORMA","",.)
(5 real changes made)

. replace comp=subinstr(comp,"CREDIT","CR",.)
(67 real changes made)

. replace comp=subinstr(comp,"LIGHT","LT",.)
(59 real changes made)

. replace comp=subinstr(comp,"CHEMICAL","CHEMICL",.)
(66 real changes made)

. replace comp=subinstr(comp,"&","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DISCREET","DISCRT",.)
(0 real changes made)

. replace comp=subinstr(comp,"LOGIC","LGC",.)
(59 real changes made)

. replace comp=subinstr(comp,"TELEKOM","TELE",.)
(5 real changes made)

. replace comp=subinstr(comp,"TLKOM","TELE",.)
(0 real changes made)

. replace comp=subinstr(comp,"DEUTSCHE","DTSCH",.)
(19 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(0 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(0 real changes made)

. replace comp=subinstr(comp,"PWRLIGHT","PL",.)
(0 real changes made)

. replace comp=subinstr(comp,"SUPERMARKETS","SUPERMKTS",.)
(8 real changes made)

. replace comp=subinstr(comp,"CAPITAL","CAP",.)
(327 real changes made)

. replace comp=subinstr(comp,"GRAND ICE CREAM","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DREAMS","DRMS",.)
(2 real changes made)

. replace comp=subinstr(comp,"EMPORIUM","EMPORM",.)
(0 real changes made)

. replace comp=subinstr(comp,"HARDWAREGARDEN","HRDWR",.)
(0 real changes made)

. replace comp=subinstr(comp,"KODAK","KDK",.)
(0 real changes made)

. replace comp=subinstr(comp,"MAN","MN",.)
(363 real changes made)

. replace comp=subinstr(comp,"STORES","",.)
(4 real changes made)

. replace comp=subinstr(comp,"BROTHERS","BROS",.)
(21 real changes made)

. replace comp=subinstr(comp,"AG","",.)
(971 real changes made)

. replace comp=subinstr(comp,"ELECTRONIC","",.)
(29 real changes made)

. replace comp=trim(comp)
(54 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10609787
.10609787

. 
. *10th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"GAS","GS",.)
(436 real changes made)

. replace comp=subinstr(comp,"TOWN","TWN",.)
(28 real changes made)

. replace comp=subinstr(comp,"L M","",.)
(185 real changes made)

. replace comp=subinstr(comp,"LM","",.)
(186 real changes made)

. replace comp=subinstr(comp,"TELEFON","TEL",.)
(16 real changes made)

. replace comp=trim(comp)
(3 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"GAS","GS",.)
(181 real changes made)

. replace comp=subinstr(comp,"TOWN","TWN",.)
(37 real changes made)

. replace comp=subinstr(comp,"L M","",.)
(216 real changes made)

. replace comp=subinstr(comp,"LM","",.)
(200 real changes made)

. replace comp=subinstr(comp,"TELEFON","TEL",.)
(8 real changes made)

. replace comp=trim(comp)
(1 real change made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.1062067
.1062067

. 
. *11th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"ERICSSON TEL","ERCSON TELE",.)
(1 real change made)

. replace comp=subinstr(comp,"WHEELER","WHLR",.)
(3 real changes made)

. replace comp=subinstr(comp,"FISHER","FISHR",.)
(16 real changes made)

. replace comp=subinstr(comp,"SCIEN","SCI",.)
(125 real changes made)

. replace comp=subinstr(comp,"INTL","",.)
(575 real changes made)

. replace comp=subinstr(comp,"FED EXPRESS","FEDEX",.)
(1 real change made)

. replace comp=subinstr(comp,"WOOD","WD",.)
(78 real changes made)

. replace comp=subinstr(comp,"FLA ROCK","FLORIDA ROCK",.)
(1 real change made)

. replace comp=subinstr(comp,"STONE","STN",.)
(55 real changes made)

. replace comp=subinstr(comp,"TIRERUBBER","TIR",.)
(0 real changes made)

. replace comp=subinstr(comp,"TIR","",.)
(38 real changes made)

. replace comp=subinstr(comp,"CENTER","CNTR",.)
(149 real changes made)

. replace comp=subinstr(comp,"","YR",.)
(0 real changes made)

. replace comp=subinstr(comp,"NSOLIDATED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"MIC","MC",.)
(468 real changes made)

. replace comp=subinstr(comp,"ELECTRIC","ELEC",.)
(207 real changes made)

. replace comp=subinstr(comp,"ELEC","EL",.)
(849 real changes made)

. replace comp=subinstr(comp,"NSOL","",.)
(13 real changes made)

. replace comp=subinstr(comp,"PACIFIC","PAC",.)
(81 real changes made)

. replace comp=subinstr(comp,"W R","WR",.)
(7 real changes made)

. replace comp=trim(comp)
(439 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"ERICSSON TEL","ERCSON TELE",.)
(0 real changes made)

. replace comp=subinstr(comp,"WHEELER","WHLR",.)
(1 real change made)

. replace comp=subinstr(comp,"FISHER","FISHR",.)
(8 real changes made)

. replace comp=subinstr(comp,"SCIEN","SCI",.)
(190 real changes made)

. replace comp=subinstr(comp,"INTL","",.)
(1,068 real changes made)

. replace comp=subinstr(comp,"FED EXPRESS","FEDEX",.)
(0 real changes made)

. replace comp=subinstr(comp,"WOOD","WD",.)
(86 real changes made)

. replace comp=subinstr(comp,"FLA ROCK","FLORIDA ROCK",.)
(0 real changes made)

. replace comp=subinstr(comp,"STONE","STN",.)
(114 real changes made)

. replace comp=subinstr(comp,"TIRERUBBER","TIR",.)
(0 real changes made)

. replace comp=subinstr(comp,"TIR","",.)
(13 real changes made)

. replace comp=subinstr(comp,"CENTER","CNTR",.)
(69 real changes made)

. replace comp=subinstr(comp,"","YR",.)
(0 real changes made)

. replace comp=subinstr(comp,"NSOLIDATED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"MIC","MC",.)
(370 real changes made)

. replace comp=subinstr(comp,"ELECTRIC","ELEC",.)
(65 real changes made)

. replace comp=subinstr(comp,"ELEC","EL",.)
(347 real changes made)

. replace comp=subinstr(comp,"NSOL","",.)
(12 real changes made)

. replace comp=subinstr(comp,"PACIFIC","PAC",.)
(133 real changes made)

. replace comp=subinstr(comp,"W R","WR",.)
(15 real changes made)

. replace comp=trim(comp)
(851 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10918382
.10918382

. 
. *12th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"METRO","MET",.)
(48 real changes made)

. replace comp=subinstr(comp,"TECHNOLOGIES","TECHNOL",.)
(5 real changes made)

. replace comp=subinstr(comp,"DATA MM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"DATAMM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"INSTRUMENT","INSTR",.)
(10 real changes made)

. replace comp=subinstr(comp,"INSTRMN","INSTR",.)
(2 real changes made)

. replace comp=subinstr(comp,"MOTORS","MTR",.)
(26 real changes made)

. replace comp=subinstr(comp,"INSTITUTE","INST",.)
(57 real changes made)

. replace comp=subinword(comp,"GENUINE","GENUIN",.)
(1 real change made)

. replace comp=subinword(comp,"PARTS","PART",.)
(19 real changes made)

. replace comp=subinword(comp,"TEL","TE",.)
(76 real changes made)

. replace comp=subinword(comp,"GLOBALSTAR","GLBLSTR",.)
(0 real changes made)

. replace comp=subinstr(comp,",","",.)
(0 real changes made)

. replace comp=subinword(comp,"GOODYR E","GOODYR",.)
(1 real change made)

. replace comp=subinword(comp,"W","",.)
(48 real changes made)

. replace comp=subinword(comp,"GRAINGER","GRAINGR",.)
(3 real changes made)

. replace comp=subinword(comp,"CHEMCL","CH",.)
(83 real changes made)

. replace comp=subinword(comp,"SP","",.)
(34 real changes made)

. replace comp=trim(comp)
(59 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"METRO","MET",.)
(47 real changes made)

. replace comp=subinstr(comp,"TECHNOLOGIES","TECHNOL",.)
(20 real changes made)

. replace comp=subinstr(comp,"DATA MM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"DATAMM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"INSTRUMENT","INSTR",.)
(30 real changes made)

. replace comp=subinstr(comp,"INSTRMN","INSTR",.)
(0 real changes made)

. replace comp=subinstr(comp,"MOTORS","MTR",.)
(13 real changes made)

. replace comp=subinstr(comp,"INSTITUTE","INST",.)
(7 real changes made)

. replace comp=subinword(comp,"GENUINE","GENUIN",.)
(0 real changes made)

. replace comp=subinword(comp,"PARTS","PART",.)
(7 real changes made)

. replace comp=subinword(comp,"TEL","TE",.)
(6 real changes made)

. replace comp=subinword(comp,"GLOBALSTAR","GLBLSTR",.)
(1 real change made)

. replace comp=subinstr(comp,",","",.)
(0 real changes made)

. replace comp=subinword(comp,"GOODYR E","GOODYR",.)
(0 real changes made)

. replace comp=subinword(comp,"W","",.)
(16 real changes made)

. replace comp=subinword(comp,"GRAINGER","GRAINGR",.)
(0 real changes made)

. replace comp=subinword(comp,"CHEMCL","CH",.)
(40 real changes made)

. replace comp=subinword(comp,"SP","",.)
(225 real changes made)

. replace comp=trim(comp)
(17 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10952016
.10952016

. 
. *13th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"PACKARD","PCK",.)
(9 real changes made)

. replace comp=subinword(comp,"HOTELS","HTL",.)
(12 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"PACKARD","PCK",.)
(1 real change made)

. replace comp=subinword(comp,"HOTELS","HTL",.)
(25 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10952016
.10952016

. 
. *14th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"TROY","TR",.)
(0 real changes made)

. replace comp=subinword(comp,"MEYERS","MEYR",.)
(1 real change made)

. replace comp=subinword(comp,"H J","HJ",.)
(1 real change made)

. replace comp=subinword(comp,"HOTL","HTL",.)
(2 real changes made)

. replace comp=subinword(comp,"HEALTHDYNE","HLTHDNE",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOL","TEC",.)
(3 real changes made)

. replace comp=subinword(comp,"CELANESE","",.)
(3 real changes made)

. replace comp=subinword(comp,"CEL","",.)
(2 real changes made)

. replace comp=subinword(comp,"MIFFLIN","MF",.)
(0 real changes made)

. replace comp=subinword(comp,"LTPWR","LP",.)
(0 real changes made)

. replace comp=subinword(comp,"HOST","HST",.)
(2 real changes made)

. replace comp=subinword(comp,"SUPPLY","SPLY",.)
(88 real changes made)

. replace comp=subinword(comp,"MATERIALS HNDLG","",.)
(0 real changes made)

. replace comp=subinword(comp,"SOLUTIONS","",.)
(109 real changes made)

. replace comp=trim(comp)
(96 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"TROY","TR",.)
(3 real changes made)

. replace comp=subinword(comp,"MEYERS","MEYR",.)
(1 real change made)

. replace comp=subinword(comp,"H J","HJ",.)
(0 real changes made)

. replace comp=subinword(comp,"HOTL","HTL",.)
(0 real changes made)

. replace comp=subinword(comp,"HEALTHDYNE","HLTHDNE",.)
(1 real change made)

. replace comp=subinword(comp,"TECHNOL","TEC",.)
(7 real changes made)

. replace comp=subinword(comp,"CELANESE","",.)
(1 real change made)

. replace comp=subinword(comp,"CEL","",.)
(1 real change made)

. replace comp=subinword(comp,"MIFFLIN","MF",.)
(0 real changes made)

. replace comp=subinword(comp,"LTPWR","LP",.)
(0 real changes made)

. replace comp=subinword(comp,"HOST","HST",.)
(5 real changes made)

. replace comp=subinword(comp,"SUPPLY","SPLY",.)
(25 real changes made)

. replace comp=subinword(comp,"MATERIALS HNDLG","",.)
(1 real change made)

. replace comp=subinword(comp,"SOLUTIONS","",.)
(144 real changes made)

. replace comp=trim(comp)
(136 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3 

. mergeRate       //.10985419
.10985419

. 
. *15th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"CHASE","CHSE",.)
(20 real changes made)

. replace comp=subinword(comp,"J P MORGAN","JPMORGAN",.)
(4 real changes made)

. replace comp=subinword(comp,"CIRCUIT","CRCT",.)
(10 real changes made)

. replace comp=subinword(comp,"NTROLS","CNTL",.)
(0 real changes made)

. replace comp=subinword(comp,"JOHNSONJOHNSON","JOHNSNJHNS",.)
(0 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"CHASE","CHSE",.)
(6 real changes made)

. replace comp=subinword(comp,"J P MORGAN","JPMORGAN",.)
(0 real changes made)

. replace comp=subinword(comp,"CIRCUIT","CRCT",.)
(5 real changes made)

. replace comp=subinword(comp,"NTROLS","CNTL",.)
(0 real changes made)

. replace comp=subinword(comp,"JOHNSONJOHNSON","JOHNSNJHNS",.)
(0 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10986044
.10986044

. 
. *16th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"AM TEL &TEL","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"-","",.)
(0 real changes made)

. replace comp=subinword(comp,"CL","",.)
(18 real changes made)

. replace comp=subinword(comp,"A","",.)
(153 real changes made)

. replace comp=subinword(comp,"HLDG","",.)
(13 real changes made)

. replace comp=subinword(comp,"WARD","WD",.)
(4 real changes made)

. replace comp=subinword(comp,"MONTGOMERY","MONTGMY",.)
(2 real changes made)

. replace comp=subinstr(comp,"PR","",.)
(1,273 real changes made)

. replace comp=subinword(comp,"CORP","",.)
(0 real changes made)

. replace comp=subinword(comp,"CO","",.)
(37 real changes made)

. replace comp=subinword(comp,"CP","",.)
(0 real changes made)

. replace comp=subinword(comp,"INC","",.)
(0 real changes made)

. replace comp=subinword(comp,"DAIMLERCHRYSLER","DAIMLER",.)
(5 real changes made)

. replace comp=subinword(comp,"AG","",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(44 real changes made)

. replace comp=subinword(comp,"EASTMAN","EASTMN",.)
(0 real changes made)

. replace comp=subinword(comp,"KODAK","KODK",.)
(0 real changes made)

. replace comp=subinword(comp,"MACHINES","MA",.)
(3 real changes made)

. replace comp=subinword(comp,"BUSINESS","BUS",.)
(34 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(7 real changes made)

. replace comp=subinword(comp,"EQUIPMENT","EQ",.)
(48 real changes made)

. replace comp=subinword(comp,"PROCTER","PRCTR",.)
(0 real changes made)

. replace comp=subinword(comp,"GAMBLE","GM",.)
(6 real changes made)

. replace comp=subinword(comp,"GENERAL","GEN",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTORS","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"FUNDING","",.)
(5 real changes made)

. replace comp=subinword(comp,"(J C)","(JC)",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(1 real change made)

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(0 real changes made)

. replace comp=subinword(comp,"EXXON MOBIL","EXXON",.)
(0 real changes made)

. replace comp=subinword(comp,"SPRINT NEXTEL","SPRINT",.)
(0 real changes made)

. replace comp=subinword(comp,"INSTRUMENTS","INSTR",.)
(0 real changes made)

. replace comp=subinword(comp,"TEXAS","TX",.)
(60 real changes made)

. replace comp=subinword(comp,"DU PONT (E I) DE NEMOURS","DUPONT (EI)",.)
(0 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(0 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(0 real changes made)

. replace comp=subinword(comp,"RICHFIELD","RIC",.)
(0 real changes made)

. replace comp=subinword(comp,"INTERNATIONAL","INTL",.)
(0 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(0 real changes made)

. replace comp=subinword(comp,"ANHEUSER-BUSCH","ANHEUSR-BSH",.)
(0 real changes made)

. replace comp=subinword(comp,"LOCKHEED MARTIN","LOCKHEED",.)
(4 real changes made)

. replace comp=subinword(comp,"LOCKHD MART","LOCKHEED",.)
(1 real change made)

. replace comp=subinword(comp,"LABORATORIES","LABS",.)
(0 real changes made)

. replace comp=subinword(comp,"AMERICAN","",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGYOLD","TEC",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGY","TEC",.)
(339 real changes made)

. replace comp=subinword(comp,"HOSPITAL","HOSP",.)
(69 real changes made)

. replace comp=subinword(comp,"SUPPLY","SUP",.)
(0 real changes made)

. replace comp=subinword(comp,"PHILIP","PHIL",.)
(8 real changes made)

. replace comp=subinword(comp,"MORRIS","MOR",.)
(7 real changes made)

. replace comp=subinword(comp,"NORTHROP GRUMMAN","NORTHROP",.)
(0 real changes made)

. replace comp=subinword(comp,"LOWE'S COMPANIES","LOWES COS",.)
(0 real changes made)

. replace comp=subinword(comp,"MARIETTA","MRTA",.)
(0 real changes made)

. replace comp=subinword(comp,"MICROSYSTEMS","MICRO",.)
(0 real changes made)

. replace comp=trim(comp)
(168 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"AM TEL &TEL","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"-","",.)
(0 real changes made)

. replace comp=subinword(comp,"CL","",.)
(59 real changes made)

. replace comp=subinword(comp,"A","",.)
(102 real changes made)

. replace comp=subinword(comp,"HLDG","",.)
(63 real changes made)

. replace comp=subinword(comp,"WARD","WD",.)
(4 real changes made)

. replace comp=subinword(comp,"MONTGOMERY","MONTGMY",.)
(4 real changes made)

. replace comp=subinstr(comp,"PR","",.)
(1,446 real changes made)

. replace comp=subinword(comp,"CORP","",.)
(0 real changes made)

. replace comp=subinword(comp,"CO","",.)
(38 real changes made)

. replace comp=subinword(comp,"CP","",.)
(0 real changes made)

. replace comp=subinword(comp,"INC","",.)
(0 real changes made)

. replace comp=subinword(comp,"DAIMLERCHRYSLER","DAIMLER",.)
(0 real changes made)

. replace comp=subinword(comp,"AG","",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(111 real changes made)

. replace comp=subinword(comp,"EASTMAN","EASTMN",.)
(0 real changes made)

. replace comp=subinword(comp,"KODAK","KODK",.)
(0 real changes made)

. replace comp=subinword(comp,"MACHINES","MA",.)
(3 real changes made)

. replace comp=subinword(comp,"BUSINESS","BUS",.)
(44 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(0 real changes made)

. replace comp=subinword(comp,"EQUIPMENT","EQ",.)
(23 real changes made)

. replace comp=subinword(comp,"PROCTER","PRCTR",.)
(0 real changes made)

. replace comp=subinword(comp,"GAMBLE","GM",.)
(1 real change made)

. replace comp=subinword(comp,"GENERAL","GEN",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTORS","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"FUNDING","",.)
(19 real changes made)

. replace comp=subinword(comp,"(J C)","(JC)",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(6 real changes made)

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(2 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(0 real changes made)

. replace comp=subinword(comp,"EXXON MOBIL","EXXON",.)
(0 real changes made)

. replace comp=subinword(comp,"SPRINT NEXTEL","SPRINT",.)
(0 real changes made)

. replace comp=subinword(comp,"INSTRUMENTS","INSTR",.)
(0 real changes made)

. replace comp=subinword(comp,"TEXAS","TX",.)
(37 real changes made)

. replace comp=subinword(comp,"DU PONT (E I) DE NEMOURS","DUPONT (EI)",.)
(0 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(0 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(0 real changes made)

. replace comp=subinword(comp,"RICHFIELD","RIC",.)
(1 real change made)

. replace comp=subinword(comp,"INTERNATIONAL","INTL",.)
(0 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(0 real changes made)

. replace comp=subinword(comp,"ANHEUSER-BUSCH","ANHEUSR-BSH",.)
(0 real changes made)

. replace comp=subinword(comp,"LOCKHEED MARTIN","LOCKHEED",.)
(0 real changes made)

. replace comp=subinword(comp,"LOCKHD MART","LOCKHEED",.)
(0 real changes made)

. replace comp=subinword(comp,"LABORATORIES","LABS",.)
(0 real changes made)

. replace comp=subinword(comp,"AMERICAN","",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGYOLD","TEC",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGY","TEC",.)
(277 real changes made)

. replace comp=subinword(comp,"HOSPITAL","HOSP",.)
(7 real changes made)

. replace comp=subinword(comp,"SUPPLY","SUP",.)
(0 real changes made)

. replace comp=subinword(comp,"PHILIP","PHIL",.)
(3 real changes made)

. replace comp=subinword(comp,"MORRIS","MOR",.)
(1 real change made)

. replace comp=subinword(comp,"NORTHROP GRUMMAN","NORTHROP",.)
(0 real changes made)

. replace comp=subinword(comp,"LOWE'S COMPANIES","LOWES COS",.)
(0 real changes made)

. replace comp=subinword(comp,"MARIETTA","MRTA",.)
(4 real changes made)

. replace comp=subinword(comp,"MICROSYSTEMS","MICRO",.)
(0 real changes made)

. replace comp=trim(comp)
(175 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.1110953
.1110953

. 
. *17th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(0 real changes made)

. replace comp = subinstr(comp, " ", "", .)                                        
>                                //BLUNT way of improving match, remove white space
(24,184 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(0 real changes made)

. replace comp = subinstr(comp, " ", "", .)                                        
>                                //BLUNT way of improving match, remove white space
(22,183 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.11509919
.11509919

. 
. log close
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 closed on:  29 Jan 2020, 17:52:44
-----------------------------------------------------------------------------------
-----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 opened on:  29 Jan 2020, 18:07:14

. 
. /*******************************************************************************
>         EXACT MERGE
> *******************************************************************************/
. 
. *Keeping only supplier firms who have financial data
. *use "$data/001_network/001_supplierList.dta", clear
. *merge 1:1 gvkey comp using "$data/001_network/001_companyList_6119.dta"
. *KEEPING ALL firms for now
. 
. *Customer to company exact merge
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"                            
>        // 1 to many merge as several companies in Compustat have the same name bu
> t different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,250

. local merged = `r(N)'

. count if _merge == 1
  35,276

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.00% merge
.05995843

. 
. *Supplier to company exact merge
. use "$data/001_supplierList.dta", clear

. merge 1:1 /*gvkey*/ comp using "$data/001_companyList_6119.dta"
(note: variable comp was str28, now str30 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                        17,690
        from master                       286  (_merge==1)
        from using                     17,404  (_merge==2)

    matched                            15,450  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  15,450

. local merged = `r(N)'

. count if _merge == 1
  286

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //98.18% merge
.98182511

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM: SETUP AND PROGRAMS
> *******************************************************************************/
. 
. *Using the cleaning algorithm from AHRS
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"           

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp
 18.                 sort comp
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp
 27.                 sort comp
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/matched", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM: IMPLEMENTATION IN SEVERAL ROUNDS OF MANUAL CLEAN
> ING
> *******************************************************************************/
. 
. *1st round
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(853 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(46 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(11 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(49 real changes made)

. replace comp=subinword(comp,"CO","",.)
(1,362 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(111 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(60 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(499 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(76 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(22 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(124 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(125 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(24 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(156 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(518 real changes made)

. replace comp=trim(comp)
(1,615 real changes made)

. sort comp

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09146594
.09146594

. 
. *2nd
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"A T & T","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"GROUP","",.)
(703 real changes made)

. replace comp=subinstr(comp,"HEALTHCARE","HTHCR",.)
(108 real changes made)

. replace comp=subinstr(comp,"SPON ADR","",.)
(32 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT SYSTEM","ABF FREIGHT",.)
(0 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT","ABF",.)
(1 real change made)

. replace comp=subinstr(comp,"PLC","",.)
(106 real changes made)

. replace comp=subinstr(comp,"HOLDINGS","",.)
(178 real changes made)

. replace comp=subinstr(comp,"ADR","",.)
(397 real changes made)

. replace comp=subinstr(comp,"INDUSTRIES","IND",.)
(115 real changes made)

. replace comp=subinstr(comp,"UNITED","UTD",.)
(6 real changes made)

. replace comp=trim(comp)
(1,093 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"A T & T","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"SPON ADR","",.)
(0 real changes made)

. replace comp=subinstr(comp,"PLC","",.)
(2 real changes made)

. replace comp=subinstr(comp,"GROUP","",.)
(1,103 real changes made)

. replace comp=subinstr(comp,"HEALTHCARE","HTHCR",.)
(119 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT SYSTEM","ABF FREIGHT",.)
(1 real change made)

. replace comp=subinstr(comp,"ABF FREIGHT","ABF",.)
(1 real change made)

. replace comp=subinstr(comp,"HOLDINGS","",.)
(815 real changes made)

. replace comp=subinstr(comp,"ADR","",.)
(290 real changes made)

. replace comp=subinstr(comp,"INDUSTRIES","IND",.)
(645 real changes made)

. replace comp=subinstr(comp,"UNITED","UTD",.)
(4 real changes made)

. replace comp=trim(comp)
(1,788 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09685959
.09685959

. 
. *3rd
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"TELECOMMUNICATIONS","TELEM",.)
(27 real changes made)

. replace comp=subinstr(comp,"CL A","",.)
(65 real changes made)

. replace comp=subinstr(comp,"MMUNICATIONS","MMUN",.)
(172 real changes made)

. replace comp=subinstr(comp,"ADVANCED MICRO DEVICES","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"ADV MICRO DV","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"CP","",.)
(367 real changes made)

. replace comp=subinstr(comp,"CMPTRS","MPUTERS",.)
(1 real change made)

. replace comp=subinstr(comp,"AHA BETA","AHA BETA TECHNOLOGY",.)
(1 real change made)

. replace comp=subinstr(comp,"PRDS&CH","PRODUCTS & CHEMICALS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRTOUCH CM","AIRTOUCH COMMUNICATIONS",.)
(1 real change made)

. replace comp=subinstr(comp,"INTERNATIONAL","INTL",.)
(376 real changes made)

. replace comp=subinstr(comp,"POWER","PWR",.)
(286 real changes made)

. replace comp=subinstr(comp,"'","",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","",.)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"TELEMMUNICATIONS","TELEM",.)
(0 real changes made)

. replace comp=subinstr(comp,"MMUNICATIONS","MMUN",.)
(277 real changes made)

. replace comp=subinstr(comp,"ADVANCED MICRO DEVICES","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"ADV MICRO DV","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"CL A","",.)
(498 real changes made)

. replace comp=subinstr(comp,"CP","",.)
(437 real changes made)

. replace comp=subinstr(comp,"CMPTRS","MPUTERS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AHA BETA","AHA BETA TECHNOLOGY",.)
(1 real change made)

. replace comp=subinstr(comp,"PRDS&CH","PRODUCTS & CHEMICALS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRTOUCH CM","AIRTOUCH COMMUNICATIONS",.)
(0 real changes made)

. replace comp=subinstr(comp,"INTERNATIONAL","INTL",.)
(483 real changes made)

. replace comp=subinstr(comp,"POWER","PWR",.)
(208 real changes made)

. replace comp=subinstr(comp,"'","",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","",.)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09804468
.09804468

. 
. *4th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"SA","",.)
(428 real changes made)

. replace comp=subinstr(comp,"PRODUCTS","PROD",.)
(128 real changes made)

. replace comp=subinstr(comp,"ELECTRONICS","ELECT",.)
(173 real changes made)

. replace comp=trim(comp)
(666 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"PRODUCTS","PROD",.)
(158 real changes made)

. replace comp=subinstr(comp,"ELECTRONICS","ELECT",.)
(80 real changes made)

. replace comp=subinword(comp,"SA","",.)
(145 real changes made)

. replace comp=trim(comp)
(828 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10131343
.10131343

. 
. *5th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"AMERICA","AMER",.)
(312 real changes made)

. replace comp=subinstr(comp,".","",.)
(0 real changes made)

. replace comp=subinstr(comp,"HYDRO ELECTRIC","HYD",.)
(0 real changes made)

. replace comp=subinstr(comp,"OLD","",.)
(198 real changes made)

. replace comp=subinstr(comp,"TRUST","TR",.)
(53 real changes made)

. replace comp=subinstr(comp,"BARCLAYS BANK","BARCLAYS",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","&",.)
(0 real changes made)

. replace comp=subinstr(comp,"NOBLE","NOBL",.)
(25 real changes made)

. replace comp=subinstr(comp,"BANK","BK",.)
(238 real changes made)

. replace comp=subinstr(comp,"NEW","",.)
(262 real changes made)

. replace comp=subinstr(comp,"WRIGHT","WRGHT",.)
(4 real changes made)

. replace comp=trim(comp)
(96 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"AMERICA","AMER",.)
(657 real changes made)

. replace comp=subinstr(comp,".","",.)
(0 real changes made)

. replace comp=subinstr(comp,"HYDRO ELECTRIC","HYD",.)
(0 real changes made)

. replace comp=subinstr(comp,"OLD","",.)
(1,104 real changes made)

. replace comp=subinstr(comp,"TRUST","TR",.)
(346 real changes made)

. replace comp=subinstr(comp,"BARCLAYS BANK","BARCLAYS",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","&",.)
(0 real changes made)

. replace comp=subinstr(comp,"NOBLE","NOBL",.)
(7 real changes made)

. replace comp=subinstr(comp,"BANK","BK",.)
(356 real changes made)

. replace comp=subinstr(comp,"NEW","",.)
(232 real changes made)

. replace comp=subinstr(comp,"WRIGHT","WRGHT",.)
(14 real changes made)

. replace comp=trim(comp)
(433 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10332145
.10332145

. 
. *6th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"A G","AG",.)
(90 real changes made)

. replace comp=subinstr(comp,"AEROSPACE","AEROSPAC",.)
(31 real changes made)

. replace comp=subinstr(comp,"(","",.)
(0 real changes made)

. replace comp=subinstr(comp,")","",.)
(0 real changes made)

. replace comp=subinstr(comp,"L L","LL",.)
(169 real changes made)

. replace comp=subinstr(comp,"STEARNS","STRNS",.)
(1 real change made)

. replace comp=subinstr(comp,"DICKINSON &","DICK",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCRAFT","AIRCR",.)
(10 real changes made)

. replace comp=subinstr(comp,"AIRCRFT","AIRCR",.)
(5 real changes made)

. replace comp=subinstr(comp,"CANADA","CDA",.)
(70 real changes made)

. replace comp=subinstr(comp,"PROJECTED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"TELEM","TEL",.)
(37 real changes made)

. replace comp=subinstr(comp,"BETHLEHEM","BETHLHM",.)
(1 real change made)

. replace comp=subinstr(comp,"STEEL","STL",.)
(162 real changes made)

. replace comp=subinstr(comp,"ENTERPRISES","ENT",.)
(48 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"A G","AG",.)
(86 real changes made)

. replace comp=subinstr(comp,"AEROSPACE","AEROSPAC",.)
(15 real changes made)

. replace comp=subinstr(comp,"(","",.)
(0 real changes made)

. replace comp=subinstr(comp,")","",.)
(0 real changes made)

. replace comp=subinstr(comp,"L L","LL",.)
(82 real changes made)

. replace comp=subinstr(comp,"STEARNS","STRNS",.)
(3 real changes made)

. replace comp=subinstr(comp,"DICKINSON &","DICK",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCRAFT","AIRCR",.)
(12 real changes made)

. replace comp=subinstr(comp,"AIRCRFT","AIRCR",.)
(1 real change made)

. replace comp=subinstr(comp,"CANADA","CDA",.)
(22 real changes made)

. replace comp=subinstr(comp,"PROJECTED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"TELEM","TEL",.)
(14 real changes made)

. replace comp=subinstr(comp,"BETHLEHEM","BETHLHM",.)
(3 real changes made)

. replace comp=subinstr(comp,"STEEL","STL",.)
(66 real changes made)

. replace comp=subinstr(comp,"ENTERPRISES","ENT",.)
(111 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10360133
.10360133

. 
. *7th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"BIG THREE","BIG THREE IND",.)
(1 real change made)

. replace comp=subinstr(comp,"LLC","",.)
(864 real changes made)

. replace comp=subinstr(comp,"BORG WARNER","",.)
(1 real change made)

. replace comp=subinstr(comp,"SCIENTIFIC","SCI",.)
(18 real changes made)

. replace comp=subinstr(comp,"ADS","BP",.)
(31 real changes made)

. replace comp=subinstr(comp,"BRIGGS&STRATTON","BRIGG&STRN",.)
(0 real changes made)

. replace comp=subinstr(comp,"MYERS SQUIBB","MYRS",.)
(3 real changes made)

. replace comp=subinstr(comp,"CA CL","CA LA",.)
(1 real change made)

. replace comp=subinstr(comp,"GOLF","GF",.)
(13 real changes made)

. replace comp=subinstr(comp,"SOUP","SP",.)
(2 real changes made)

. replace comp=subinstr(comp,"CAMPBELL","CAMPBL",.)
(2 real changes made)

. replace comp=subinstr(comp,"FINANCIAL","FINL",.)
(57 real changes made)

. replace comp=subinstr(comp,"NATURAL GAS","NAT",.)
(25 real changes made)

. replace comp=subinstr(comp,"CANADIAN","CDN",.)
(18 real changes made)

. replace comp=subinstr(comp,"AIRCFT","AIRC",.)
(7 real changes made)

. replace comp=subinstr(comp,"AIRCR","AIRC",.)
(15 real changes made)

. replace comp=trim(comp)
(781 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"LLC","",.)
(136 real changes made)

. replace comp=subinstr(comp,"BORG WARNER","",.)
(0 real changes made)

. replace comp=subinstr(comp,"SCIENTIFIC","SCI",.)
(47 real changes made)

. replace comp=subinstr(comp,"BP   ADS","BP",.)
(0 real changes made)

. replace comp=subinstr(comp,"BRIGGS&STRATTON","BRIGG&STRN",.)
(0 real changes made)

. replace comp=subinstr(comp,"MYERS SQUIBB","MYRS",.)
(0 real changes made)

. replace comp=subinstr(comp,"CA CL","CA LA",.)
(0 real changes made)

. replace comp=subinstr(comp,"GOLF","GF",.)
(22 real changes made)

. replace comp=subinstr(comp,"SOUP","SP",.)
(2 real changes made)

. replace comp=subinstr(comp,"CAMPBELL","CAMPBL",.)
(5 real changes made)

. replace comp=subinstr(comp,"FINANCIAL","FINL",.)
(695 real changes made)

. replace comp=subinstr(comp,"NATURAL GAS","NAT",.)
(20 real changes made)

. replace comp=subinstr(comp,"CANADIAN","CDN",.)
(13 real changes made)

. replace comp=subinstr(comp,"AIRCFT","AIRC",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCR","AIRC",.)
(11 real changes made)

. replace comp=trim(comp)
(85 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10459838
.10459838

. 
. *8th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"ROEBK","",.)
(1 real change made)

. replace comp=subinstr(comp,"ROEBUCK &","",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIR LINES","AIRL",.)
(4 real changes made)

. replace comp=trim(comp)
(1 real change made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"ROEBK","",.)
(0 real changes made)

. replace comp=subinstr(comp,"ROEBUCK &","",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIR LINES","AIRL",.)
(4 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10460428
.10460428

. 
. 
. *9th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"SYSTEMS","SYS",.)
(269 real changes made)

. replace comp=subinstr(comp,"DU PONT EI DE NEMOURS","DUPONT EI",.)
(0 real changes made)

. replace comp=subinstr(comp,"EI","",.)
(669 real changes made)

. replace comp=subinstr(comp,"PRO FORMA","",.)
(16 real changes made)

. replace comp=subinstr(comp,"CREDIT","CR",.)
(25 real changes made)

. replace comp=subinstr(comp,"LIGHT","LT",.)
(52 real changes made)

. replace comp=subinstr(comp,"CHEMICAL","CHEMICL",.)
(124 real changes made)

. replace comp=subinstr(comp,"&","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DISCREET","DISCRT",.)
(0 real changes made)

. replace comp=subinstr(comp,"LOGIC","LGC",.)
(36 real changes made)

. replace comp=subinstr(comp,"TELEKOM","TELE",.)
(8 real changes made)

. replace comp=subinstr(comp,"TLKOM","TELE",.)
(1 real change made)

. replace comp=subinstr(comp,"DEUTSCHE","DTSCH",.)
(19 real changes made)

. 
. replace comp=subinstr(comp,"PWRLIGHT","PL",.)
(0 real changes made)

. replace comp=subinstr(comp,"SUPERMARKETS","SUPERMKTS",.)
(9 real changes made)

. replace comp=subinstr(comp,"CAPITAL","CAP",.)
(75 real changes made)

. replace comp=subinstr(comp,"GRAND ICE CREAM","",.)
(1 real change made)

. replace comp=subinstr(comp,"DREAMS","DRMS",.)
(2 real changes made)

. replace comp=subinstr(comp,"EMPORIUM","EMPORM",.)
(1 real change made)

. replace comp=subinstr(comp,"HARDWAREGARDEN","HRDWR",.)
(0 real changes made)

. replace comp=subinstr(comp,"KODAK","KDK",.)
(3 real changes made)

. replace comp=subinstr(comp,"MAN","MN",.)
(485 real changes made)

. replace comp=subinstr(comp,"STORES","",.)
(5 real changes made)

. replace comp=subinstr(comp,"BROTHERS","BROS",.)
(16 real changes made)

. replace comp=subinstr(comp,"AG","",.)
(1,007 real changes made)

. replace comp=subinstr(comp,"ELECTRONIC","ELEC",.)
(57 real changes made)

. replace comp=trim(comp)
(170 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"SYSTEMS","SYS",.)
(592 real changes made)

. replace comp=subinstr(comp,"DU PONT EI DE NEMOURS","DUPONT EI",.)
(0 real changes made)

. replace comp=subinstr(comp,"EI","",.)
(303 real changes made)

. replace comp=subinstr(comp,"PRO FORMA","",.)
(5 real changes made)

. replace comp=subinstr(comp,"CREDIT","CR",.)
(67 real changes made)

. replace comp=subinstr(comp,"LIGHT","LT",.)
(59 real changes made)

. replace comp=subinstr(comp,"CHEMICAL","CHEMICL",.)
(66 real changes made)

. replace comp=subinstr(comp,"&","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DISCREET","DISCRT",.)
(0 real changes made)

. replace comp=subinstr(comp,"LOGIC","LGC",.)
(59 real changes made)

. replace comp=subinstr(comp,"TELEKOM","TELE",.)
(5 real changes made)

. replace comp=subinstr(comp,"TLKOM","TELE",.)
(0 real changes made)

. replace comp=subinstr(comp,"DEUTSCHE","DTSCH",.)
(19 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(0 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(0 real changes made)

. replace comp=subinstr(comp,"PWRLIGHT","PL",.)
(0 real changes made)

. replace comp=subinstr(comp,"SUPERMARKETS","SUPERMKTS",.)
(8 real changes made)

. replace comp=subinstr(comp,"CAPITAL","CAP",.)
(327 real changes made)

. replace comp=subinstr(comp,"GRAND ICE CREAM","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DREAMS","DRMS",.)
(2 real changes made)

. replace comp=subinstr(comp,"EMPORIUM","EMPORM",.)
(0 real changes made)

. replace comp=subinstr(comp,"HARDWAREGARDEN","HRDWR",.)
(0 real changes made)

. replace comp=subinstr(comp,"KODAK","KDK",.)
(0 real changes made)

. replace comp=subinstr(comp,"MAN","MN",.)
(363 real changes made)

. replace comp=subinstr(comp,"STORES","",.)
(4 real changes made)

. replace comp=subinstr(comp,"BROTHERS","BROS",.)
(21 real changes made)

. replace comp=subinstr(comp,"AG","",.)
(971 real changes made)

. replace comp=subinstr(comp,"ELECTRONIC","",.)
(29 real changes made)

. replace comp=trim(comp)
(54 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10609787
.10609787

. 
. *10th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"GAS","GS",.)
(436 real changes made)

. replace comp=subinstr(comp,"TOWN","TWN",.)
(28 real changes made)

. replace comp=subinstr(comp,"L M","",.)
(185 real changes made)

. replace comp=subinstr(comp,"LM","",.)
(186 real changes made)

. replace comp=subinstr(comp,"TELEFON","TEL",.)
(16 real changes made)

. replace comp=trim(comp)
(3 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"GAS","GS",.)
(181 real changes made)

. replace comp=subinstr(comp,"TOWN","TWN",.)
(37 real changes made)

. replace comp=subinstr(comp,"L M","",.)
(216 real changes made)

. replace comp=subinstr(comp,"LM","",.)
(200 real changes made)

. replace comp=subinstr(comp,"TELEFON","TEL",.)
(8 real changes made)

. replace comp=trim(comp)
(1 real change made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.1062067
.1062067

. 
. *11th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"ERICSSON TEL","ERCSON TELE",.)
(1 real change made)

. replace comp=subinstr(comp,"WHEELER","WHLR",.)
(3 real changes made)

. replace comp=subinstr(comp,"FISHER","FISHR",.)
(16 real changes made)

. replace comp=subinstr(comp,"SCIEN","SCI",.)
(125 real changes made)

. replace comp=subinstr(comp,"INTL","",.)
(575 real changes made)

. replace comp=subinstr(comp,"FED EXPRESS","FEDEX",.)
(1 real change made)

. replace comp=subinstr(comp,"WOOD","WD",.)
(78 real changes made)

. replace comp=subinstr(comp,"FLA ROCK","FLORIDA ROCK",.)
(1 real change made)

. replace comp=subinstr(comp,"STONE","STN",.)
(55 real changes made)

. replace comp=subinstr(comp,"TIRERUBBER","TIR",.)
(0 real changes made)

. replace comp=subinstr(comp,"TIR","",.)
(38 real changes made)

. replace comp=subinstr(comp,"CENTER","CNTR",.)
(149 real changes made)

. replace comp=subinstr(comp,"","YR",.)
(0 real changes made)

. replace comp=subinstr(comp,"NSOLIDATED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"MIC","MC",.)
(468 real changes made)

. replace comp=subinstr(comp,"ELECTRIC","ELEC",.)
(207 real changes made)

. replace comp=subinstr(comp,"ELEC","EL",.)
(849 real changes made)

. replace comp=subinstr(comp,"NSOL","",.)
(13 real changes made)

. replace comp=subinstr(comp,"PACIFIC","PAC",.)
(81 real changes made)

. replace comp=subinstr(comp,"W R","WR",.)
(7 real changes made)

. replace comp=trim(comp)
(439 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"ERICSSON TEL","ERCSON TELE",.)
(0 real changes made)

. replace comp=subinstr(comp,"WHEELER","WHLR",.)
(1 real change made)

. replace comp=subinstr(comp,"FISHER","FISHR",.)
(8 real changes made)

. replace comp=subinstr(comp,"SCIEN","SCI",.)
(190 real changes made)

. replace comp=subinstr(comp,"INTL","",.)
(1,068 real changes made)

. replace comp=subinstr(comp,"FED EXPRESS","FEDEX",.)
(0 real changes made)

. replace comp=subinstr(comp,"WOOD","WD",.)
(86 real changes made)

. replace comp=subinstr(comp,"FLA ROCK","FLORIDA ROCK",.)
(0 real changes made)

. replace comp=subinstr(comp,"STONE","STN",.)
(114 real changes made)

. replace comp=subinstr(comp,"TIRERUBBER","TIR",.)
(0 real changes made)

. replace comp=subinstr(comp,"TIR","",.)
(13 real changes made)

. replace comp=subinstr(comp,"CENTER","CNTR",.)
(69 real changes made)

. replace comp=subinstr(comp,"","YR",.)
(0 real changes made)

. replace comp=subinstr(comp,"NSOLIDATED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"MIC","MC",.)
(370 real changes made)

. replace comp=subinstr(comp,"ELECTRIC","ELEC",.)
(65 real changes made)

. replace comp=subinstr(comp,"ELEC","EL",.)
(347 real changes made)

. replace comp=subinstr(comp,"NSOL","",.)
(12 real changes made)

. replace comp=subinstr(comp,"PACIFIC","PAC",.)
(133 real changes made)

. replace comp=subinstr(comp,"W R","WR",.)
(15 real changes made)

. replace comp=trim(comp)
(851 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10918382
.10918382

. 
. *12th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"METRO","MET",.)
(48 real changes made)

. replace comp=subinstr(comp,"TECHNOLOGIES","TECHNOL",.)
(5 real changes made)

. replace comp=subinstr(comp,"DATA MM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"DATAMM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"INSTRUMENT","INSTR",.)
(10 real changes made)

. replace comp=subinstr(comp,"INSTRMN","INSTR",.)
(2 real changes made)

. replace comp=subinstr(comp,"MOTORS","MTR",.)
(26 real changes made)

. replace comp=subinstr(comp,"INSTITUTE","INST",.)
(57 real changes made)

. replace comp=subinword(comp,"GENUINE","GENUIN",.)
(1 real change made)

. replace comp=subinword(comp,"PARTS","PART",.)
(19 real changes made)

. replace comp=subinword(comp,"TEL","TE",.)
(76 real changes made)

. replace comp=subinword(comp,"GLOBALSTAR","GLBLSTR",.)
(0 real changes made)

. replace comp=subinstr(comp,",","",.)
(0 real changes made)

. replace comp=subinword(comp,"GOODYR E","GOODYR",.)
(1 real change made)

. replace comp=subinword(comp,"W","",.)
(48 real changes made)

. replace comp=subinword(comp,"GRAINGER","GRAINGR",.)
(3 real changes made)

. replace comp=subinword(comp,"CHEMCL","CH",.)
(83 real changes made)

. replace comp=subinword(comp,"SP","",.)
(34 real changes made)

. replace comp=trim(comp)
(59 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"METRO","MET",.)
(47 real changes made)

. replace comp=subinstr(comp,"TECHNOLOGIES","TECHNOL",.)
(20 real changes made)

. replace comp=subinstr(comp,"DATA MM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"DATAMM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"INSTRUMENT","INSTR",.)
(30 real changes made)

. replace comp=subinstr(comp,"INSTRMN","INSTR",.)
(0 real changes made)

. replace comp=subinstr(comp,"MOTORS","MTR",.)
(13 real changes made)

. replace comp=subinstr(comp,"INSTITUTE","INST",.)
(7 real changes made)

. replace comp=subinword(comp,"GENUINE","GENUIN",.)
(0 real changes made)

. replace comp=subinword(comp,"PARTS","PART",.)
(7 real changes made)

. replace comp=subinword(comp,"TEL","TE",.)
(6 real changes made)

. replace comp=subinword(comp,"GLOBALSTAR","GLBLSTR",.)
(1 real change made)

. replace comp=subinstr(comp,",","",.)
(0 real changes made)

. replace comp=subinword(comp,"GOODYR E","GOODYR",.)
(0 real changes made)

. replace comp=subinword(comp,"W","",.)
(16 real changes made)

. replace comp=subinword(comp,"GRAINGER","GRAINGR",.)
(0 real changes made)

. replace comp=subinword(comp,"CHEMCL","CH",.)
(40 real changes made)

. replace comp=subinword(comp,"SP","",.)
(225 real changes made)

. replace comp=trim(comp)
(17 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10952016
.10952016

. 
. *13th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"PACKARD","PCK",.)
(9 real changes made)

. replace comp=subinword(comp,"HOTELS","HTL",.)
(12 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"PACKARD","PCK",.)
(1 real change made)

. replace comp=subinword(comp,"HOTELS","HTL",.)
(25 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10952016
.10952016

. 
. *14th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"TROY","TR",.)
(0 real changes made)

. replace comp=subinword(comp,"MEYERS","MEYR",.)
(1 real change made)

. replace comp=subinword(comp,"H J","HJ",.)
(1 real change made)

. replace comp=subinword(comp,"HOTL","HTL",.)
(2 real changes made)

. replace comp=subinword(comp,"HEALTHDYNE","HLTHDNE",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOL","TEC",.)
(3 real changes made)

. replace comp=subinword(comp,"CELANESE","",.)
(3 real changes made)

. replace comp=subinword(comp,"CEL","",.)
(2 real changes made)

. replace comp=subinword(comp,"MIFFLIN","MF",.)
(0 real changes made)

. replace comp=subinword(comp,"LTPWR","LP",.)
(0 real changes made)

. replace comp=subinword(comp,"HOST","HST",.)
(2 real changes made)

. replace comp=subinword(comp,"SUPPLY","SPLY",.)
(88 real changes made)

. replace comp=subinword(comp,"MATERIALS HNDLG","",.)
(0 real changes made)

. replace comp=subinword(comp,"SOLUTIONS","",.)
(109 real changes made)

. replace comp=trim(comp)
(96 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"TROY","TR",.)
(3 real changes made)

. replace comp=subinword(comp,"MEYERS","MEYR",.)
(1 real change made)

. replace comp=subinword(comp,"H J","HJ",.)
(0 real changes made)

. replace comp=subinword(comp,"HOTL","HTL",.)
(0 real changes made)

. replace comp=subinword(comp,"HEALTHDYNE","HLTHDNE",.)
(1 real change made)

. replace comp=subinword(comp,"TECHNOL","TEC",.)
(7 real changes made)

. replace comp=subinword(comp,"CELANESE","",.)
(1 real change made)

. replace comp=subinword(comp,"CEL","",.)
(1 real change made)

. replace comp=subinword(comp,"MIFFLIN","MF",.)
(0 real changes made)

. replace comp=subinword(comp,"LTPWR","LP",.)
(0 real changes made)

. replace comp=subinword(comp,"HOST","HST",.)
(5 real changes made)

. replace comp=subinword(comp,"SUPPLY","SPLY",.)
(25 real changes made)

. replace comp=subinword(comp,"MATERIALS HNDLG","",.)
(1 real change made)

. replace comp=subinword(comp,"SOLUTIONS","",.)
(144 real changes made)

. replace comp=trim(comp)
(136 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3 

. mergeRate       //.10985419
.10985419

. 
. *15th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"CHASE","CHSE",.)
(20 real changes made)

. replace comp=subinword(comp,"J P MORGAN","JPMORGAN",.)
(4 real changes made)

. replace comp=subinword(comp,"CIRCUIT","CRCT",.)
(10 real changes made)

. replace comp=subinword(comp,"NTROLS","CNTL",.)
(0 real changes made)

. replace comp=subinword(comp,"JOHNSONJOHNSON","JOHNSNJHNS",.)
(0 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"CHASE","CHSE",.)
(6 real changes made)

. replace comp=subinword(comp,"J P MORGAN","JPMORGAN",.)
(0 real changes made)

. replace comp=subinword(comp,"CIRCUIT","CRCT",.)
(5 real changes made)

. replace comp=subinword(comp,"NTROLS","CNTL",.)
(0 real changes made)

. replace comp=subinword(comp,"JOHNSONJOHNSON","JOHNSNJHNS",.)
(0 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10986044
.10986044

. 
. *16th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"AM TEL &TEL","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"-","",.)
(0 real changes made)

. replace comp=subinword(comp,"CL","",.)
(18 real changes made)

. replace comp=subinword(comp,"A","",.)
(153 real changes made)

. replace comp=subinword(comp,"HLDG","",.)
(13 real changes made)

. replace comp=subinword(comp,"WARD","WD",.)
(4 real changes made)

. replace comp=subinword(comp,"MONTGOMERY","MONTGMY",.)
(2 real changes made)

. replace comp=subinstr(comp,"PR","",.)
(1,273 real changes made)

. replace comp=subinword(comp,"CORP","",.)
(0 real changes made)

. replace comp=subinword(comp,"CO","",.)
(37 real changes made)

. replace comp=subinword(comp,"CP","",.)
(0 real changes made)

. replace comp=subinword(comp,"INC","",.)
(0 real changes made)

. replace comp=subinword(comp,"DAIMLERCHRYSLER","DAIMLER",.)
(5 real changes made)

. replace comp=subinword(comp,"AG","",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(44 real changes made)

. replace comp=subinword(comp,"EASTMAN","EASTMN",.)
(0 real changes made)

. replace comp=subinword(comp,"KODAK","KODK",.)
(0 real changes made)

. replace comp=subinword(comp,"MACHINES","MA",.)
(3 real changes made)

. replace comp=subinword(comp,"BUSINESS","BUS",.)
(34 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(7 real changes made)

. replace comp=subinword(comp,"EQUIPMENT","EQ",.)
(48 real changes made)

. replace comp=subinword(comp,"PROCTER","PRCTR",.)
(0 real changes made)

. replace comp=subinword(comp,"GAMBLE","GM",.)
(6 real changes made)

. replace comp=subinword(comp,"GENERAL","GEN",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTORS","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"FUNDING","",.)
(5 real changes made)

. replace comp=subinword(comp,"(J C)","(JC)",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(1 real change made)

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(0 real changes made)

. replace comp=subinword(comp,"EXXON MOBIL","EXXON",.)
(0 real changes made)

. replace comp=subinword(comp,"SPRINT NEXTEL","SPRINT",.)
(0 real changes made)

. replace comp=subinword(comp,"INSTRUMENTS","INSTR",.)
(0 real changes made)

. replace comp=subinword(comp,"TEXAS","TX",.)
(60 real changes made)

. replace comp=subinword(comp,"DU PONT (E I) DE NEMOURS","DUPONT (EI)",.)
(0 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(0 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(0 real changes made)

. replace comp=subinword(comp,"RICHFIELD","RIC",.)
(0 real changes made)

. replace comp=subinword(comp,"INTERNATIONAL","INTL",.)
(0 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(0 real changes made)

. replace comp=subinword(comp,"ANHEUSER-BUSCH","ANHEUSR-BSH",.)
(0 real changes made)

. replace comp=subinword(comp,"LOCKHEED MARTIN","LOCKHEED",.)
(4 real changes made)

. replace comp=subinword(comp,"LOCKHD MART","LOCKHEED",.)
(1 real change made)

. replace comp=subinword(comp,"LABORATORIES","LABS",.)
(0 real changes made)

. replace comp=subinword(comp,"AMERICAN","",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGYOLD","TEC",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGY","TEC",.)
(339 real changes made)

. replace comp=subinword(comp,"HOSPITAL","HOSP",.)
(69 real changes made)

. replace comp=subinword(comp,"SUPPLY","SUP",.)
(0 real changes made)

. replace comp=subinword(comp,"PHILIP","PHIL",.)
(8 real changes made)

. replace comp=subinword(comp,"MORRIS","MOR",.)
(7 real changes made)

. replace comp=subinword(comp,"NORTHROP GRUMMAN","NORTHROP",.)
(0 real changes made)

. replace comp=subinword(comp,"LOWE'S COMPANIES","LOWES COS",.)
(0 real changes made)

. replace comp=subinword(comp,"MARIETTA","MRTA",.)
(0 real changes made)

. replace comp=subinword(comp,"MICROSYSTEMS","MICRO",.)
(0 real changes made)

. replace comp=trim(comp)
(168 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"AM TEL &TEL","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"-","",.)
(0 real changes made)

. replace comp=subinword(comp,"CL","",.)
(59 real changes made)

. replace comp=subinword(comp,"A","",.)
(102 real changes made)

. replace comp=subinword(comp,"HLDG","",.)
(63 real changes made)

. replace comp=subinword(comp,"WARD","WD",.)
(4 real changes made)

. replace comp=subinword(comp,"MONTGOMERY","MONTGMY",.)
(4 real changes made)

. replace comp=subinstr(comp,"PR","",.)
(1,446 real changes made)

. replace comp=subinword(comp,"CORP","",.)
(0 real changes made)

. replace comp=subinword(comp,"CO","",.)
(38 real changes made)

. replace comp=subinword(comp,"CP","",.)
(0 real changes made)

. replace comp=subinword(comp,"INC","",.)
(0 real changes made)

. replace comp=subinword(comp,"DAIMLERCHRYSLER","DAIMLER",.)
(0 real changes made)

. replace comp=subinword(comp,"AG","",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(111 real changes made)

. replace comp=subinword(comp,"EASTMAN","EASTMN",.)
(0 real changes made)

. replace comp=subinword(comp,"KODAK","KODK",.)
(0 real changes made)

. replace comp=subinword(comp,"MACHINES","MA",.)
(3 real changes made)

. replace comp=subinword(comp,"BUSINESS","BUS",.)
(44 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(0 real changes made)

. replace comp=subinword(comp,"EQUIPMENT","EQ",.)
(23 real changes made)

. replace comp=subinword(comp,"PROCTER","PRCTR",.)
(0 real changes made)

. replace comp=subinword(comp,"GAMBLE","GM",.)
(1 real change made)

. replace comp=subinword(comp,"GENERAL","GEN",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTORS","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"FUNDING","",.)
(19 real changes made)

. replace comp=subinword(comp,"(J C)","(JC)",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(6 real changes made)

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(2 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(0 real changes made)

. replace comp=subinword(comp,"EXXON MOBIL","EXXON",.)
(0 real changes made)

. replace comp=subinword(comp,"SPRINT NEXTEL","SPRINT",.)
(0 real changes made)

. replace comp=subinword(comp,"INSTRUMENTS","INSTR",.)
(0 real changes made)

. replace comp=subinword(comp,"TEXAS","TX",.)
(37 real changes made)

. replace comp=subinword(comp,"DU PONT (E I) DE NEMOURS","DUPONT (EI)",.)
(0 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(0 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(0 real changes made)

. replace comp=subinword(comp,"RICHFIELD","RIC",.)
(1 real change made)

. replace comp=subinword(comp,"INTERNATIONAL","INTL",.)
(0 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(0 real changes made)

. replace comp=subinword(comp,"ANHEUSER-BUSCH","ANHEUSR-BSH",.)
(0 real changes made)

. replace comp=subinword(comp,"LOCKHEED MARTIN","LOCKHEED",.)
(0 real changes made)

. replace comp=subinword(comp,"LOCKHD MART","LOCKHEED",.)
(0 real changes made)

. replace comp=subinword(comp,"LABORATORIES","LABS",.)
(0 real changes made)

. replace comp=subinword(comp,"AMERICAN","",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGYOLD","TEC",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGY","TEC",.)
(277 real changes made)

. replace comp=subinword(comp,"HOSPITAL","HOSP",.)
(7 real changes made)

. replace comp=subinword(comp,"SUPPLY","SUP",.)
(0 real changes made)

. replace comp=subinword(comp,"PHILIP","PHIL",.)
(3 real changes made)

. replace comp=subinword(comp,"MORRIS","MOR",.)
(1 real change made)

. replace comp=subinword(comp,"NORTHROP GRUMMAN","NORTHROP",.)
(0 real changes made)

. replace comp=subinword(comp,"LOWE'S COMPANIES","LOWES COS",.)
(0 real changes made)

. replace comp=subinword(comp,"MARIETTA","MRTA",.)
(4 real changes made)

. replace comp=subinword(comp,"MICROSYSTEMS","MICRO",.)
(0 real changes made)

. replace comp=trim(comp)
(175 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.1110953
.1110953

. 
. *17th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(0 real changes made)

. replace comp = subinstr(comp, " ", "", .)                                        
>                                //BLUNT way of improving match, remove white space
(24,184 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(0 real changes made)

. replace comp = subinstr(comp, " ", "", .)                                        
>                                //BLUNT way of improving match, remove white space
(22,183 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. stop
command stop is unrecognized
r(199);

end of do-file

r(199);

. use "$data/matched", clear

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. 
. /*******************************************************************************
>         
>         DESCRIPTION: Do file merging the cleaned company names from Compustat and
>  
>                                 the cleaned company names from Segment customer d
> ata
>         
>         INFILES:        - 001_supplierList.dta
>                                 - 001_customerList.dta 
>         
>         OUTFILES:       - merge company name list
>         
>         LOG: Created 28/01/2020
>         
> *******************************************************************************/
. 
. /*******************************************************************************
>         SETUP
> *******************************************************************************/
. 
. clear all

. set more off

. macro drop _all

. set scheme s1color

. set matsize 10000

. 
. *Paths
. global wd "C:/Users/dyevre/Documents/mres_paper"

. global orig "$wd/orig"

. global data "$wd/data/001_network"

. global outputs "$wd/outputs"

. global doc "$wd/doc"

. global code "$wd/code"

. global log "$wd/log"

. 
. *do-file number, used to save outputs 
. global doNum "002"                                      

. 
. *log
. cap log close
-----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 opened on:  29 Jan 2020, 18:14:05

. 
. /*******************************************************************************
>         EXACT MERGE
> *******************************************************************************/
. 
. *Keeping only supplier firms who have financial data
. *use "$data/001_network/001_supplierList.dta", clear
. *merge 1:1 gvkey comp using "$data/001_network/001_companyList_6119.dta"
. *KEEPING ALL firms for now
. 
. *Customer to company exact merge
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"                            
>        // 1 to many merge as several companies in Compustat have the same name bu
> t different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,250

. local merged = `r(N)'

. count if _merge == 1
  35,276

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.00% merge
.05995843

. 
. *Supplier to company exact merge
. use "$data/001_supplierList.dta", clear

. merge 1:1 /*gvkey*/ comp using "$data/001_companyList_6119.dta"
(note: variable comp was str28, now str30 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                        17,690
        from master                       286  (_merge==1)
        from using                     17,404  (_merge==2)

    matched                            15,450  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  15,450

. local merged = `r(N)'

. count if _merge == 1
  286

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //98.18% merge
.98182511

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM: SETUP AND PROGRAMS
> *******************************************************************************/
. 
. *Using the cleaning algorithm from AHRS
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. gen origName = comp             

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp
 18.                 sort comp
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp
 27.                 sort comp
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/matched", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM: IMPLEMENTATION IN SEVERAL ROUNDS OF MANUAL CLEAN
> ING
> *******************************************************************************/
. 
. *1st round
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)
variable origName not found
r(111);

end of do-file

r(111);

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. 
. /*******************************************************************************
>         
>         DESCRIPTION: Do file merging the cleaned company names from Compustat and
>  
>                                 the cleaned company names from Segment customer d
> ata
>         
>         INFILES:        - 001_supplierList.dta
>                                 - 001_customerList.dta 
>         
>         OUTFILES:       - merge company name list
>         
>         LOG: Created 28/01/2020
>         
> *******************************************************************************/
. 
. /*******************************************************************************
>         SETUP
> *******************************************************************************/
. 
. clear all

. set more off

. macro drop _all

. set scheme s1color

. set matsize 10000

. 
. *Paths
. global wd "C:/Users/dyevre/Documents/mres_paper"

. global orig "$wd/orig"

. global data "$wd/data/001_network"

. global outputs "$wd/outputs"

. global doc "$wd/doc"

. global code "$wd/code"

. global log "$wd/log"

. 
. *do-file number, used to save outputs 
. global doNum "002"                                      

. 
. *log
. cap log close
-----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 opened on:  29 Jan 2020, 18:15:35

. 
. /*******************************************************************************
>         EXACT MERGE
> *******************************************************************************/
. 
. *Keeping only supplier firms who have financial data
. *use "$data/001_network/001_supplierList.dta", clear
. *merge 1:1 gvkey comp using "$data/001_network/001_companyList_6119.dta"
. *KEEPING ALL firms for now
. 
. *Customer to company exact merge
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"                            
>        // 1 to many merge as several companies in Compustat have the same name bu
> t different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,250

. local merged = `r(N)'

. count if _merge == 1
  35,276

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.00% merge
.05995843

. 
. *Supplier to company exact merge
. use "$data/001_supplierList.dta", clear

. merge 1:1 /*gvkey*/ comp using "$data/001_companyList_6119.dta"
(note: variable comp was str28, now str30 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                        17,690
        from master                       286  (_merge==1)
        from using                     17,404  (_merge==2)

    matched                            15,450  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  15,450

. local merged = `r(N)'

. count if _merge == 1
  286

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //98.18% merge
.98182511

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM: SETUP AND PROGRAMS
> *******************************************************************************/
. 
. *Using the cleaning algorithm from AHRS
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. gen origName = comp             

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp origName

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp origName

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp origName
 18.                 sort comp origName
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp origName
 27.                 sort comp origName
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/matched", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM: IMPLEMENTATION IN SEVERAL ROUNDS OF MANUAL CLEAN
> ING
> *******************************************************************************/
. 
. *1st round
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(853 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(46 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(11 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(49 real changes made)

. replace comp=subinword(comp,"CO","",.)
(1,362 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(111 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(60 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(499 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(76 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(22 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(124 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(125 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(24 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(156 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(518 real changes made)

. replace comp=trim(comp)
(1,615 real changes made)

. sort comp

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09146594
.09146594

. stop
command stop is unrecognized
r(199);

end of do-file

r(199);

. use "$data/matched.dta", clear

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. 
. /*******************************************************************************
>         
>         DESCRIPTION: Do file merging the cleaned company names from Compustat and
>  
>                                 the cleaned company names from Segment customer d
> ata
>         
>         INFILES:        - 001_supplierList.dta
>                                 - 001_customerList.dta 
>         
>         OUTFILES:       - merge company name list
>         
>         LOG: Created 28/01/2020
>         
> *******************************************************************************/
. 
. /*******************************************************************************
>         SETUP
> *******************************************************************************/
. 
. clear all

. set more off

. macro drop _all

. set scheme s1color

. set matsize 10000

. 
. *Paths
. global wd "C:/Users/dyevre/Documents/mres_paper"

. global orig "$wd/orig"

. global data "$wd/data/001_network"

. global outputs "$wd/outputs"

. global doc "$wd/doc"

. global code "$wd/code"

. global log "$wd/log"

. 
. *do-file number, used to save outputs 
. global doNum "002"                                      

. 
. *log
. cap log close
-----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:/Users/dyevre/Documents/mres_paper/log/002_mergeCustomerSupplier.log
  log type:  text
 opened on:  29 Jan 2020, 18:18:20

. 
. /*******************************************************************************
>         EXACT MERGE
> *******************************************************************************/
. 
. *Keeping only supplier firms who have financial data
. *use "$data/001_network/001_supplierList.dta", clear
. *merge 1:1 gvkey comp using "$data/001_network/001_companyList_6119.dta"
. *KEEPING ALL firms for now
. 
. *Customer to company exact merge
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"                            
>        // 1 to many merge as several companies in Compustat have the same name bu
> t different Gvkeys 

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  2,250

. local merged = `r(N)'

. count if _merge == 1
  35,276

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //6.00% merge
.05995843

. 
. *Supplier to company exact merge
. use "$data/001_supplierList.dta", clear

. merge 1:1 /*gvkey*/ comp using "$data/001_companyList_6119.dta"
(note: variable comp was str28, now str30 to accommodate using data's values)

    Result                           # of obs.
    -----------------------------------------
    not matched                        17,690
        from master                       286  (_merge==1)
        from using                     17,404  (_merge==2)

    matched                            15,450  (_merge==3)
    -----------------------------------------

. count if _merge == 3
  15,450

. local merged = `r(N)'

. count if _merge == 1
  286

. local master = `r(N)'

. di `merged'/(`master'+`merged')                                                  
>                                                //98.18% merge
.98182511

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM: SETUP AND PROGRAMS
> *******************************************************************************/
. 
. *Using the cleaning algorithm from AHRS
. use "$data/001_customerList.dta", clear

. merge 1:1 comp using "$data/001_companyList_6119.dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                        65,880
        from master                    35,276  (_merge==1)
        from using                     30,604  (_merge==2)

    matched                             2,250  (_merge==3)
    -----------------------------------------

. gen origName = comp             

. save "$data/tempmerge.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/tempmerge.dta saved

. 
. *AHRS manual cleaning (re-used with permission given by Enghin Atalay, 03/12/2019
> )
. /*Matched results will go in a file*/
. keep if _merge==3
(65,880 observations deleted)

. drop _merge

. count
  2,250

. global merge_count = `r(N)'

. save "$data/matched.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/matched.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==1                                                                
>                                                                //customer name on
> ly, no match in Compustat company list
(32,854 observations deleted)

. keep comp origName

. count
  35,276

. global resid1_count = `r(N)'

. save "$data/resid1", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/tempmerge", clear

. keep if _merge==2                                                                
>                                                                //official company
>  names in Compustat only, these companies have not found a match in the segmnent 
> data as reported
(37,526 observations deleted)

. keep comp origName

. count
  30,604

. global resid2_count = `r(N)'

. save "$data/resid2", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. di $merge_count/($resid1_count+$merge_count)
.05995843

. 
. *Program automating the merge of the residual datasets after each cleaning step
. *From http://www.stata.com/statalist/archive/2004-02/msg00246.html*/
. cap program drop merge3

. program merge3 
  1.         qui{
  2.                 confirm file "$data/matched.dta"
  3.                 confirm file "$data/resid1.dta" 
  4.                 confirm file "$data/resid2.dta" 
  5. 
.                 use "$data/resid1", clear 
  6.                 merge 1:1 comp using "$data/resid2"
  7.                 if _N==0{
  8.                         exit
  9.                         }
 10.                 save "$data/result.dta", replace
 11. 
.                 keep if _merge==3
 12.                 drop _merge
 13.                 append using "$data/matched.dta"
 14.                 save "$data/matched.dta", replace
 15. 
.                 use "$data/result.dta", clear 
 16.                 keep if _merge==1
 17.                 keep comp origName
 18.                 sort comp origName
 19.                 merge 1:1 comp using "$data/resid1"
 20.                 keep if _merge==3
 21.                 drop _merge
 22.                 sort comp
 23.                 save "$data/resid1", replace emptyok
 24. 
.                 use "$data/result.dta", clear 
 25.                 keep if _merge==2
 26.                 keep comp origName
 27.                 sort comp origName
 28.                 merge 1:1 comp using "$data/resid2.dta" 
 29.                 keep if _merge==3
 30.                 drop _merge
 31.                 sort comp
 32.                 save "$data/resid2.dta" , replace emptyok
 33. 
.                 erase "$data/result.dta"
 34.                 }
 35.         end

. 
. *Calculating improvement in matching rate
. cap program drop mergeRate

. program mergeRate 
  1.         qui{
  2.                 use "$data/matched", clear
  3.                 count
  4.                 global merge_count = `r(N)'
  5.                 use "$data/resid1", clear
  6.                 count
  7.                 global resid1_count = `r(N)'
  8.                 use "$data/resid2", clear
  9.                 count
 10.                 global resid2_count = `r(N)'
 11.                 }
 12.         di $merge_count/($resid1_count+$merge_count)    
 13.         end

. 
. /*******************************************************************************
>         AHRS CLEANING ALGORITHM: IMPLEMENTATION IN SEVERAL ROUNDS OF MANUAL CLEAN
> ING
> *******************************************************************************/
. 
. *1st round
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(1,775 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(76 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(696 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(16 real changes made)

. replace comp=subinword(comp,"CO","",.)
(2,184 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(3,594 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(39 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(442 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(2,020 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(94 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(57 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(96 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(107 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(19 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(54 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(110 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(186 real changes made)

. replace comp=trim(comp)
(7,972 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"CORP","",.)
(853 real changes made)

. replace comp=subinstr(comp,"COMPANIES","",.)
(46 real changes made)

. replace comp=subinstr(comp,"COMPANY","",.)
(11 real changes made)

. replace comp=subinstr(comp,"CONSOLIDATED","",.)
(49 real changes made)

. replace comp=subinword(comp,"CO","",.)
(1,362 real changes made)

. replace comp=subinstr(comp,"INC","",.)
(111 real changes made)

. replace comp=subinstr(comp,"LABORATORIES","LAB",.)
(60 real changes made)

. replace comp=subinstr(comp,"/"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"-"," ",.)
(0 real changes made)

. replace comp=subinstr(comp,"LP","",.)
(499 real changes made)

. replace comp=subinstr(comp,"LTD","",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(76 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(22 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(124 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(125 real changes made)

. replace comp=subinword(comp,"MOBIL","",.)
(1 real change made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(24 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(156 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(518 real changes made)

. replace comp=trim(comp)
(1,615 real changes made)

. sort comp

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09146594
.09146594

. 
. *2nd
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"A T & T","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"GROUP","",.)
(703 real changes made)

. replace comp=subinstr(comp,"HEALTHCARE","HTHCR",.)
(108 real changes made)

. replace comp=subinstr(comp,"SPON ADR","",.)
(32 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT SYSTEM","ABF FREIGHT",.)
(0 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT","ABF",.)
(1 real change made)

. replace comp=subinstr(comp,"PLC","",.)
(106 real changes made)

. replace comp=subinstr(comp,"HOLDINGS","",.)
(178 real changes made)

. replace comp=subinstr(comp,"ADR","",.)
(397 real changes made)

. replace comp=subinstr(comp,"INDUSTRIES","IND",.)
(115 real changes made)

. replace comp=subinstr(comp,"UNITED","UTD",.)
(6 real changes made)

. replace comp=trim(comp)
(1,093 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"A T & T","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"SPON ADR","",.)
(0 real changes made)

. replace comp=subinstr(comp,"PLC","",.)
(2 real changes made)

. replace comp=subinstr(comp,"GROUP","",.)
(1,103 real changes made)

. replace comp=subinstr(comp,"HEALTHCARE","HTHCR",.)
(119 real changes made)

. replace comp=subinstr(comp,"ABF FREIGHT SYSTEM","ABF FREIGHT",.)
(1 real change made)

. replace comp=subinstr(comp,"ABF FREIGHT","ABF",.)
(1 real change made)

. replace comp=subinstr(comp,"HOLDINGS","",.)
(815 real changes made)

. replace comp=subinstr(comp,"ADR","",.)
(290 real changes made)

. replace comp=subinstr(comp,"INDUSTRIES","IND",.)
(645 real changes made)

. replace comp=subinstr(comp,"UNITED","UTD",.)
(4 real changes made)

. replace comp=trim(comp)
(1,788 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09685959
.09685959

. 
. *3rd
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"TELECOMMUNICATIONS","TELEM",.)
(27 real changes made)

. replace comp=subinstr(comp,"CL A","",.)
(65 real changes made)

. replace comp=subinstr(comp,"MMUNICATIONS","MMUN",.)
(172 real changes made)

. replace comp=subinstr(comp,"ADVANCED MICRO DEVICES","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"ADV MICRO DV","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"CP","",.)
(367 real changes made)

. replace comp=subinstr(comp,"CMPTRS","MPUTERS",.)
(1 real change made)

. replace comp=subinstr(comp,"AHA BETA","AHA BETA TECHNOLOGY",.)
(1 real change made)

. replace comp=subinstr(comp,"PRDS&CH","PRODUCTS & CHEMICALS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRTOUCH CM","AIRTOUCH COMMUNICATIONS",.)
(1 real change made)

. replace comp=subinstr(comp,"INTERNATIONAL","INTL",.)
(376 real changes made)

. replace comp=subinstr(comp,"POWER","PWR",.)
(286 real changes made)

. replace comp=subinstr(comp,"'","",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","",.)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"TELEMMUNICATIONS","TELEM",.)
(0 real changes made)

. replace comp=subinstr(comp,"MMUNICATIONS","MMUN",.)
(277 real changes made)

. replace comp=subinstr(comp,"ADVANCED MICRO DEVICES","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"ADV MICRO DV","AMD",.)
(0 real changes made)

. replace comp=subinstr(comp,"CL A","",.)
(498 real changes made)

. replace comp=subinstr(comp,"CP","",.)
(437 real changes made)

. replace comp=subinstr(comp,"CMPTRS","MPUTERS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AHA BETA","AHA BETA TECHNOLOGY",.)
(1 real change made)

. replace comp=subinstr(comp,"PRDS&CH","PRODUCTS & CHEMICALS",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRTOUCH CM","AIRTOUCH COMMUNICATIONS",.)
(0 real changes made)

. replace comp=subinstr(comp,"INTERNATIONAL","INTL",.)
(483 real changes made)

. replace comp=subinstr(comp,"POWER","PWR",.)
(208 real changes made)

. replace comp=subinstr(comp,"'","",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","",.)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.09804468
.09804468

. 
. *4th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"SA","",.)
(428 real changes made)

. replace comp=subinstr(comp,"PRODUCTS","PROD",.)
(128 real changes made)

. replace comp=subinstr(comp,"ELECTRONICS","ELECT",.)
(173 real changes made)

. replace comp=trim(comp)
(666 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"PRODUCTS","PROD",.)
(158 real changes made)

. replace comp=subinstr(comp,"ELECTRONICS","ELECT",.)
(80 real changes made)

. replace comp=subinword(comp,"SA","",.)
(145 real changes made)

. replace comp=trim(comp)
(828 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10131343
.10131343

. 
. *5th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"AMERICA","AMER",.)
(312 real changes made)

. replace comp=subinstr(comp,".","",.)
(0 real changes made)

. replace comp=subinstr(comp,"HYDRO ELECTRIC","HYD",.)
(0 real changes made)

. replace comp=subinstr(comp,"OLD","",.)
(198 real changes made)

. replace comp=subinstr(comp,"TRUST","TR",.)
(53 real changes made)

. replace comp=subinstr(comp,"BARCLAYS BANK","BARCLAYS",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","&",.)
(0 real changes made)

. replace comp=subinstr(comp,"NOBLE","NOBL",.)
(25 real changes made)

. replace comp=subinstr(comp,"BANK","BK",.)
(238 real changes made)

. replace comp=subinstr(comp,"NEW","",.)
(262 real changes made)

. replace comp=subinstr(comp,"WRIGHT","WRGHT",.)
(4 real changes made)

. replace comp=trim(comp)
(96 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"AMERICA","AMER",.)
(657 real changes made)

. replace comp=subinstr(comp,".","",.)
(0 real changes made)

. replace comp=subinstr(comp,"HYDRO ELECTRIC","HYD",.)
(0 real changes made)

. replace comp=subinstr(comp,"OLD","",.)
(1,104 real changes made)

. replace comp=subinstr(comp,"TRUST","TR",.)
(346 real changes made)

. replace comp=subinstr(comp,"BARCLAYS BANK","BARCLAYS",.)
(0 real changes made)

. replace comp=subinstr(comp," & ","&",.)
(0 real changes made)

. replace comp=subinstr(comp,"NOBLE","NOBL",.)
(7 real changes made)

. replace comp=subinstr(comp,"BANK","BK",.)
(356 real changes made)

. replace comp=subinstr(comp,"NEW","",.)
(232 real changes made)

. replace comp=subinstr(comp,"WRIGHT","WRGHT",.)
(14 real changes made)

. replace comp=trim(comp)
(433 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10332145
.10332145

. 
. *6th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"A G","AG",.)
(90 real changes made)

. replace comp=subinstr(comp,"AEROSPACE","AEROSPAC",.)
(31 real changes made)

. replace comp=subinstr(comp,"(","",.)
(0 real changes made)

. replace comp=subinstr(comp,")","",.)
(0 real changes made)

. replace comp=subinstr(comp,"L L","LL",.)
(169 real changes made)

. replace comp=subinstr(comp,"STEARNS","STRNS",.)
(1 real change made)

. replace comp=subinstr(comp,"DICKINSON &","DICK",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCRAFT","AIRCR",.)
(10 real changes made)

. replace comp=subinstr(comp,"AIRCRFT","AIRCR",.)
(5 real changes made)

. replace comp=subinstr(comp,"CANADA","CDA",.)
(70 real changes made)

. replace comp=subinstr(comp,"PROJECTED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"TELEM","TEL",.)
(37 real changes made)

. replace comp=subinstr(comp,"BETHLEHEM","BETHLHM",.)
(1 real change made)

. replace comp=subinstr(comp,"STEEL","STL",.)
(162 real changes made)

. replace comp=subinstr(comp,"ENTERPRISES","ENT",.)
(48 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"A G","AG",.)
(86 real changes made)

. replace comp=subinstr(comp,"AEROSPACE","AEROSPAC",.)
(15 real changes made)

. replace comp=subinstr(comp,"(","",.)
(0 real changes made)

. replace comp=subinstr(comp,")","",.)
(0 real changes made)

. replace comp=subinstr(comp,"L L","LL",.)
(82 real changes made)

. replace comp=subinstr(comp,"STEARNS","STRNS",.)
(3 real changes made)

. replace comp=subinstr(comp,"DICKINSON &","DICK",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCRAFT","AIRCR",.)
(12 real changes made)

. replace comp=subinstr(comp,"AIRCRFT","AIRCR",.)
(1 real change made)

. replace comp=subinstr(comp,"CANADA","CDA",.)
(22 real changes made)

. replace comp=subinstr(comp,"PROJECTED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"TELEM","TEL",.)
(14 real changes made)

. replace comp=subinstr(comp,"BETHLEHEM","BETHLHM",.)
(3 real changes made)

. replace comp=subinstr(comp,"STEEL","STL",.)
(66 real changes made)

. replace comp=subinstr(comp,"ENTERPRISES","ENT",.)
(111 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10360133
.10360133

. 
. *7th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"BIG THREE","BIG THREE IND",.)
(1 real change made)

. replace comp=subinstr(comp,"LLC","",.)
(864 real changes made)

. replace comp=subinstr(comp,"BORG WARNER","",.)
(1 real change made)

. replace comp=subinstr(comp,"SCIENTIFIC","SCI",.)
(18 real changes made)

. replace comp=subinstr(comp,"ADS","BP",.)
(31 real changes made)

. replace comp=subinstr(comp,"BRIGGS&STRATTON","BRIGG&STRN",.)
(0 real changes made)

. replace comp=subinstr(comp,"MYERS SQUIBB","MYRS",.)
(3 real changes made)

. replace comp=subinstr(comp,"CA CL","CA LA",.)
(1 real change made)

. replace comp=subinstr(comp,"GOLF","GF",.)
(13 real changes made)

. replace comp=subinstr(comp,"SOUP","SP",.)
(2 real changes made)

. replace comp=subinstr(comp,"CAMPBELL","CAMPBL",.)
(2 real changes made)

. replace comp=subinstr(comp,"FINANCIAL","FINL",.)
(57 real changes made)

. replace comp=subinstr(comp,"NATURAL GAS","NAT",.)
(25 real changes made)

. replace comp=subinstr(comp,"CANADIAN","CDN",.)
(18 real changes made)

. replace comp=subinstr(comp,"AIRCFT","AIRC",.)
(7 real changes made)

. replace comp=subinstr(comp,"AIRCR","AIRC",.)
(15 real changes made)

. replace comp=trim(comp)
(781 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"LLC","",.)
(136 real changes made)

. replace comp=subinstr(comp,"BORG WARNER","",.)
(0 real changes made)

. replace comp=subinstr(comp,"SCIENTIFIC","SCI",.)
(47 real changes made)

. replace comp=subinstr(comp,"BP   ADS","BP",.)
(0 real changes made)

. replace comp=subinstr(comp,"BRIGGS&STRATTON","BRIGG&STRN",.)
(0 real changes made)

. replace comp=subinstr(comp,"MYERS SQUIBB","MYRS",.)
(0 real changes made)

. replace comp=subinstr(comp,"CA CL","CA LA",.)
(0 real changes made)

. replace comp=subinstr(comp,"GOLF","GF",.)
(22 real changes made)

. replace comp=subinstr(comp,"SOUP","SP",.)
(2 real changes made)

. replace comp=subinstr(comp,"CAMPBELL","CAMPBL",.)
(5 real changes made)

. replace comp=subinstr(comp,"FINANCIAL","FINL",.)
(695 real changes made)

. replace comp=subinstr(comp,"NATURAL GAS","NAT",.)
(20 real changes made)

. replace comp=subinstr(comp,"CANADIAN","CDN",.)
(13 real changes made)

. replace comp=subinstr(comp,"AIRCFT","AIRC",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIRCR","AIRC",.)
(11 real changes made)

. replace comp=trim(comp)
(85 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10459838
.10459838

. 
. *8th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"ROEBK","",.)
(1 real change made)

. replace comp=subinstr(comp,"ROEBUCK &","",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIR LINES","AIRL",.)
(4 real changes made)

. replace comp=trim(comp)
(1 real change made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"ROEBK","",.)
(0 real changes made)

. replace comp=subinstr(comp,"ROEBUCK &","",.)
(0 real changes made)

. replace comp=subinstr(comp,"AIR LINES","AIRL",.)
(4 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10460428
.10460428

. 
. 
. *9th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"SYSTEMS","SYS",.)
(269 real changes made)

. replace comp=subinstr(comp,"DU PONT EI DE NEMOURS","DUPONT EI",.)
(0 real changes made)

. replace comp=subinstr(comp,"EI","",.)
(669 real changes made)

. replace comp=subinstr(comp,"PRO FORMA","",.)
(16 real changes made)

. replace comp=subinstr(comp,"CREDIT","CR",.)
(25 real changes made)

. replace comp=subinstr(comp,"LIGHT","LT",.)
(52 real changes made)

. replace comp=subinstr(comp,"CHEMICAL","CHEMICL",.)
(124 real changes made)

. replace comp=subinstr(comp,"&","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DISCREET","DISCRT",.)
(0 real changes made)

. replace comp=subinstr(comp,"LOGIC","LGC",.)
(36 real changes made)

. replace comp=subinstr(comp,"TELEKOM","TELE",.)
(8 real changes made)

. replace comp=subinstr(comp,"TLKOM","TELE",.)
(1 real change made)

. replace comp=subinstr(comp,"DEUTSCHE","DTSCH",.)
(19 real changes made)

. 
. replace comp=subinstr(comp,"PWRLIGHT","PL",.)
(0 real changes made)

. replace comp=subinstr(comp,"SUPERMARKETS","SUPERMKTS",.)
(9 real changes made)

. replace comp=subinstr(comp,"CAPITAL","CAP",.)
(75 real changes made)

. replace comp=subinstr(comp,"GRAND ICE CREAM","",.)
(1 real change made)

. replace comp=subinstr(comp,"DREAMS","DRMS",.)
(2 real changes made)

. replace comp=subinstr(comp,"EMPORIUM","EMPORM",.)
(1 real change made)

. replace comp=subinstr(comp,"HARDWAREGARDEN","HRDWR",.)
(0 real changes made)

. replace comp=subinstr(comp,"KODAK","KDK",.)
(3 real changes made)

. replace comp=subinstr(comp,"MAN","MN",.)
(485 real changes made)

. replace comp=subinstr(comp,"STORES","",.)
(5 real changes made)

. replace comp=subinstr(comp,"BROTHERS","BROS",.)
(16 real changes made)

. replace comp=subinstr(comp,"AG","",.)
(1,007 real changes made)

. replace comp=subinstr(comp,"ELECTRONIC","ELEC",.)
(57 real changes made)

. replace comp=trim(comp)
(170 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"SYSTEMS","SYS",.)
(592 real changes made)

. replace comp=subinstr(comp,"DU PONT EI DE NEMOURS","DUPONT EI",.)
(0 real changes made)

. replace comp=subinstr(comp,"EI","",.)
(303 real changes made)

. replace comp=subinstr(comp,"PRO FORMA","",.)
(5 real changes made)

. replace comp=subinstr(comp,"CREDIT","CR",.)
(67 real changes made)

. replace comp=subinstr(comp,"LIGHT","LT",.)
(59 real changes made)

. replace comp=subinstr(comp,"CHEMICAL","CHEMICL",.)
(66 real changes made)

. replace comp=subinstr(comp,"&","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DISCREET","DISCRT",.)
(0 real changes made)

. replace comp=subinstr(comp,"LOGIC","LGC",.)
(59 real changes made)

. replace comp=subinstr(comp,"TELEKOM","TELE",.)
(5 real changes made)

. replace comp=subinstr(comp,"TLKOM","TELE",.)
(0 real changes made)

. replace comp=subinstr(comp,"DEUTSCHE","DTSCH",.)
(19 real changes made)

. replace comp=subinstr(comp,"GENERAL","GENL",.)
(0 real changes made)

. replace comp=subinstr(comp,"GENL","GEN",.)
(0 real changes made)

. replace comp=subinstr(comp,"PWRLIGHT","PL",.)
(0 real changes made)

. replace comp=subinstr(comp,"SUPERMARKETS","SUPERMKTS",.)
(8 real changes made)

. replace comp=subinstr(comp,"CAPITAL","CAP",.)
(327 real changes made)

. replace comp=subinstr(comp,"GRAND ICE CREAM","",.)
(0 real changes made)

. replace comp=subinstr(comp,"DREAMS","DRMS",.)
(2 real changes made)

. replace comp=subinstr(comp,"EMPORIUM","EMPORM",.)
(0 real changes made)

. replace comp=subinstr(comp,"HARDWAREGARDEN","HRDWR",.)
(0 real changes made)

. replace comp=subinstr(comp,"KODAK","KDK",.)
(0 real changes made)

. replace comp=subinstr(comp,"MAN","MN",.)
(363 real changes made)

. replace comp=subinstr(comp,"STORES","",.)
(4 real changes made)

. replace comp=subinstr(comp,"BROTHERS","BROS",.)
(21 real changes made)

. replace comp=subinstr(comp,"AG","",.)
(971 real changes made)

. replace comp=subinstr(comp,"ELECTRONIC","",.)
(29 real changes made)

. replace comp=trim(comp)
(54 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10609787
.10609787

. 
. *10th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"GAS","GS",.)
(436 real changes made)

. replace comp=subinstr(comp,"TOWN","TWN",.)
(28 real changes made)

. replace comp=subinstr(comp,"L M","",.)
(185 real changes made)

. replace comp=subinstr(comp,"LM","",.)
(186 real changes made)

. replace comp=subinstr(comp,"TELEFON","TEL",.)
(16 real changes made)

. replace comp=trim(comp)
(3 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"GAS","GS",.)
(181 real changes made)

. replace comp=subinstr(comp,"TOWN","TWN",.)
(37 real changes made)

. replace comp=subinstr(comp,"L M","",.)
(216 real changes made)

. replace comp=subinstr(comp,"LM","",.)
(200 real changes made)

. replace comp=subinstr(comp,"TELEFON","TEL",.)
(8 real changes made)

. replace comp=trim(comp)
(1 real change made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.1062067
.1062067

. 
. *11th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"ERICSSON TEL","ERCSON TELE",.)
(1 real change made)

. replace comp=subinstr(comp,"WHEELER","WHLR",.)
(3 real changes made)

. replace comp=subinstr(comp,"FISHER","FISHR",.)
(16 real changes made)

. replace comp=subinstr(comp,"SCIEN","SCI",.)
(125 real changes made)

. replace comp=subinstr(comp,"INTL","",.)
(575 real changes made)

. replace comp=subinstr(comp,"FED EXPRESS","FEDEX",.)
(1 real change made)

. replace comp=subinstr(comp,"WOOD","WD",.)
(78 real changes made)

. replace comp=subinstr(comp,"FLA ROCK","FLORIDA ROCK",.)
(1 real change made)

. replace comp=subinstr(comp,"STONE","STN",.)
(55 real changes made)

. replace comp=subinstr(comp,"TIRERUBBER","TIR",.)
(0 real changes made)

. replace comp=subinstr(comp,"TIR","",.)
(38 real changes made)

. replace comp=subinstr(comp,"CENTER","CNTR",.)
(149 real changes made)

. replace comp=subinstr(comp,"","YR",.)
(0 real changes made)

. replace comp=subinstr(comp,"NSOLIDATED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"MIC","MC",.)
(468 real changes made)

. replace comp=subinstr(comp,"ELECTRIC","ELEC",.)
(207 real changes made)

. replace comp=subinstr(comp,"ELEC","EL",.)
(849 real changes made)

. replace comp=subinstr(comp,"NSOL","",.)
(13 real changes made)

. replace comp=subinstr(comp,"PACIFIC","PAC",.)
(81 real changes made)

. replace comp=subinstr(comp,"W R","WR",.)
(7 real changes made)

. replace comp=trim(comp)
(439 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"ERICSSON TEL","ERCSON TELE",.)
(0 real changes made)

. replace comp=subinstr(comp,"WHEELER","WHLR",.)
(1 real change made)

. replace comp=subinstr(comp,"FISHER","FISHR",.)
(8 real changes made)

. replace comp=subinstr(comp,"SCIEN","SCI",.)
(190 real changes made)

. replace comp=subinstr(comp,"INTL","",.)
(1,068 real changes made)

. replace comp=subinstr(comp,"FED EXPRESS","FEDEX",.)
(0 real changes made)

. replace comp=subinstr(comp,"WOOD","WD",.)
(86 real changes made)

. replace comp=subinstr(comp,"FLA ROCK","FLORIDA ROCK",.)
(0 real changes made)

. replace comp=subinstr(comp,"STONE","STN",.)
(114 real changes made)

. replace comp=subinstr(comp,"TIRERUBBER","TIR",.)
(0 real changes made)

. replace comp=subinstr(comp,"TIR","",.)
(13 real changes made)

. replace comp=subinstr(comp,"CENTER","CNTR",.)
(69 real changes made)

. replace comp=subinstr(comp,"","YR",.)
(0 real changes made)

. replace comp=subinstr(comp,"NSOLIDATED","",.)
(0 real changes made)

. replace comp=subinstr(comp,"MIC","MC",.)
(370 real changes made)

. replace comp=subinstr(comp,"ELECTRIC","ELEC",.)
(65 real changes made)

. replace comp=subinstr(comp,"ELEC","EL",.)
(347 real changes made)

. replace comp=subinstr(comp,"NSOL","",.)
(12 real changes made)

. replace comp=subinstr(comp,"PACIFIC","PAC",.)
(133 real changes made)

. replace comp=subinstr(comp,"W R","WR",.)
(15 real changes made)

. replace comp=trim(comp)
(851 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10918382
.10918382

. 
. *12th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"METRO","MET",.)
(48 real changes made)

. replace comp=subinstr(comp,"TECHNOLOGIES","TECHNOL",.)
(5 real changes made)

. replace comp=subinstr(comp,"DATA MM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"DATAMM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"INSTRUMENT","INSTR",.)
(10 real changes made)

. replace comp=subinstr(comp,"INSTRMN","INSTR",.)
(2 real changes made)

. replace comp=subinstr(comp,"MOTORS","MTR",.)
(26 real changes made)

. replace comp=subinstr(comp,"INSTITUTE","INST",.)
(57 real changes made)

. replace comp=subinword(comp,"GENUINE","GENUIN",.)
(1 real change made)

. replace comp=subinword(comp,"PARTS","PART",.)
(19 real changes made)

. replace comp=subinword(comp,"TEL","TE",.)
(76 real changes made)

. replace comp=subinword(comp,"GLOBALSTAR","GLBLSTR",.)
(0 real changes made)

. replace comp=subinstr(comp,",","",.)
(0 real changes made)

. replace comp=subinword(comp,"GOODYR E","GOODYR",.)
(1 real change made)

. replace comp=subinword(comp,"W","",.)
(48 real changes made)

. replace comp=subinword(comp,"GRAINGER","GRAINGR",.)
(3 real changes made)

. replace comp=subinword(comp,"CHEMCL","CH",.)
(83 real changes made)

. replace comp=subinword(comp,"SP","",.)
(34 real changes made)

. replace comp=trim(comp)
(59 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"METRO","MET",.)
(47 real changes made)

. replace comp=subinstr(comp,"TECHNOLOGIES","TECHNOL",.)
(20 real changes made)

. replace comp=subinstr(comp,"DATA MM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"DATAMM","DATAM",.)
(0 real changes made)

. replace comp=subinstr(comp,"INSTRUMENT","INSTR",.)
(30 real changes made)

. replace comp=subinstr(comp,"INSTRMN","INSTR",.)
(0 real changes made)

. replace comp=subinstr(comp,"MOTORS","MTR",.)
(13 real changes made)

. replace comp=subinstr(comp,"INSTITUTE","INST",.)
(7 real changes made)

. replace comp=subinword(comp,"GENUINE","GENUIN",.)
(0 real changes made)

. replace comp=subinword(comp,"PARTS","PART",.)
(7 real changes made)

. replace comp=subinword(comp,"TEL","TE",.)
(6 real changes made)

. replace comp=subinword(comp,"GLOBALSTAR","GLBLSTR",.)
(1 real change made)

. replace comp=subinstr(comp,",","",.)
(0 real changes made)

. replace comp=subinword(comp,"GOODYR E","GOODYR",.)
(0 real changes made)

. replace comp=subinword(comp,"W","",.)
(16 real changes made)

. replace comp=subinword(comp,"GRAINGER","GRAINGR",.)
(0 real changes made)

. replace comp=subinword(comp,"CHEMCL","CH",.)
(40 real changes made)

. replace comp=subinword(comp,"SP","",.)
(225 real changes made)

. replace comp=trim(comp)
(17 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10952016
.10952016

. 
. *13th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"PACKARD","PCK",.)
(9 real changes made)

. replace comp=subinword(comp,"HOTELS","HTL",.)
(12 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"PACKARD","PCK",.)
(1 real change made)

. replace comp=subinword(comp,"HOTELS","HTL",.)
(25 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10952016
.10952016

. 
. *14th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"TROY","TR",.)
(0 real changes made)

. replace comp=subinword(comp,"MEYERS","MEYR",.)
(1 real change made)

. replace comp=subinword(comp,"H J","HJ",.)
(1 real change made)

. replace comp=subinword(comp,"HOTL","HTL",.)
(2 real changes made)

. replace comp=subinword(comp,"HEALTHDYNE","HLTHDNE",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOL","TEC",.)
(3 real changes made)

. replace comp=subinword(comp,"CELANESE","",.)
(3 real changes made)

. replace comp=subinword(comp,"CEL","",.)
(2 real changes made)

. replace comp=subinword(comp,"MIFFLIN","MF",.)
(0 real changes made)

. replace comp=subinword(comp,"LTPWR","LP",.)
(0 real changes made)

. replace comp=subinword(comp,"HOST","HST",.)
(2 real changes made)

. replace comp=subinword(comp,"SUPPLY","SPLY",.)
(88 real changes made)

. replace comp=subinword(comp,"MATERIALS HNDLG","",.)
(0 real changes made)

. replace comp=subinword(comp,"SOLUTIONS","",.)
(109 real changes made)

. replace comp=trim(comp)
(96 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"TROY","TR",.)
(3 real changes made)

. replace comp=subinword(comp,"MEYERS","MEYR",.)
(1 real change made)

. replace comp=subinword(comp,"H J","HJ",.)
(0 real changes made)

. replace comp=subinword(comp,"HOTL","HTL",.)
(0 real changes made)

. replace comp=subinword(comp,"HEALTHDYNE","HLTHDNE",.)
(1 real change made)

. replace comp=subinword(comp,"TECHNOL","TEC",.)
(7 real changes made)

. replace comp=subinword(comp,"CELANESE","",.)
(1 real change made)

. replace comp=subinword(comp,"CEL","",.)
(1 real change made)

. replace comp=subinword(comp,"MIFFLIN","MF",.)
(0 real changes made)

. replace comp=subinword(comp,"LTPWR","LP",.)
(0 real changes made)

. replace comp=subinword(comp,"HOST","HST",.)
(5 real changes made)

. replace comp=subinword(comp,"SUPPLY","SPLY",.)
(25 real changes made)

. replace comp=subinword(comp,"MATERIALS HNDLG","",.)
(1 real change made)

. replace comp=subinword(comp,"SOLUTIONS","",.)
(144 real changes made)

. replace comp=trim(comp)
(136 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3 

. mergeRate       //.10985419
.10985419

. 
. *15th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"CHASE","CHSE",.)
(20 real changes made)

. replace comp=subinword(comp,"J P MORGAN","JPMORGAN",.)
(4 real changes made)

. replace comp=subinword(comp,"CIRCUIT","CRCT",.)
(10 real changes made)

. replace comp=subinword(comp,"NTROLS","CNTL",.)
(0 real changes made)

. replace comp=subinword(comp,"JOHNSONJOHNSON","JOHNSNJHNS",.)
(0 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"CHASE","CHSE",.)
(6 real changes made)

. replace comp=subinword(comp,"J P MORGAN","JPMORGAN",.)
(0 real changes made)

. replace comp=subinword(comp,"CIRCUIT","CRCT",.)
(5 real changes made)

. replace comp=subinword(comp,"NTROLS","CNTL",.)
(0 real changes made)

. replace comp=subinword(comp,"JOHNSONJOHNSON","JOHNSNJHNS",.)
(0 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.10986044
.10986044

. 
. *16th
. use "$data/resid1.dta", clear

. replace comp=subinstr(comp,"AM TEL &TEL","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"-","",.)
(0 real changes made)

. replace comp=subinword(comp,"CL","",.)
(18 real changes made)

. replace comp=subinword(comp,"A","",.)
(153 real changes made)

. replace comp=subinword(comp,"HLDG","",.)
(13 real changes made)

. replace comp=subinword(comp,"WARD","WD",.)
(4 real changes made)

. replace comp=subinword(comp,"MONTGOMERY","MONTGMY",.)
(2 real changes made)

. replace comp=subinstr(comp,"PR","",.)
(1,273 real changes made)

. replace comp=subinword(comp,"CORP","",.)
(0 real changes made)

. replace comp=subinword(comp,"CO","",.)
(37 real changes made)

. replace comp=subinword(comp,"CP","",.)
(0 real changes made)

. replace comp=subinword(comp,"INC","",.)
(0 real changes made)

. replace comp=subinword(comp,"DAIMLERCHRYSLER","DAIMLER",.)
(5 real changes made)

. replace comp=subinword(comp,"AG","",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(44 real changes made)

. replace comp=subinword(comp,"EASTMAN","EASTMN",.)
(0 real changes made)

. replace comp=subinword(comp,"KODAK","KODK",.)
(0 real changes made)

. replace comp=subinword(comp,"MACHINES","MA",.)
(3 real changes made)

. replace comp=subinword(comp,"BUSINESS","BUS",.)
(34 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(7 real changes made)

. replace comp=subinword(comp,"EQUIPMENT","EQ",.)
(48 real changes made)

. replace comp=subinword(comp,"PROCTER","PRCTR",.)
(0 real changes made)

. replace comp=subinword(comp,"GAMBLE","GM",.)
(6 real changes made)

. replace comp=subinword(comp,"GENERAL","GEN",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTORS","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"FUNDING","",.)
(5 real changes made)

. replace comp=subinword(comp,"(J C)","(JC)",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(1 real change made)

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(1 real change made)

. replace comp=subinword(comp,"STORES","",.)
(0 real changes made)

. replace comp=subinword(comp,"EXXON MOBIL","EXXON",.)
(0 real changes made)

. replace comp=subinword(comp,"SPRINT NEXTEL","SPRINT",.)
(0 real changes made)

. replace comp=subinword(comp,"INSTRUMENTS","INSTR",.)
(0 real changes made)

. replace comp=subinword(comp,"TEXAS","TX",.)
(60 real changes made)

. replace comp=subinword(comp,"DU PONT (E I) DE NEMOURS","DUPONT (EI)",.)
(0 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(0 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(0 real changes made)

. replace comp=subinword(comp,"RICHFIELD","RIC",.)
(0 real changes made)

. replace comp=subinword(comp,"INTERNATIONAL","INTL",.)
(0 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(0 real changes made)

. replace comp=subinword(comp,"ANHEUSER-BUSCH","ANHEUSR-BSH",.)
(0 real changes made)

. replace comp=subinword(comp,"LOCKHEED MARTIN","LOCKHEED",.)
(4 real changes made)

. replace comp=subinword(comp,"LOCKHD MART","LOCKHEED",.)
(1 real change made)

. replace comp=subinword(comp,"LABORATORIES","LABS",.)
(0 real changes made)

. replace comp=subinword(comp,"AMERICAN","",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGYOLD","TEC",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGY","TEC",.)
(339 real changes made)

. replace comp=subinword(comp,"HOSPITAL","HOSP",.)
(69 real changes made)

. replace comp=subinword(comp,"SUPPLY","SUP",.)
(0 real changes made)

. replace comp=subinword(comp,"PHILIP","PHIL",.)
(8 real changes made)

. replace comp=subinword(comp,"MORRIS","MOR",.)
(7 real changes made)

. replace comp=subinword(comp,"NORTHROP GRUMMAN","NORTHROP",.)
(0 real changes made)

. replace comp=subinword(comp,"LOWE'S COMPANIES","LOWES COS",.)
(0 real changes made)

. replace comp=subinword(comp,"MARIETTA","MRTA",.)
(0 real changes made)

. replace comp=subinword(comp,"MICROSYSTEMS","MICRO",.)
(0 real changes made)

. replace comp=trim(comp)
(168 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinstr(comp,"AM TEL &TEL","AT&T",.)
(0 real changes made)

. replace comp=subinstr(comp,"-","",.)
(0 real changes made)

. replace comp=subinword(comp,"CL","",.)
(59 real changes made)

. replace comp=subinword(comp,"A","",.)
(102 real changes made)

. replace comp=subinword(comp,"HLDG","",.)
(63 real changes made)

. replace comp=subinword(comp,"WARD","WD",.)
(4 real changes made)

. replace comp=subinword(comp,"MONTGOMERY","MONTGMY",.)
(4 real changes made)

. replace comp=subinstr(comp,"PR","",.)
(1,446 real changes made)

. replace comp=subinword(comp,"CORP","",.)
(0 real changes made)

. replace comp=subinword(comp,"CO","",.)
(38 real changes made)

. replace comp=subinword(comp,"CP","",.)
(0 real changes made)

. replace comp=subinword(comp,"INC","",.)
(0 real changes made)

. replace comp=subinword(comp,"DAIMLERCHRYSLER","DAIMLER",.)
(0 real changes made)

. replace comp=subinword(comp,"AG","",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(111 real changes made)

. replace comp=subinword(comp,"EASTMAN","EASTMN",.)
(0 real changes made)

. replace comp=subinword(comp,"KODAK","KODK",.)
(0 real changes made)

. replace comp=subinword(comp,"MACHINES","MA",.)
(3 real changes made)

. replace comp=subinword(comp,"BUSINESS","BUS",.)
(44 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(0 real changes made)

. replace comp=subinword(comp,"EQUIPMENT","EQ",.)
(23 real changes made)

. replace comp=subinword(comp,"PROCTER","PRCTR",.)
(0 real changes made)

. replace comp=subinword(comp,"GAMBLE","GM",.)
(1 real change made)

. replace comp=subinword(comp,"GENERAL","GEN",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTORS","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"MOTOR","MTR",.)
(0 real changes made)

. replace comp=subinword(comp,"FUNDING","",.)
(19 real changes made)

. replace comp=subinword(comp,"(J C)","(JC)",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(6 real changes made)

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(2 real changes made)

. replace comp=subinword(comp,"STORES","",.)
(0 real changes made)

. replace comp=subinword(comp,"EXXON MOBIL","EXXON",.)
(0 real changes made)

. replace comp=subinword(comp,"SPRINT NEXTEL","SPRINT",.)
(0 real changes made)

. replace comp=subinword(comp,"INSTRUMENTS","INSTR",.)
(0 real changes made)

. replace comp=subinword(comp,"TEXAS","TX",.)
(37 real changes made)

. replace comp=subinword(comp,"DU PONT (E I) DE NEMOURS","DUPONT (EI)",.)
(0 real changes made)

. replace comp=subinword(comp,"MICRO","MICR",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGIES","TECHS",.)
(0 real changes made)

. replace comp=subinword(comp,"UNITED","UTD",.)
(0 real changes made)

. replace comp=subinword(comp,"COMPUTER","CMP",.)
(0 real changes made)

. replace comp=subinword(comp,"RICHFIELD","RIC",.)
(1 real change made)

. replace comp=subinword(comp,"INTERNATIONAL","INTL",.)
(0 real changes made)

. replace comp=subinword(comp,"MACH","MA",.)
(0 real changes made)

. replace comp=subinword(comp,"ANHEUSER-BUSCH","ANHEUSR-BSH",.)
(0 real changes made)

. replace comp=subinword(comp,"LOCKHEED MARTIN","LOCKHEED",.)
(0 real changes made)

. replace comp=subinword(comp,"LOCKHD MART","LOCKHEED",.)
(0 real changes made)

. replace comp=subinword(comp,"LABORATORIES","LABS",.)
(0 real changes made)

. replace comp=subinword(comp,"AMERICAN","",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGYOLD","TEC",.)
(0 real changes made)

. replace comp=subinword(comp,"TECHNOLOGY","TEC",.)
(277 real changes made)

. replace comp=subinword(comp,"HOSPITAL","HOSP",.)
(7 real changes made)

. replace comp=subinword(comp,"SUPPLY","SUP",.)
(0 real changes made)

. replace comp=subinword(comp,"PHILIP","PHIL",.)
(3 real changes made)

. replace comp=subinword(comp,"MORRIS","MOR",.)
(1 real change made)

. replace comp=subinword(comp,"NORTHROP GRUMMAN","NORTHROP",.)
(0 real changes made)

. replace comp=subinword(comp,"LOWE'S COMPANIES","LOWES COS",.)
(0 real changes made)

. replace comp=subinword(comp,"MARIETTA","MRTA",.)
(4 real changes made)

. replace comp=subinword(comp,"MICROSYSTEMS","MICRO",.)
(0 real changes made)

. replace comp=trim(comp)
(175 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. merge3

. mergeRate       //.1110953
.1110953

. 
. *17th
. use "$data/resid1.dta", clear

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(0 real changes made)

. replace comp = subinstr(comp, " ", "", .)                                        
>                                //BLUNT way of improving match, remove white space
(24,184 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid1.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1.dta saved

. 
. use "$data/resid2.dta", clear

. replace comp=subinword(comp,"MCDONNELL","MCDONNEL",.)
(0 real changes made)

. replace comp=subinword(comp,"DOUGLAS","DG",.)
(0 real changes made)

. replace comp = subinstr(comp, " ", "", .)                                        
>                                //BLUNT way of improving match, remove white space
(22,183 real changes made)

. replace comp=trim(comp)
(0 real changes made)

. sort comp 

. gen count=0

. collapse count (firstnm) origName, by(comp)

. drop count

. save "$data/resid2.dta", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2.dta saved

. 
. /*******************************************************************************
>         SOUNDEX
> *******************************************************************************/
. stop
command stop is unrecognized
r(199);

end of do-file

r(199);

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. gen scomp=soundex(comp)
(9 missing values generated)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. save "$data/resid1_soundex", replace
(note: file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1_soundex.dt
> a not found)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1_soundex.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid2", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. gen scomp=soundex(comp)
(2 missing values generated)

. save "$data/resid2_soundex", replace
(note: file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_soundex.dt
> a not found)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_soundex.dta saved

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1_soundex", clear

. merge 1:1 scomp using "$data/resid2_soundex"
variable scomp does not uniquely identify observations in the master data
r(459);

end of do-file

r(459);

. h soundex

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1_soundex", clear

. merge m:m scomp using "$data/resid2_soundex"

    Result                           # of obs.
    -----------------------------------------
    not matched                         2,756
        from master                     1,657  (_merge==1)
        from using                      1,099  (_merge==2)

    matched                            36,608  (_merge==3)
    -----------------------------------------

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1", clear

. gen scomp=soundex(comp)
(9 missing values generated)

. rename comp comp1

. save "$data/resid1_soundex", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1_soundex.dta saved

. 
. use "$data/resid2", clear

. gen scomp=soundex(comp)
(2 missing values generated)

. rename comp comp2

. save "$data/resid2_soundex", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_soundex.dta saved

. 
. use "$data/resid1_soundex", clear

. merge m:m scomp using "$data/resid2_soundex"

    Result                           # of obs.
    -----------------------------------------
    not matched                         2,756
        from master                     1,657  (_merge==1)
        from using                      1,099  (_merge==2)

    matched                            36,608  (_merge==3)
    -----------------------------------------

. 
end of do-file

. sort comp1

. ssc install matchit
checking matchit consistency and verifying not already installed...
all files already exist and are up to date.

. h matchit

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1", clear

. gen id1 = _n

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. save use "$data/resid1_fuzzyStr", clear
invalid '"C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1_fuzzyStr' 
r(198);

end of do-file

r(198);

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. save "$data/resid1_fuzzyStr", clear
option clear not allowed
r(198);

end of do-file

r(198);

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid2", clear

. gen id2 = _n

. save "$data/resid2_fuzzyStr", replace
(note: file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_fuzzyStr.d
> ta not found)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_fuzzyStr.dta save
> d

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1", clear

. gen id1 = _n

. save "$data/resid1_fuzzyStr", replace
(note: file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1_fuzzyStr.d
> ta not found)
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1_fuzzyStr.dta save
> d

. 
. use "$data/resid2", clear

. gen id2 = _n

. save "$data/resid2_fuzzyStr", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_fuzzyStr.dta save
> d

. 
. use "$data/resid1_fuzzyStr", clear

. matchit id1 comp using "$data/resid2_fuzzyStr", idusing(id2) txtusing(comp)
freqindex not found.
matchit requires freqindex to be installed. You can get it in SSC.
invalid syntax
r(111);

end of do-file

r(111);

. ssc install freqindex
checking freqindex consistency and verifying not already installed...
installing into h:\ado\plus\...
installation complete.

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. ssc install freqindex, matchit
option matchit not allowed
r(198);

end of do-file

r(198);

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1", clear

. gen id1 = _n

. save "$data/resid1_fuzzyStr", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1_fuzzyStr.dta save
> d

. 
. use "$data/resid2", clear

. gen id2 = _n

. save "$data/resid2_fuzzyStr", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_fuzzyStr.dta save
> d

. 
. use "$data/resid1_fuzzyStr", clear

. matchit id1 comp using "$data/resid2_fuzzyStr", idusing(id2) txtusing(comp)
Matching current dataset with C:/Users/dyevre/Documents/mres_paper/data/001_network
> /resid2_fuzzyStr
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_fuzzyStr not
    found
r(601);

end of do-file

r(601);

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. matchit id1 comp using "$data/resid2_fuzzyStr.dta", idusing(id2) txtusing(comp)
Matching current dataset with C:/Users/dyevre/Documents/mres_paper/data/001_network
> /resid2_fuzzyStr.dta
Similarity function: bigram
Loading USING file: C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_fu
> zzyStr.dta
Indexing USING file.
0%
20%
40%
60%
80%
Done!
Computing results
        Percent completed ...   (search space saved by index so far)
--Break--
r(1);

end of do-file

--Break--
r(1);

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1_fuzzyStr", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. drop if _n>1000
(29,728 observations deleted)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. matchit id1 comp using "$data/resid2_fuzzyStr.dta", idusing(id2) txtusing(comp)
Matching current dataset with C:/Users/dyevre/Documents/mres_paper/data/001_network
> /resid2_fuzzyStr.dta
 
(!) Unsaved changes will be destroyed after running matching procedure.
    (note: use OVERRIDE option to bypass warning)
no; data in memory would be lost
r(4);

end of do-file

r(4);

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. matchit id1 comp using "$data/resid2_fuzzyStr.dta", idusing(id2) txtusing(comp) o
> verride
Matching current dataset with C:/Users/dyevre/Documents/mres_paper/data/001_network
> /resid2_fuzzyStr.dta
Similarity function: bigram
Loading USING file: C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_fu
> zzyStr.dta
Indexing USING file.
0%
20%
40%
60%
80%
Done!
Computing results
        Percent completed ...   (search space saved by index so far)
        20%               ...   (54%)
        40%               ...   (56%)
        60%               ...   (58%)
        80%               ...   (57%)
        Done!
Total search space saved by index: 57%

. 
end of do-file

. sort similscore

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1_soundex", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1_fuzzyStr", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid2", clear

. gen id2 = _n

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1_fuzzyStr", clear

. drop if _n>100
(30,628 observations deleted)

. matchit id1 comp using "$data/resid2_fuzzyStr.dta", idusing(id2) txtusing(comp) o
> verride
Matching current dataset with C:/Users/dyevre/Documents/mres_paper/data/001_network
> /resid2_fuzzyStr.dta
Similarity function: bigram
Loading USING file: C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_fu
> zzyStr.dta
Indexing USING file.
0%
20%
40%
60%
80%
Done!
Computing results
        Percent completed ...   (search space saved by index so far)
        20%               ...   (49%)
        40%               ...   (49%)
        60%               ...   (51%)
        80%               ...   (53%)
        Done!
Total search space saved by index: 53%

. 
end of do-file

. sort similscore

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid2", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1", clear

. gen id1 = _n

. save "$data/resid1_fuzzyStr", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1_fuzzyStr.dta save
> d

. 
. use "$data/resid2", clear

. gen id2 = _n

. save "$data/resid2_fuzzyStr", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_fuzzyStr.dta save
> d

. 
. use "$data/resid1_fuzzyStr", clear

. drop if _n>100
(30,628 observations deleted)

. matchit id1 comp using "$data/resid2_fuzzyStr.dta", idusing(id2) txtusing(comp) o
> verride
Matching current dataset with C:/Users/dyevre/Documents/mres_paper/data/001_network
> /resid2_fuzzyStr.dta
Similarity function: bigram
Loading USING file: C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_fu
> zzyStr.dta
Indexing USING file.
0%
20%
40%
60%
80%
Done!
Computing results
        Percent completed ...   (search space saved by index so far)
        20%               ...   (49%)
        40%               ...   (49%)
        60%               ...   (51%)
        80%               ...   (53%)
        Done!
Total search space saved by index: 53%

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid2", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid2", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1", clear

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. gen tag=strpos(origName, " CUSTOMER")

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. use "$data/resid1", clear

. gen tag=strpos(origName, " CUSTOMER")!=0

. 
end of do-file

. tab tag

        tag |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     30,489       99.22       99.22
          1 |        239        0.78      100.00
------------+-----------------------------------
      Total |     30,728      100.00

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. replace tag=1 if strpos(origName, " DISTRIBUTOR")!=0
(36 real changes made)

. 
end of do-file

. tab tag

        tag |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     30,453       99.11       99.11
          1 |        275        0.89      100.00
------------+-----------------------------------
      Total |     30,728      100.00

. sort tag origName

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. replace comp = "20THCENTURYFOX" if strpos(origName, "20THCENT")!=0
(0 real changes made)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. replace comp = "20THCENTURYFOX" if strpos(origName, "20TH CENT")!=0
(2 real changes made)

. 
end of do-file

. do "C:\Users\dyevre\AppData\Local\Temp\STD28b0_000000.tmp"

. ssc install freqindex
checking freqindex consistency and verifying not already installed...
all files already exist and are up to date.

. ssc install matchit
checking matchit consistency and verifying not already installed...
all files already exist and are up to date.

.         
. use "$data/resid1", clear

. gen id1 = _n

. save "$data/resid1_fuzzyStr", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid1_fuzzyStr.dta save
> d

. 
. use "$data/resid2", clear

. gen id2 = _n

. save "$data/resid2_fuzzyStr", replace
file C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_fuzzyStr.dta save
> d

. 
. use "$data/resid1_fuzzyStr", clear

. *drop if _n>100
. matchit id1 comp using "$data/resid2_fuzzyStr.dta", idusing(id2) txtusing(comp) o
> verride
Matching current dataset with C:/Users/dyevre/Documents/mres_paper/data/001_network
> /resid2_fuzzyStr.dta
Similarity function: bigram
Loading USING file: C:/Users/dyevre/Documents/mres_paper/data/001_network/resid2_fu
> zzyStr.dta
Indexing USING file.
0%
20%
40%
60%
80%
Done!
Computing results
        Percent completed ...   (search space saved by index so far)
        20%               ...   (54%)
        40%               ...   (55%)
        60%               ...   (55%)
        80%               ...   (55%)
        Done!
Total search space saved by index: 55%

. 
end of do-file

. sort similscore

